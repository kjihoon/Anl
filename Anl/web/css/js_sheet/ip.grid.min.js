function ip_colObject(e,r,o,i,t,l,n,a,s,p,d){null==e&&(e=defaultColWidth),null==r&&(r=null),null==t&&(t=null),null==o&&(o=!1),null==i&&(i=ip_dataTypeObject()),null==l&&(l=ip_validationObject()),null==n&&(n=null),null==a&&(a=null),null==p&&(p=null),null==s&&(s=null),null==d&&(d=null);var c={width:e,style:r,formula:t,hide:!1,dataType:i,validation:l,controlType:n,hashTags:a,mask:p,border:s,decimals:d};return c}function ip_rowObject(e,r,o,i,t,l,n,a){return null==e&&(e=defaultRowHeight),null==r&&(r=null!=i&&i>0?Array.apply(null,Array(i)).map(function(){return new ip_cellObject}):[]),null==t&&(t=!1),null==l&&(l=!1),null==n&&(n=0),rowObject={height:e,cells:r,loading:t,hide:!1,groupCount:n,groupColumn:a}}function ip_cellObject(e,r,o,i,t,l,n,a,s,p,d,c,_,u){return null==l&&(l=ip_dataTypeObject()),null==a&&(a=ip_validationObject()),cellObject={display:"",value:e,style:r,editing:o,dataType:l,formula:n,validation:a,controlType:s,hashTags:d,mask:_,decimals:u,error:p,border:c}}function ip_mergeObject(e,r,o,i){null==e&&(e=null),null==r&&(r=null),null==o&&(o=0),null==i&&(i=0);var t={mergedWithRow:e,mergedWithCol:r,rowSpan:o,colSpan:i};return t}function ip_rangeObject(e,r,o,i,t,l,n){return{startRow:e,startCol:r,endRow:o,endCol:i,row:t,col:l,hashtags:n}}function ip_formatObject(){var e={fontSize:"",fontFamily:"",bold:!1,italic:!1,linethrough:!1,overline:!1,underline:!1,color:"",fill:"",merge:!1,hasUnmergedCells:!1,aligntop:!1,alignmiddle:!1,alignbottom:!1,alignleft:!1,alignright:!1,aligncenter:!1,validation:ip_validationObject(),dataType:ip_dataTypeObject(),controlType:null,hashTags:null,mask:null,decimals:null};return e}function ip_eventObject(e,r,o,i){return{gridID:e,publicKey:ip_GridProps[e].publicKey,cMethod:r,transactionID:o,options:i}}function ip_dataTypeObject(e,r){return{dataType:e,dataTypeName:r}}function ip_validationObject(e,r){return{validationCriteria:e,validationAction:r}}function ip_errorObject(e,r){return{errorCode:e,errorDescription:r}}function ip_CloneCell(e,r,o,i,t){var l=ip_cellObject();return null!=ip_GridProps[e].rowData[r].cells[o].merge&&(l.merge=ip_mergeObject(ip_GridProps[e].rowData[r].cells[o].merge.mergedWithRow,ip_GridProps[e].rowData[r].cells[o].merge.mergedWithCol,ip_GridProps[e].rowData[r].cells[o].merge.rowSpan,ip_GridProps[e].rowData[r].cells[o].merge.colSpan)),l.display=ip_GridProps[e].rowData[r].cells[o].display,l.value=ip_GridProps[e].rowData[r].cells[o].value,l.style=ip_GridProps[e].rowData[r].cells[o].style,l.row=null==i?r:i,l.col=null==t?o:t,l.dataType=ip_GridProps[e].rowData[r].cells[o].dataType,l.formula=ip_GridProps[e].rowData[r].cells[o].formula,l.fxIndex=ip_GridProps[e].rowData[r].cells[o].fxIndex,l.validation=ip_GridProps[e].rowData[r].cells[o].validation,l.controlType=ip_GridProps[e].rowData[r].cells[o].controlType,l.error=ip_GridProps[e].rowData[r].cells[o].error,l.hashTags=ip_GridProps[e].rowData[r].cells[o].hashTags,l.border=ip_GridProps[e].rowData[r].cells[o].border,l.mask=ip_GridProps[e].rowData[r].cells[o].mask,l.decimals=ip_GridProps[e].rowData[r].cells[o].decimals,l}function ip_CloneCol(e,r){var o=ip_colObject();return o.width=ip_GridProps[e].colData[r].width,o.style=ip_GridProps[e].colData[r].style,o.hide=ip_GridProps[e].colData[r].hide,o.col=r,o.dataType.dataType=ip_GridProps[e].colData[r].dataType.dataType,o.dataType.dataTypeName=ip_GridProps[e].colData[r].dataType.dataTypeName,o.validation.validationAction=ip_GridProps[e].colData[r].validation.validationAction,o.validation.validationCriteria=ip_GridProps[e].colData[r].validation.validationCriteria,o.controlType=ip_GridProps[e].colData[r].controlType,o.hashTags=ip_GridProps[e].colData[r].hashTags,o.border=ip_GridProps[e].colData[r].border,o.mask=ip_GridProps[e].colData[r].mask,o}function ip_CloneRow(e,r,o){var i=ip_rowObject();if(i.height=ip_GridProps[e].rowData[r].height,i.hide=ip_GridProps[e].rowData[r].hide,i.groupCount=ip_GridProps[e].rowData[r].groupCount,i.groupColumn=ip_GridProps[e].rowData[r].groupColumn,i.cells=[],i.row=r,o)for(var t=0;t<ip_GridProps[e].rowData[r].cells.length;t++)i.cells[i.cells.length]=ip_CloneCell(e,r,t);return i}function ip_CompareCell(e,r,o){if(ip_parseAny(e,r.value)!=ip_parseAny(e,o.value))return!1;if(r.formula!=o.formula)return!1;if(r.border!=o.border)return!1;if(r.hashtags!=o.hashtags)return!1;if(r.style!=o.style)return!1;if(r.controlType!=o.controlType)return!1;if(null!=r.error||null!=o.error){var i=r.error?r.error.errorCode:"",t=r.error?r.error.errorDescription:"",l=o.error?o.error.errorCode:"",n=o.error?o.error.errorDescription:"";if(null==i&&(i=""),null==t&&(t=""),null==l&&(l=""),null==n&&(n=""),i!=l)return!1;if(t!=n)return!1}if(null!=r.validation||null!=o.validation){if(null==r.validation)return!1;if(null==o.validation)return!1;if(r.validation.validationCriteria!=o.validation.validationCriteria)return!1;if(r.validation.validationAction!=o.validation.validationAction)return!1}if(null!=r.dataType||null!=o.dataType){if(null==r.dataType)return!1;if(null==o.dataType)return!1;if(r.dataType.dataType!=o.dataType.dataType)return!1;if(r.dataType.dataTypeName!=o.dataType.dataTypeName)return!1}return!0}function ip_CompareError(e,r,o){return null==r&&null==o?!0:(null==r&&(r=ip_errorObject("","")),null==o&&(o=ip_errorObject("","")),r.errorCode!=o.errorCode?!1:r.errorDescription!=o.errorDescription?!1:!0)}function ip_DisposeGrid(e){null!=ip_GridProps[e]&&(ip_RaiseEvent(e,"ip_DisposeGrid",ip_GenerateTransactionID(),{ResizeGrid:{Inputs:null,Effected:null}}),ip_UnbindAllEvents(e),$("#"+e).html(""),$("#"+e+"_gridResizer").remove(),delete ip_GridProps[e])}function ip_CreateGrid(e){ip_GridProps[e.id].dimensions.gridHeight=$("#"+e.id).height()-ip_GridProps[e.id].dimensions.fBarHeight,ip_GridProps[e.id].dimensions.gridWidth=$("#"+e.id).width(),ip_GridProps[e.id].scrollY=null==ip_GridProps[e.id].scrollY?ip_GridProps[e.id].frozenRows:ip_GridProps[e.id].scrollY,ip_GridProps[e.id].scrollX=null==ip_GridProps[e.id].scrollX?ip_GridProps[e.id].frozenCols:ip_GridProps[e.id].scrollX,ip_RecalculateLoadedRowsCols(e.id,!1,!0,!0),ip_SetupMerges(e.id,e.mergeData);var r=jQuery.extend({startCol:0,startRow:0},e);r.showColSelector=0==e.showColSelector?!1:!0,r.showRowSelector=0==e.showRowSelector?!1:!0,r.id=e.id+"_q1",r.rows=e.frozenRows,r.cols=e.frozenCols,r.Quad=1,r.GridID=e.id;var o=jQuery.extend({startCol:ip_GridProps[e.id].scrollX,startRow:0},e);o.showColSelector=0==e.showColSelector?!1:!0,o.showRowSelector=!1,o.id=e.id+"_q2",o.rows=e.frozenRows,o.cols=e.cols-e.frozenCols,o.Quad=2,o.GridID=e.id;var i=jQuery.extend({startCol:0,startRow:ip_GridProps[e.id].scrollY},e);i.showColSelector=!1,i.showRowSelector=0==e.showRowSelector?!1:!0,i.id=e.id+"_q3",i.rows=e.rows-e.frozenRows,i.cols=e.frozenCols,i.Quad=3,i.GridID=e.id;var t=jQuery.extend({startCol:ip_GridProps[e.id].scrollX,startRow:ip_GridProps[e.id].scrollY},e);t.showColSelector=!1,t.showRowSelector=!1,t.id=e.id+"_q4",t.rows=e.rows-e.frozenRows,t.cols=e.cols-e.frozenCols,t.Quad=4,t.GridID=e.id;var l="";$("#"+e.id).hasClass("ip_grid_sheet")||$("#"+e.id).addClass("ip_grid_sheet"),e.toolType="gridControls",l+=ip_CreateGridTools(e),l+='<table id="'+e.id+'_table" border="0" cellpadding="0" cellspacing="0" >',l+="<tr>",l+='<td id="'+r.id+'" class="ip_grid_quadrant" valign="top" align="left"><div id="'+r.id+'_div_container" style="position:relative;">'+ip_CreateGridQuadrant(r)+"<div></td>",l+='<td id="'+o.id+'" class="ip_grid_quadrant" valign="top" align="left"><div id="'+o.id+'_div_container" style="position:relative;">'+ip_CreateGridQuadrant(o)+"<div></td>",l+="</tr>",l+="<tr>",l+='<td id="'+i.id+'" class="ip_grid_quadrant" valign="top" align="left"><div id="'+i.id+'_div_container" style="position:relative;">'+ip_CreateGridQuadrant(i)+"<div></td>",l+='<td id="'+t.id+'" class="ip_grid_quadrant" valign="top" align="left"><div id="'+t.id+'_div_container" style="position:relative;">'+ip_CreateGridQuadrant(t)+ip_CreateScrollBar("x",t)+ip_CreateScrollBar("y",t)+"<div></td>",l+="</tr>",l+="</table>";var n=$(l);return $("#"+e.id).html(l),null==ip_GridProps[e.id].fxBar&&(ip_GridProps[e.id].fxBar=$("#"+e.id+"_fBar")[0]),$("#"+e.id).attr("tabindex",ip_GridProps[e.id].index),e.refresh||ip_SetupEvents(e.id),$("#"+e.id).ip_Scrollable()?(ip_ShowColumnFrozenHandle(e.id),ip_ShowRowFrozenHandle(e.id),ip_ShowGridResizerHandle(e.id),ip_DisableSelection(e.id,!0),ip_SetupFx(e.id),ip_SetupMask(e.id),n):!1}function ip_CreateGridTools(e){var r="";if("gridControls"==e.toolType)r+='<div id="'+e.id+'_rangeselector" class="ip_grid_cell_rangeselector"  style="pointer-events:none;" ><svg class="ip_grid_cell_rangeselector_innerContent" xmlns="http://www.w3.org/2000/svg"  style="pointer-events:none;"  pointer-events="none">  <rect x="0" y="0" width="100%" height="100%" pointer-events="none" style="pointer-events:none;" /></svg><div class="ip_grid_cell_rangeselector_border" borderPosition="top" style="width:100%;height:3px;top:-2px;"></div><div class="ip_grid_cell_rangeselector_border" borderPosition="left" style="width:3px;height:100%;left:-2px;"></div><div class="ip_grid_cell_rangeselector_border" borderPosition="right" style="width:3px;height:100%;right:-2px;"></div><div class="ip_grid_cell_rangeselector_border" borderPosition="bottom" style="width:100%;height:3px;bottom:-2px;"></div><div class="ip_grid_cell_rangeselector_key"></div></div>',r+='<div id="'+e.id+'_editTool" class="ip_grid_EditTool"><div contenteditable="true" tabindex="0" class="ip_grid_EditTool_Input" ></div><div tabindex="0"  class="ip_grid_EditTool_DropDown"></div></div>',r+='<div id="'+e.id+'_rangeHighlight" class="ip_grid_cell_rangeHighlight"></div>',r+='<div id="'+e.id+'_columnFrozenHandle"  class="ip_grid_columnFrozenHandle"><div id="'+e.id+'_columnFrozenHandleLine" class="ip_grid_columnFrozenHandleLine"></div></div>',r+='<div id="'+e.id+'_rowFrozenHandle"  class="ip_grid_rowFrozenHandle"><div id="'+e.id+'_rowFrozenHandleLine" class="ip_grid_rowFrozenHandleLine"></div></div>',r+='<div id="'+e.id+'_columnResizer"  class="ip_grid_columnSelectorResizeTool"><div id="'+e.id+'_columnLine" class="ip_grid_columnSelectorResizeLine"></div></div>',r+='<div id="'+e.id+'_rowResizer"  class="ip_grid_rowSelectorResizeTool"><div id="'+e.id+'_rowLine" class="ip_grid_rowSelectorResizeLine"></div></div>',r+='<span id="'+e.id+'_cellContentWidthTool"  class="ip_grid_cell" style="display:none;position:absolute;"></span>',r+='<textarea id="'+e.id+'_selectTool" cols="50" rows="10" style="position:absolute;z-index:0;"></textarea>',r+='<div id="'+e.id+'_fBar" class="ip_grid_fbar" style="line-height:'+ip_GridProps[e.id].dimensions.fBarHeight+"px;height:"+ip_GridProps[e.id].dimensions.fBarHeight+'px;"><div class="ip_grid_fbar_title"><span class="ip_grid_fbar_f">f</span><span class="ip_grid_fbar_x">x</span></div><div class="ip_grid_fbar_text"></div></div>',$("#"+e.id+"_gridResizer").remove(),$("#"+e.id).parent().append('<div id="'+e.id+'_gridResizer" title="Resize Grid (double click to split or maximize)"  class="ip_grid_gridResizeTool"><div id="'+e.id+'_gridResizerLine" class="ip_grid_gridResizeToolLine"></div></div>');else if("cellFormatting"==e.toolType){var o=e.enabledFormats;r+='<div  style="min-width:670px">',r+='<table border="0" cellpadding="0" cellspacing="10">',r+='<tr><td>Range:</td><td><input id="'+e.id+'_Range_F" placeholder="Effected range, example: A1:A10" class="ip_ControlBase ip_TextBox no-drag formatting-tool"  style="width:164px;" type="text" /></td></tr>',r+='<tr><td>Cell Type:</td><td><div id="'+e.id+'_ControlType" placeholder="Please choose .." style="width:170px;" class="ip_ControlBase ip_DropDown no-drag formatting-tool"  ></div><input id="'+e.id+'_ValidationValue" class="ip_ControlBase ip_TextBox tooltip no-drag formatting-tool" style="width:280px;margin-left:10px;'+(""==o.controlType?"display:none;":"")+'" type="text" /></td></tr>',r+='<tr><td>Incorrect Input Action:</td><td><div id="'+e.id+'_Action" style="width:170px;" placeholder="Please choose .." class="ip_ControlBase ip_DropDown no-drag formatting-tool"  ></div></td></tr>',r+='<tr><td>Data Type:</td><td><div id="'+e.id+'_DataType" style="width:170px;" placeholder="Please choose .." class="ip_ControlBase ip_DropDown no-drag formatting-tool"  ></div><div id="'+e.id+'_Mask" style="width:170px;margin-left:10px;display:none;" placeholder="Formatting .." class="ip_ControlBase ip_DropDown no-drag formatting-tool"  ></div></td></tr>',r+='<tr><td>#Tags:</td><td colspan="2"><div id="'+e.id+'_HashTags" placeholder="Example: #Red, #Green, #Blue" class="ip_ControlBase ip_TextBox no-drag formatting-tool"  style="width:470px;" /></td></tr>',r+="</table>",r+="</div>"}return r}function ip_CreateGridQuadrant(e){var r=[];return r+='<div id="'+e.id+'_container" class="ip_grid_container">',r+='<table id="'+e.id+'_table" Quad="'+e.Quad+'" class="ip_grid" border="0" cellpadding="0" cellspacing="0" >',r+=ip_CreateGridQuadColumnHeaders(e),r+=ip_CreateGridQuadRows(e),r+="</table>",r+="</div>"}function ip_CreateGridQuadColumnHeaders(e){var r=e.startCol+(ip_GridProps[e.GridID].loadedCols>e.cols?e.cols:ip_GridProps[e.GridID].loadedCols-ip_GridProps[e.GridID].frozenCols),o=['<thead style="" >','<tr  class="ip_grid_columnSelectorRow"  id="'+e.id+'_gridRow_-1" row="-1" col="-1" style="'+(e.showColSelector?"height:"+ip_GridProps[e.GridID].dimensions.columnSelectorHeight+"px":"")+'">','<th class="ip_grid_columnSelectorCellCorner q'+e.Quad+'" id="'+e.id+'_columnSelectorCell_-1" quadrant="'+e.Quad+'" row="-1" col="-1"  style="'+(e.showRowSelector?"width:"+ip_GridProps[e.GridID].dimensions.rowSelectorWidth+"px;":"width:0px;")+'" >','<div class="ip_grid_cell_outerContent" style="'+(e.showColSelector?"":"display:none;")+(e.showRowSelector?"":"display:none;")+'" >',"</div>","</th>"];0>r&&(r=ip_GridProps[e.GridID].loadedCols),2==e.Quad&&(ip_GridProps[e.GridID].dimensions.accumulativeScrollWidth=0);for(var i=e.startCol;r>i;i++)e.cellType="ColSelector",e.col=i,e.row=-1,o.push(ip_CreateGridQuadCell(e)),2==e.Quad&&(ip_GridProps[e.GridID].dimensions.accumulativeScrollWidth+=ip_ColWidth(e.GridID,i,!0));return o.push("</tr>"),o.push("</thead>"),o.join("")}function ip_CreateGridQuadRows(e){var e=jQuery.extend({row:0},e),r=['<tbody id="'+e.id+'_table_tbody">'],o=e.startRow+(ip_GridProps[e.GridID].loadedRows>e.rows?e.rows:ip_GridProps[e.GridID].loadedRows-ip_GridProps[e.GridID].frozenRows);0>o&&(o=ip_GridProps[e.GridID].loadedRows),4==e.Quad&&(ip_GridProps[e.GridID].dimensions.accumulativeScrollHeight=0);for(var i=e.startRow;o>i;i++)e.row=i,r.push(ip_CreateGridQuadRow(e,r)),4==e.Quad&&(ip_GridProps[e.GridID].dimensions.accumulativeScrollHeight+=ip_RowHeight(e.GridID,i,!0));return r.push("</tbody>"),r.join("")}function ip_CreateGridQuadRow(e,r){var o=null==e.loadedScrollable?ip_LoadedRowsCols(e.GridID):e.loadedScrollable,i=1==e.Quad||3==e.Quad?o.colCount_frozen:o.colTo_scroll+1,e=jQuery.extend({col:0,cellType:""},e),t=parseInt(e.row),l=ip_GridProps[e.GridID].rowData[t],n=ip_RowHeight(e.GridID,t,!1);if(l.hide)return"";r=null!=r?r:[],r.push('<tr class="ip_grid_row" id="'+e.id+"_gridRow_"+t+'" row="'+t+'" style="height:'+n+"px;max-height:"+n+'px;">'),e.cellType="RowSelector",e.col=-1,ip_CreateGridQuadCell(e,r);for(var a=e.startCol;i>a;a++)e.cellType="",e.col=a,ip_CreateGridQuadCell(e,r);r.push("</tr>")}function ip_CreateGridQuadCell(e,r){var o=e.col,i=e.row,t="",l=e.Quad;if(i>=0&&ip_GridProps[e.GridID].rowData[i].hide)return"";if(o>=0&&ip_GridProps[e.GridID].colData[o].hide)return"";if("RowSelector"==e.cellType){var n=ip_GridProps[e.GridID].rowData[i].selected?" selected":"",a=ip_GridProps[e.GridID].rowData[i].hide?" ip_grid_cell_hideRow":"",s=ip_GridProps[e.GridID].rowData[i].groupCount>0?" ip_grid_rowGroup":"",p="";i>0&&!ip_GridProps[e.GridID].rowData[i].hide&&ip_GridProps[e.GridID].rowData[i-1].hide&&(p+='<div class="ip_grid_cell_hideIcon top"></div>'),t='<th cellType="RowSelector" class="ip_grid_rowSelecterCell q'+l+n+" "+a+s+'" id="'+e.id+"_rowSelecterCell_"+i+'"  quadrant="'+e.Quad+'" col="-1" row="'+i+'" style="'+(e.showRowSelector?"":"width:0px;")+'">'+p+'<div class="ip_grid_cell_outerContent">'+(1==l||3==l?i:"")+"</div></th>"}else if("ColSelector"==e.cellType){var d=ip_GridProps[e.GridID].colData[o],c=ip_ColWidth(e.GridID,o,!1),n=d.selected?" selected":"",a=d.hide?" ip_grid_cell_hideCol":"",p="",_=null!=d.dataType.dataTypeName?d.dataType.dataTypeName:"";d.hide&&0==c&&(c=.01),e.showColSelector&&o>0&&!a&&ip_GridProps[e.GridID].colData[o-1].hide&&(p+='<div class="ip_grid_cell_hideIcon left"></div>'),t='<th cellType="ColSelector" class="ip_grid_columnSelectorCell q'+l+n+a+'" id="'+e.id+"_columnSelectorCell_"+o+'"  quadrant="'+e.Quad+'" row="-1" col="'+o+'"  style="'+(e.showColSelector?"":"border-top:none;")+"width:"+c+'px;">'+p+'<div class="ip_grid_cell_outerContent" style="position:relative;'+(e.showColSelector?"":"display:none;")+'" >('+ip_GridProps[e.GridID].indexedData.colSymbols.colSymbols[o]+') <div  class="ip_grid_cell_innerContent">'+_+"</div></div></th>"}else if(i>=0&&o>=0){var u=ip_CellData(e.GridID,i,o,!0);t='<td cellType="Cell" class="ip_grid_cell'+u.css+'" id="'+e.GridID+"_cell_"+i+"_"+o+'"  quadrant="'+e.Quad+'" col="'+o+'" row="'+i+'" style="'+u.style+'" '+u.rowSpan+" "+u.colSpan+" >"+ip_CellBorder(e.GridID,i,o,u)+ip_CellOuter(e.GridID,i,o,u)+"</td>"}return null!=r&&r.push(t),t}function ip_CellBorder(e,r,o,i){if(!i.border)return"";var t="";return t='<div class="ip_grid_cell_border" style="'+i.border+'"></div>'}function ip_CreateScrollBar(e,r){var o='<div id="'+r.id+"_scrollbar_container_"+e+'" class="ip_grid_scrollBarContainer '+("x"==e?"horizontal":"vertical")+'" ><div class="ip_grid_scrollBar_innerContent"><div id="'+r.id+"_scrollbar_gadget_"+e+'" class="ip_grid_scrollBar_gadget '+("x"==e?"horizontal":"vertical")+'" ><div id="'+r.id+"_scrollbar_gadget_scrollIndecator_"+e+'" class="ip_grid_scrollBar_indecator '+("x"==e?"horizontal":"vertical")+'">0</div></div></div></div>';return o}function ip_CellHtml(e,r,o,i){if(r>=0&&o>=0&&r<ip_GridProps[e].rows&&o<ip_GridProps[e].cols){var t=ip_GridProps[e].rowData[r].cells[o].merge;null!=t&&(r=ip_NextNonHiddenRow(e,t.mergedWithRow,t.mergedWithRow+t.rowSpan-1,r,"down"),o=ip_NextNonHiddenCol(e,t.mergedWithCol,t.mergedWithCol+t.colSpan-1,o,"right"))}var l=ip_GridProps[e].scrollY+ip_GridProps[e].loadedRows-ip_GridProps[e].frozenRows-1;l<ip_GridProps[e].rows||(l=ip_GridProps[e].rows-1),r>=l&&i?r=l:r<ip_GridProps[e].scrollY&&r>=ip_GridProps[e].frozenRows&&i&&(r=ip_GridProps[e].scrollY);var n=ip_GridProps[e].scrollX+ip_GridProps[e].loadedCols-ip_GridProps[e].frozenCols-1;n<ip_GridProps[e].cols||(n=ip_GridProps[e].cols-1),o>=n&&i?o=n:o<ip_GridProps[e].scrollX&&o>=ip_GridProps[e].frozenCols&&i&&(o=ip_GridProps[e].scrollX);var a="";if(-1==r){var s=ip_GetQuad(e,r,o);a=e+"_q"+s+"_columnSelectorCell_"+o}else if(-1==o){var s=ip_GetQuad(e,r,o);a=e+"_q"+s+"_rowSelecterCell_"+r}else a=e+"_cell_"+r+"_"+o;var p=$("#"+a);return p.length>0?p[0]:null}function ip_CellInner(e,r,o){var i="",t=ip_GridProps[e].rowData[r].cells[o];return i="gantt"==t.controlType?ip_parseBool(t.value)?'<div class="ip_grid_cell_gantt"></div>':"":null==t.value?"":t.display}function ip_CellOuter(e,r,o,i){null==i&&(i=ip_CellData(e,r,o,!0));var t=""+i.iconGP+'<div  class="ip_grid_cell_outerContent"><div  class="ip_grid_cell_innerContent">'+ip_CellInner(e,r,o)+"</div></div>"+i.iconDD;return t}function ip_IsCellEmpty(e,r,o){var i=ip_GridProps[e].rowData[r].cells[o].merge;return null!=i&&(r=i.mergedWithRow,o=i.mergedWithCol),null!=ip_GridProps[e].rowData[r].cells[o].value&&""!=ip_GridProps[e].rowData[r].cells[o].value?!1:null!=ip_GridProps[e].rowData[r].cells[o].formula&&""!=ip_GridProps[e].rowData[r].cells[o].formula?!1:null!=ip_GridProps[e].rowData[r].cells[o].style&&""!=ip_GridProps[e].rowData[r].cells[o].style?!1:null!=ip_GridProps[e].rowData[r].cells[o].validation&&null!=ip_GridProps[e].rowData[r].cells[o].validation.validationCriteria&&""!=ip_GridProps[e].rowData[r].cells[o].validation.validationCriteria?!1:null!=ip_GridProps[e].rowData[r].cells[o].validation&&null!=ip_GridProps[e].rowData[r].cells[o].validation.validationAction&&""!=ip_GridProps[e].rowData[r].cells[o].validation.validationAction?!1:null!=ip_GridProps[e].rowData[r].cells[o].dataType&&null!=ip_GridProps[e].rowData[r].cells[o].dataType.dataType&&""!=ip_GridProps[e].rowData[r].cells[o].dataType.dataType?!1:null!=ip_GridProps[e].rowData[r].cells[o].dataType&&null!=ip_GridProps[e].rowData[r].cells[o].dataType.dataTypeName&&""!=ip_GridProps[e].rowData[r].cells[o].dataType.dataTypeName?!1:null!=ip_GridProps[e].rowData[r].cells[o].controlType&&""!=ip_GridProps[e].rowData[r].cells[o].controlType?!1:!0}function ip_ColSymbol(e,r){return 0==r?"A":r}function ip_ColumnSymbols(e){for(var r=0,o=[],i=[],t=e/26,l=1024,n=-1;t-1>n;n++)for(var a=0;l>a;a++){var s=ip_ColumnSymboldCharCode(a);o[r]=s,i[s]=r,r++}return{colSymbols:o,symbolCols:i}}function ip_ColumnSymboldCharCode(e){var r="";return e>701?(r+=String.fromCharCode(64+parseInt(e/676)),r+=String.fromCharCode(64+parseInt(e%676/26))):e>25&&(r+=String.fromCharCode(64+parseInt(e/26))),r+=String.fromCharCode(65+e%26)}function ip_SetupEvents(e){$("#"+e).on("focus",function(){ip_FocusGrid(e)}),$("#"+e).on("mousedown",function(r){ip_GridProps[e].mouseButton=r.which,ip_GridProps[e].shiftKey=r.shiftKey,ip_GridProps[e].ctrlKey=r.ctrlKey}),$(document).on("mouseup",ip_GridProps[e].events.SetupEvents_document_mouseup=function(r){ip_GridProps[e].mouseButton=0,ip_GridProps[e].shiftKey=r.shiftKey,ip_GridProps[e].ctrlKey=r.ctrlKey}),$("#"+e).on("mousedown",".ip_grid_cell",function(r){var o=r.shiftKey,i=r.ctrlKey;if(ip_GridProps[e].resizing||ip_GridProps[e].editing.editing){if(ip_GridProps[e].editing.editing)if(ip_GridProps[e].editing.editTool.isFX()){var t=parseInt($(this).attr("row")),l=parseInt($(this).attr("col"));(t!=ip_GridProps[e].editing.row||l!=ip_GridProps[e].editing.col)&&(r.preventDefault(),$("#"+e).ip_SelectRange({startCell:this,multiselect:!1,rangeType:"ip_grid_cell_rangeselector_transparent",allowColumn:!1,allowRow:!1,allowMove:!1,showKey:!1}))}else $("#"+e).ip_SelectCell({cell:this})}else{if(1!=r.which)for(var t=parseInt($(this).attr("row")),l=parseInt($(this).attr("col")),n=0;n<ip_GridProps[e].selectedRange.length;n++){var a={startRow:ip_GridProps[e].selectedRange[n][0][0],startCol:ip_GridProps[e].selectedRange[n][0][1],endRow:ip_GridProps[e].selectedRange[n][1][0],endCol:ip_GridProps[e].selectedRange[n][1][1]},s={startRow:t,startCol:l,endRow:t,endCol:l};if(ip_IsRangeOverLap(e,a,s)){var p=e+"_range_"+a.startRow+"_"+a.startCol+"_"+a.endRow+"_"+a.endCol;return ip_GridProps[e].selectedRangeIndex=n,Effected={range:a,rangeEl:$("#"+p)[0]},ip_RaiseEvent(e,"ip_RangeMouseDown",ip_GenerateTransactionID(),{RangeMouseDown:{Inputs:r,Effected:Effected}}),!1}}o?($("#"+e).ip_UnselectColumn(),$("#"+e).ip_UnselectRow(),ip_ChangeRange(e,ip_GridProps[e].selectedRange[ip_GridProps[e].selectedRangeIndex],this)):$("#"+e).ip_SelectCell({cell:this,multiselect:i})}}),$("#"+e).on("mouseenter",".ip_grid_cell",function(){ip_GridProps[e].hoverCell!=this&&(ip_GridProps[e].hoverCell=this),1!=ip_GridProps[e].mouseButton||ip_GridProps[e].resizing||(ip_EnableScrollAnimate(e),ip_ChangeRange(e,ip_GridProps[e].selectedRange[ip_GridProps[e].selectedRangeIndex],this))}),$("#"+e).on("dblclick",".ip_grid_cell",function(){ip_GridProps[e].resizing||($("#"+e).ip_ClearCopy(),$("#"+e).ip_TextEditable({contentType:"ip_grid_CellEdit",element:this}))}),"ie"==ip_GridProps.index.browser.name&&$("#"+e).on("mousedown",".ip_grid_cell_rangeselector",function(r){ip_GridProps[e].shiftKey=r.shiftKey,ip_GridProps[e].ctrlKey=r.ctrlKey;var o=ip_SetHoverCell(e,this,r,!1,null);return $(o).mousedown(),!1}),$("#"+e).on("mouseenter",".ip_grid_columnSelectorCell",function(){ip_GridProps[e].resizing||ip_HideFloatingHandles(e),ip_GridProps[e].hoverCell!=this&&(ip_GridProps[e].hoverCell=this)}),$("#"+e).on("mouseenter",".ip_grid_rowSelecterCell",function(){ip_GridProps[e].resizing||ip_HideFloatingHandles(e),ip_GridProps[e].hoverCell!=this&&(ip_GridProps[e].hoverCell=this)}),$("#"+e).on("mousedown",".ip_grid_columnSelectorCell",function(r){if(ip_GridProps[e].editing.editing&&ip_GridProps[e].editing.editTool.isFX())return void r.preventDefault();var o=r.shiftKey,i=r.ctrlKey,t=parseInt($(this).attr("col"));if("ie"==ip_GridProps.index.browser.name&&null==o&&(o=ip_GridProps[e].shiftKey,i=ip_GridProps[e].ctrlKey),!ip_GridProps[e].resizing){var l=!0,n=-1!=jQuery.inArray(t,ip_GridProps[e].selectedColumn);if(1==r.which?!n||o||i||(ip_EnableScrollAnimate(e),ip_ShowColumnMove(e,t),l=!1):n&&(l=!1),l){var a=null;if(ip_GridProps[e].editing.editing&&ip_GridProps[e].editing.editTool.isFX()&&(a="ip_grid_cell_rangeselector_transparent"),o)if(ip_GridProps[e].selectedColumn.length>0){ip_GridProps[e].selectedColumn.sort(function(e,r){return e-r});var s=ip_GridProps[e].selectedColumn[0],p=ip_GridProps[e].selectedColumn[ip_GridProps[e].selectedColumn.length-1],d=1;s>t?d=s-t:t>p&&(d=t-p,t=p+1),$("#"+e).ip_SelectColumn({multiselect:!0,col:t,count:d,rangeType:a})}else $("#"+e).ip_SelectColumn({multiselect:!1,col:t,rangeType:a});else $("#"+e).ip_SelectColumn({multiselect:ip_GridProps[e].selectedColumn.length>0?i:!1,col:t,rangeType:a})}}}),$("#"+e).on("mousedown",".ip_grid_rowSelecterCell",function(r){if(ip_GridProps[e].editing.editing&&ip_GridProps[e].editing.editTool.isFX())return void r.preventDefault();var o=r.shiftKey,i=r.ctrlKey,t=parseInt($(this).attr("row"));if("ie"==ip_GridProps.index.browser.name&&null==o&&(o=ip_GridProps[e].shiftKey,i=ip_GridProps[e].ctrlKey),!ip_GridProps[e].resizing){var l=!0,n=-1!=jQuery.inArray(t,ip_GridProps[e].selectedRow);if(1==r.which?!n||o||i||(l=!1,ip_EnableScrollAnimate(e),ip_ShowRowMove(e,t)):n&&(l=!1),l){var a=null;if(ip_GridProps[e].editing.editing&&ip_GridProps[e].editing.editTool.isFX()&&(a="ip_grid_cell_rangeselector_transparent"),o)if(ip_GridProps[e].selectedRow.length>0){ip_GridProps[e].selectedRow.sort(function(e,r){return e-r});var s=ip_GridProps[e].selectedRow[0],p=ip_GridProps[e].selectedRow[ip_GridProps[e].selectedRow.length-1],d=1;s>t?d=s-t:t>p&&(d=t-p,t=p+1),$("#"+e).ip_SelectRow({multiselect:!0,row:t,count:d,rangeType:a})}else $("#"+e).ip_SelectRow({multiselect:!1,row:t,rangeType:a});else $("#"+e).ip_SelectRow({multiselect:ip_GridProps[e].selectedRow.length>0?i:!1,row:t,rangeType:a})}}}),$("#"+e).on("click",".ip_grid_columnSelectorCellCorner",function(r){var o=(r.shiftKey,-1),i=-1;$("#"+e).ip_SelectColumn({multiselect:!1,col:o}),$("#"+e).ip_SelectRow({multiselect:!0,row:i,fetchRange:!1})}),$("#"+e).on("mousemove",".ip_grid_columnSelectorCell",function(r){var o=null;if(!ip_GridProps[e].resizing){var i=$(this).width(),t=$(this).offset().left+parseInt($(this).css("border-left-width").replace("px","")),l=r.pageX,n=l-t,a=i-n,s=a>5||0>a?!1:!0;s&&o!=this&&(o=this,ip_ShowColumnResizer(e,parseInt($(this).attr("col"))))}}),$("#"+e).on("mousemove",".ip_grid_rowSelecterCell",function(r){var o=null;if(!ip_GridProps[e].resizing){var i=$(this).height(),t=$(this).offset().top,l=r.pageY,n=l-t,a=i-n>5||0>i-n?!1:!0;if(a&&o!=this){o=this;var s=parseInt($(this).parent().attr("row"));ip_ShowRowResizer(e,s)}}}),$("#"+e).on("keydown",ip_GridProps[e].events.SetupEvents_document_keydown=function(r){if(!ip_GridProps[e].editing.editing){if(37==r.keyCode||38==r.keyCode||39==r.keyCode||40==r.keyCode||34==r.keyCode||33==r.keyCode)return null==ip_GridProps[e].timeouts.keyDownTimeout&&ip_KeyDownLoop(e,r,0),!1;if(!r.ctrlKey||67!=r.keyCode&&88!=r.keyCode&&86!=r.keyCode&&90!=r.keyCode)if(46==r.keyCode)$("#"+e).ip_ResetRange({valuesOnly:r.ctrlKey||r.shiftKey?!1:!0});else if(36==r.keyCode||35==r.keyCode){var o=ip_GridProps[e].selectedCell.row,i=ip_GridProps[e].selectedCell.col;36==r.keyCode?$("#"+e).ip_SelectCell({col:0,row:o,scrollTo:!0}):35==r.keyCode&&$("#"+e).ip_SelectCell({col:ip_GridProps[e].cols-1,row:o,scrollTo:!0})}else{var t=String.fromCharCode(r.keyCode);if(/[a-z0-9=]/i.test(t)||187==r.keyCode||8==r.keyCode){if(r.ctrlKey){var l=ip_EnabledFormats(e);return"B"==t?$("#"+e).ip_FormatCell({style:l.bold?"font-weight:;":"font-weight:bold;"}):"I"==t&&$("#"+e).ip_FormatCell({style:l.italic?"font-style:;":"font-style:italic;"}),!1}if(null!=ip_GridProps[e].selectedCell){var n=8==r.keyCode?!1:!0;$("#"+e).ip_TextEditable({clear:n,contentType:"ip_grid_CellEdit",element:ip_GridProps[e].selectedCell})}else if(1==ip_GridProps[e].selectedColumn.length){var o=-1,i=ip_GridProps[e].selectedColumn[0],a=ip_GetQuad(e,o,i);$("#"+e).ip_TextEditable({contentType:"ip_grid_ColumnType",element:$("#"+e+"_q"+a+"_columnSelectorCell_"+i),dropDown:{addNonMatched:!0,allowEmpty:!0,validate:!0,autoComplete:!0,keyField:"dataType",displayField:[{displayField:"dataTypeName",style:"font-weight:bold;"},{displayField:"dataType",style:"font-style:italic;"}],data:ip_GridProps[e].dataTypes,noMatchData:{dataTypeName:null,dataType:""}}})}}}else 67==r.keyCode?$("#"+e).ip_Copy():86==r.keyCode?$("#"+e).ip_Paste({changeFormula:!0}):88==r.keyCode?$("#"+e).ip_Copy({cut:!0}):90==r.keyCode&&$("#"+e).ip_Undo()}}),$(document).on("keyup",ip_GridProps[e].events.SetupEvents_document_keyup=function(){null!=ip_GridProps[e].timeouts.keyDownTimeout&&(clearTimeout(ip_GridProps[e].timeouts.keyDownTimeout),ip_GridProps[e].timeouts.keyDownTimeout=null)}),$("#"+e).mousewheel(function(r,o){var i=ip_GridProps[e].scrollY;return o>0?i-=4:0>o&&(i+=4),i<ip_GridProps[e].rows?i<ip_GridProps[e].frozenRows&&(i=ip_GridProps[e].frozenRows):i=ip_GridProps[e].rows-1,ip_ScrollToY(e,i,!0,"all","none"),!1}),$("#"+e).on("click",".ip_grid_cell_hideIcon",function(){var r=$(this).parent(),o=$(this).hasClass("top")||$(this).hasClass("left")?-1:1,i=parseInt($(r).attr("row")),t=parseInt($(r).attr("col")),l=-1==t?i:t,n=-1==t?ip_NextNonHiddenRow(e,i+o,null,i,o>0?"down":"up",!1):ip_NextNonHiddenCol(e,t+o,null,t,o>0?"right":"left",!1);return l>n&&(l=n,n=-1==t?i:t),-1!=i&&$("#"+e).ip_HideShowRows({action:"show",range:{startRow:l,endRow:n}}),-1!=t&&$("#"+e).ip_HideShowColumns({action:"show",range:{startCol:l,endCol:n}}),!1}),$("#"+e).on("mousedown",".ip_grid_cell_groupIcon",function(r){r.stopPropagation();for(var o=$(this).parent().parent(),i=parseInt($(o).attr("row")),t=i+1,l=t+ip_GridProps[e].rowData[i].groupCount-1,n=1==ip_GridProps[e].rowData[t].hide?"show":"hide",a=[],s=0,p=t;l>=p;p++)null!=ip_GridProps[e].rowData[p].groupCount&&ip_GridProps[e].rowData[p].groupCount>0&&l<p+ip_GridProps[e].rowData[p].groupCount&&(l=p+ip_GridProps[e].rowData[p].groupCount),"show"==n?(0==s&&(a[a.length]=p),ip_GridProps[e].rowData[p].groupCount>s?s=ip_GridProps[e].rowData[p].groupCount:s>0&&s--):a[a.length]=p;return-1!=i&&$("#"+e).ip_HideShowRows({action:n,rows:a,selectRows:!1}),!1}),$("#"+e).on("mousedown",".ip_grid_fbar_text",function(r){ip_EnableSelection(e),ip_GridProps[e].editing.editing&&r.preventDefault()}),$("#"+e).on("click",".ip_grid_fbar_text",function(){if(null!=ip_GridProps[e].selectedCell){var r=ip_GetCursorPos(e,this),o=ip_GridProps[e].editing.editing?ip_GridProps[e].editing.editTool.text():null;$("#"+e).ip_TextEditable({defaultValue:o,clear:!1,contentType:"ip_grid_fxBar",element:ip_GridProps[e].selectedCell,cursor:r})}}),$("#"+e).on("click",".ip_grid_cell_dropdownIconContainer",function(){if(null!=ip_GridProps[e].selectedCell){var r={x:0,length:$(ip_GridProps[e].selectedCell).text().length};$("#"+e).ip_TextEditable({contentType:"ip_grid_CellEdit",element:ip_GridProps[e].selectedCell,cursor:r})}}),$("#"+e).on("ip_SelectRange",function(r,o){if(ip_GridProps[e].editing.editing){var i=ip_GridProps[e].editing.editTool.text().trim(),t=o.options.SelectRange.Effected,l=null==ip_GridProps[e].editing.carret?{x:0,length:0}:ip_GridProps[e].editing.carret,n=ip_fxObject(e,i,null,null,l.x-1);if(n){var a=n.parts[n.focused.partIndex].match(ip_GridProps.index.regEx.range);a||(n.parts.length>n.focused.partIndex+1&&n.parts[n.focused.partIndex+1].match(ip_GridProps.index.regEx.range)?(n.focused.cursorI++,n.focused.partIndex++):(n.focused.cursorI++,n.focused.partIndex++,n.parts.splice(n.focused.partIndex,0,"")));
    {n.parts[n.focused.partIndex]}n.parts[n.focused.partIndex]=ip_fxRangeToString(e,t),l.x=n.focused.cursorI+n.parts[n.focused.partIndex].length,l.length=0,ip_EditToolHelp(e,n.parts.join(""),l,0,!0,!0,!0)}else ip_EnableSelection(e,!1)}else if(ip_GridProps[e].formatting.formatting){var s=ip_ValidateRangeObjects(e,ip_GridProps[e].selectedRange),p=ip_fxRangeToString(e,s);$(ip_GridProps[e].formatting.focusedControl).val(p)}})}function ip_ValidateData(e,r,o,i){null==i&&(i=!1);var t=ip_GridProps[e].colData.length,l=ip_GridProps[e].rowData.length;if(o>t)for(var n=t;o>n;n++)ip_GridProps[e].colData[n]=ip_colObject();if(-1==r&&(r=ip_GridProps[e].rows,l=0),r>l)for(var a=l;r>a;a++)null==ip_GridProps[e].rowData[a]?ip_GridProps[e].rowData[a]=ip_rowObject(ip_GridProps[e].dimensions.defaultRowHeight,null,a,o,i):null==ip_GridProps[e].rowData[a].cells&&(ip_GridProps[e].rowData[a]=ip_rowObject(ip_GridProps[e].dimensions.defaultRowHeight,null,a,o,i)),ip_ValidateDataCols(e,ip_GridProps[e].rowData[a],o,a)}function ip_ValidateDataCols(e,r,o,i){var t=r.cells.length;if(-1==o&&(o=ip_GridProps[e].cols,t=0),null==ip_GridProps[e].colData&&(ip_GridProps[e].colData=Array(o)),o>t)for(var l=t;o>l;l++){var n=i+" x "+l;null==r.cells[l]&&(r.cells[l]=ip_cellObject(n,null,null,i,l)),null==ip_GridProps[e].colData[l]&&(ip_GridProps[e].colData[l]=ip_colObject())}}function ip_SetupMerges(e,r){if(null!=r&&r.length>0)for(var o=0;o<r.length;o++){var i=r[o].mergedWithRow,t=r[o].mergedWithCol,l=i+r[o].rowSpan-1,n=t+r[o].colSpan-1;ip_SetCellMerge(e,i,t,l,n)}}function ip_SetupFx(e){$("#"+e).ip_AddFormula({formulaName:"range",functionName:"ip_fxRange",tip:"Specifies a range of cells, by default the first cell in range is returned.",inputs:"[row][col]:[row][col]",example:"A1 or A1:B5"}),$("#"+e).ip_AddFormula({formulaName:"count",functionName:"ip_fxCount",tip:"Counts the number of cells which have numberic values. Ignores cells that are empty or text.",inputs:"(range1, range2, ... )",example:"count( a1, b1:b5, a3 )"}),$("#"+e).ip_AddFormula({formulaName:"sum",functionName:"ip_fxSum",tip:"Adds the numbers in a range. Ignores cells that are empty or text.",inputs:"( range1, range2, ... )",example:"sum( a1, b1:b5, a3 )"}),$("#"+e).ip_AddFormula({formulaName:"concat",functionName:"ip_fxConcat",tip:"Joins the values of cells into one text string.",inputs:"( range1, range2, ... )",example:"concat( a1, b1:b5, a3 )"}),$("#"+e).ip_AddFormula({formulaName:"dropdown",functionName:"ip_fxDropDown",tip:"Fetches a range and returns the values as a dropdown object",inputs:"( range1, range2, ... )",example:"dropdown( a1, b1:b5, a3 )"}),$("#"+e).ip_AddFormula({formulaName:"gantt",functionName:"ip_fxGantt",tip:"Returns true or false if the base date falls within start and end date ranges",inputs:"( BaseDate, StartDate, EndDate, TaskName, ProjectName (optional) )",example:"<br/>gantt( 2014-07-15, 2014-07-01, 2014-07-31, Cost of sales report, General Management )<br/>gantt( today(0), a1, a2, Cost of sales report, General Management )"}),$("#"+e).ip_AddFormula({formulaName:"max",functionName:"ip_fxMax",tip:"Returns the largest number in a range. Ignores cells that are empty or text.",inputs:"( range1, range2, ... )",example:"sum( a1, b1:b5, a3 )"}),$("#"+e).ip_AddFormula({formulaName:"today",functionName:"ip_fxToday",tip:"Returns todays date",inputs:"(increment in days)",example:"<br/>today( 0 )<br/>today( -1 )<br/>today( 1 )"}),$("#"+e).ip_AddFormula({formulaName:"date",functionName:"ip_fxDate",tip:"Returns the current date",inputs:"(increment in days)",example:"<br/>date( 0 )<br/>date( -1 )<br/>date( 1 )"}),$("#"+e).ip_AddFormula({formulaName:"day",functionName:"ip_fxDay",tip:"Returns the calendar day in month",inputs:"(increment in days)",example:"<br/>day( 0 )<br/>day( -1 )<br/>day( 1 )"})}function ip_SetupMask(e){$("#"+e).ip_AddMask({title:"Short Date",dataType:"date",mask:"yyyy-mm-dd",input:function(e){var r=ip_parseDate(e,"yyyy-mm-dd");return r||(r=ip_parseDate(e)),r},output:function(r,o){var i=ip_formatDate(e,r,o,"yyyy-mm-dd");return 0==i&&"boolean"==typeof i?r:i}}),$("#"+e).ip_AddMask({title:"Short Date/Time",dataType:"date",mask:"yyyy-mm-dd hh:mm",input:function(e){var r=ip_parseDate(e,"yyyy-mm-dd hh:mm");return r||(r=ip_parseDate(e)),r},output:function(r,o){var i=ip_formatDate(e,r,o,"yyyy-mm-dd hh:mm");return 0==i&&"boolean"==typeof i?r:i}}),$("#"+e).ip_AddMask({title:"Short Date/Time/Seconds",dataType:"date",mask:"yyyy-mm-dd hh:mm:ss",input:function(e){var r=ip_parseDate(e,"yyyy-mm-dd hh:mm:ss");return r||(r=ip_parseDate(e)),r},output:function(r,o){var i=ip_formatDate(e,r,o,"yyyy-mm-dd hh:mm:ss");return 0==i&&"boolean"==typeof i?r:i}}),$("#"+e).ip_AddMask({title:"Long Date",dataType:"date",mask:"dd-mon-yyyy",input:function(e){var r=ip_parseDate(e,"dd-mon-yyyy");return r||(r=ip_parseDate(e)),r},output:function(r,o){var i=ip_formatDate(e,r,o,"dd-mon-yyyy");return 0==i&&"boolean"==typeof i?r:i}}),$("#"+e).ip_AddMask({title:"Full Date",dataType:"date",mask:"Wed Jul 01 2015 00:00:00 GMT+0200 (US Standard Time)",input:function(e){var r=ip_parseDate(e,"full");return r||(r=ip_parseDate(e)),r},output:function(r,o){var i=ip_formatDate(e,r,o,"full");return 0==i&&"boolean"==typeof i?r:i}}),$("#"+e).ip_AddMask({title:"Standard",dataType:"number",mask:"123",input:function(e){if(null==e)return null;var r=(""+e).replace(/[\s,]/gi,"");return ip_parseNumber(r)},output:function(r,o,i){var t=ip_formatNumber(e,r,o,"123",i);return 0==t&&"boolean"==typeof t?r:t}}),$("#"+e).ip_AddMask({title:"International",dataType:"number",mask:"1 000 000.00",input:function(e){if(null==e)return null;var r=(""+e).replace(/[\s,]/gi,"");return ip_parseNumber(r)},output:function(r,o,i){var t=ip_formatNumber(e,r,o,"1 000 000.00",i);return 0==t&&"boolean"==typeof t?r:t}}),$("#"+e).ip_AddMask({title:"US Number",dataType:"number",mask:"1,000,000.00",input:function(e){if(null==e)return null;var r=(""+e).replace(/[^0-9.]/gi,"");return ip_parseNumber(r)},output:function(r,o,i){var t=ip_formatNumber(e,r,o,"1,000,000.00",i);return 0==t&&"boolean"==typeof t?r:t}}),$("#"+e).ip_AddMask({title:"Test number",dataType:"Test Number",mask:"1#000#000.00",input:function(e){if(null==e)return null;var r=(""+e).replace(/[^0-9.]/gi,"");return ip_parseNumber(r)},output:function(r,o,i){if(null==r)return null;var t=(""+r).replace(/[\s,]/gi,"");return t=ip_formatNumber(e,t,o,"1,000,000.00",i),0==t&&"boolean"==typeof t?r:t=t.replace(/[,]/gi,"#")}}),$("#"+e).ip_AddMask({title:"US Dollar",dataType:"currency",mask:"$1 000.00",input:function(e){if(null==e)return null;var r=(""+e).replace(/[^0-9.]/gi,"");return ip_parseNumber(r)},output:function(r,o,i){if(null==r||""==r)return r;var t=ip_formatCurrency(e,r,o,"$1,000,000.00",i);return 0==t&&"boolean"==typeof t?r:t}}),$("#"+e).ip_AddMask({title:"Rand",dataType:"currency",mask:"R1 000.00",input:function(e){if(null==e)return null;var r=(""+e).replace(/[^0-9.]/gi,"");return ip_parseNumber(r)},output:function(r,o,i){if(null==r||""==r)return r;var t=ip_formatCurrency(e,r,o,"R1,000,000.00",i);return 0==t&&"boolean"==typeof t?r:t}})}function ip_ReloadRanges(e,r){r||(r=!1);var o=ip_GridProps[e].selectedRange;$("#"+e).ip_RemoveRange();for(var i=0;i<o.length;i++)$("#"+e).ip_SelectRange({multiselect:!0,startCellOrdinates:o[i][0],endCellOrdinates:o[i][1],fadeIn:r});ip_GridProps[e].selectedRange=o;var t=ip_GridProps[e].highlightRange;$("#"+e).ip_RemoveRangeHighlight();for(var i=0;i<t.length;i++)$("#"+e).ip_RangeHighlight({multiselect:!0,startCellOrdinates:t[i][0],endCellOrdinates:t[i][1],borderStyle:t[i][2],borderColor:t[i][3],highlightType:t[i][4],fadeIn:r,expireTimeout:t[i][5]});ip_GridProps[e].highlightRange=t}function ip_RePoistionRanges(e,r,o,i){if(r=null==r?"":r,"ip_grid_cell_rangeselector"==r||"all"==r)for(var t=0;t<ip_GridProps[e].selectedRange.length;t++)ip_RePoistionRange(e,!1,ip_GridProps[e].selectedRange[t],o,i);if("ip_grid_cell_rangeHighlight"==r||"all"==r)for(var t=0;t<ip_GridProps[e].highlightRange.length;t++)ip_RePoistionRange(e,!0,ip_GridProps[e].highlightRange[t],o,i)}function ip_RePoistionRange(e,r,o,i,t){var l=o[0],n=o[1],a=(o[2],o[3]),s=l[0],p=l[1],d=n[0],c=n[1],_=ip_CellHtml(e,s,p,!0),u=ip_CellHtml(e,d,c,!0),g=$("#"+e+(r?"_RangeHighlight_":"_range_")+s+"_"+p+"_"+d+"_"+c+":not(.ip_grid_cell_rangeselector_move)");if(g.length>0){if(t){var w=ip_CalculateRangeTop(e,g,_,s,p,d,c);if(a[0]=w,$(g).css("top",w+"px"),$(g).hasClass("ip_grid_cell_rangeselector_Resize"))ip_CalculateRangeDimensions(e,g,null,null,"",$(_).height(),$(_).width(),w,a[1]);else{var f=ip_SetRangeHeight(e,g,_,u,l,n);$(g).height(f)}}if(i){var h=ip_CalculateRangeLeft(e,g,_,s,p,d,c);if(a[1]=h,$(g).css("left",h+"px"),$(g).hasClass("ip_grid_cell_rangeselector_Resize"))ip_CalculateRangeDimensions(e,g,null,null,"",$(_).height(),$(_).width(),a[0],h);else{var m=ip_SetRangeWidth(e,g,_,u,l,n,null,h);$(g).width(m)}}}}function ip_CalculateRangeDimensions(e,r,o,i,t,l,n,a,s){if(null!=i&&(ip_GridProps[e].currentMousePos.pageX=i.pageX,ip_GridProps[e].currentMousePos.pageY=i.pageY),null==a||null==s){var o=null==o?ip_GetRangeIndex(e,r):o;a=null==a?ip_GridProps[e].selectedRange[o][3][0]:a,s=null==s?ip_GridProps[e].selectedRange[o][3][1]:s}if("x"!=t){var p=Math.round(a),d=Math.round($(r).position().top),c=Math.round($(r).offset().top),_=ip_GridProps[e].currentMousePos.pageY-c,u=p;_>0&&d>p-1?(_-=10,l>_&&(_=l),p>u&&(u=p),$(r).css("top",u+"px"),$(r).height(_)):(u=d+_+10,_=p-u+l,l>_&&(_=l),u>p&&(u=p),$(r).css("top",u+"px"),$(r).height(_))}if("Y"!=t){var g=s,w=Math.round($(r).position().left),f=Math.round($(r).offset().left),h=ip_GridProps[e].currentMousePos.pageX-f,m=g;0>h||g>w?(m=w+h+10,h=g-m+n,n>h&&(h=n),m>g&&(m=g),$(r).css("left",m+"px"),$(r).width(h)):(h-=10,n>h&&(h=n),g>m&&(m=g),$(r).css("left",m+"px"),$(r).width(h))}}function ip_SetRangeWidth(e,r,o,i,t,l){var n=0;if(null==o&&null==i)return n;var a=(t[0],t[1]),s=(l[0],l[1]),p=ip_LoadedRowsCols(e,!1,!1,!0),d=a,c=s;if(a<ip_GridProps[e].frozenCols){s<ip_GridProps[e].frozenCols&&(n-=parseInt($(o).css("border-left-width").replace("px",""))+parseInt($(o).css("border-right-width").replace("px",""))),a<p.colFrom_frozen&&(d=p.colFrom_frozen),s>p.colTo_frozen&&(c=p.colTo_frozen);for(var _=d;c>=_;_++)n+=ip_ColWidth(e,_,!0)}if(s<ip_GridProps[e].frozenCols||s>p.colTo_scroll)s<p.colTo_scroll||(n+=ip_GridProps[e].dimensions.accumulativeScrollWidth);else{if(0==n&&(n-=parseInt($(o).css("border-left-width").replace("px",""))+parseInt($(o).css("border-right-width").replace("px",""))),d=a,c=s,a<p.colFrom_scroll&&(d=p.colFrom_scroll),s>p.colTo_scroll&&(c=p.colTo_scroll),a>p.colTo_scroll)return n;if(s<p.colFrom_scroll)return n;for(var _=d;c>=_;_++)n+=ip_ColWidth(e,_,!0)}return n}function ip_SetRangeHeight(e,r,o,i,t,l){var n=0;if(null==o&&null==i)return 0;var a=t[0],s=(t[1],l[0]),p=(l[1],ip_LoadedRowsCols(e,!1,!0,!1)),d=a,c=s;if(a<ip_GridProps[e].frozenRows){a<p.rowFrom_frozen&&(d=p.rowFrom_frozen),s>p.rowTo_frozen&&(c=p.rowTo_frozen);for(var _=d;c>=_;_++)n+=ip_RowHeight(e,_,!0)}if(s<ip_GridProps[e].frozenRows||s>p.rowTo_scroll)s<p.rowTo_scroll||(n+=ip_GridProps[e].dimensions.accumulativeScrollHeight);else{if(d=a,c=s,a<p.rowFrom_scroll&&(d=p.rowFrom_scroll),s>p.rowTo_scroll&&(c=p.rowTo_scroll),a>p.rowTo_scroll)return n;if(s<p.rowFrom_scroll)return n;for(var _=d;c>=_;_++)n+=ip_RowHeight(e,_,!0)}return(s<ip_GridProps[e].frozenRows||a>=ip_GridProps[e].frozenRows)&&(n-=parseInt($(o).css("border-top-width").replace("px",""))+parseInt($(o).css("border-bottom-width").replace("px",""))),n}function ip_ChangeRange(e,r,o,i,t,l,n,a){if(ip_GridProps[e].selectedRange.length>0){ip_DisableSelection(e,!0),n=null==n?!1:n,t=null==t?0:t,l=null==l?0:l,i=null==i?80:i,a=null==a?0:a;{var s=r[0][0],p=r[0][1],d=r[1][0],c=r[1][1],_=ip_GetQuad(e,s,p),u=_,g=r[2][0],w=r[2][1],f=s,h=p,m=(null==o?g>s?s:d:parseInt($(o).attr("row")))+t,v=(null==o?w>p?p:c:parseInt($(o).attr("col")))+l,C=-2,R=-2,G=$("#"+e+"_range_"+s+"_"+p+"_"+d+"_"+c),P=ip_GetRangeIndex(e,G),y=null,D="",T=null;ip_GenerateTransactionID()}if(g>m?(f=m,m=g):f=g,w>v?(h=v,v=w):h=w,s>f||d>m?D="up":f>s||m>d?D="down":p>h||c>v?D="left":(h>p||v>c)&&(D="right"),0!=a){var b=ip_GridProps[e].frozenRows,x=ip_GridProps[e].frozenCols;"down"!=D||b>m||m>ip_GridProps[e].scrollY?"right"!=D||x>v||v>ip_GridProps[e].scrollX||(v=ip_GridProps[e].scrollX):m=ip_GridProps[e].scrollY,"down"!=D||f>b||m!=d?"right"!=D||h>x||v!=c||(a=0):a=0,0==t||m>b+("up"==D?-1:0)?0==l||v>x+("left"==D?-1:0)||(a=0):a=0}0>f&&(f=0),0>h&&(h=0),0>m&&(m=0),0>v&&(v=0),f<ip_GridProps[e].rows||(f=ip_GridProps[e].rows-1),h<ip_GridProps[e].cols||(h=ip_GridProps[e].cols-1),m<ip_GridProps[e].rows||(m=ip_GridProps[e].rows-1),v<ip_GridProps[e].cols||(v=ip_GridProps[e].cols-1);var S=ip_GetRangeMergedCells(e,f,h,m,v);f=S.startRow,h=S.startCol,m=S.endRow,v=S.endCol;var I=[f,h],z=[m,v];0!=a&&(T=ip_ScrollCell(e,D,f,h,m,v,a,"ip_grid_cell_rangeHighlight")),y=ip_CellHtml(e,f,h,!0),o=ip_CellHtml(e,m,v,!0),C=ip_CalculateRangeTop(e,G,y,f,h,m,v),R=ip_CalculateRangeLeft(e,G,y,f,h,m,v),u=ip_GetQuad(e,f,h),_!=u&&$(G).appendTo("#"+e+"_q"+u+"_div_container"),-1>C||$(G).css("top",C+"px"),-1>R||$(G).css("left",R+"px");var E=ip_SetRangeWidth(e,G,y,o,I,z),M=ip_SetRangeHeight(e,G,y,o,I,z);RangeID=ip_setRangeID(e,G,I,z),ip_GridProps[e].selectedRange[P][0]=I,ip_GridProps[e].selectedRange[P][1]=z,n&&(ip_GridProps[e].selectedRange[P][2]=I,ip_GridProps[e].selectedRange[P][3]=[C,R]),ip_GridProps[e].selectedColumn.indexOf(p)>-1&&$("#"+e).ip_UnselectColumn({col:p}),ip_GridProps[e].selectedRow.indexOf(s)>-1&&$("#"+e).ip_UnselectRow({col:s}),$(G).removeClass("ip_grid_cell_rangeselector_Resize"),$(G).width(E),$(G).height(M),n||1!=ip_GridProps[e].mouseButton||(ip_GridProps[e].events.moveRange_mouseUp=ip_UnBindEvent(document,"mouseup",ip_GridProps[e].events.moveRange_mouseUp),$(document).mouseup(ip_GridProps[e].events.moveRange_mouseUp=function(){ip_GridProps[e].events.moveRange_mouseUp=ip_UnBindEvent(document,"mouseup",ip_GridProps[e].events.moveRange_mouseUp),ip_GridProps[e].selectedRange[P][2]=I,ip_GridProps[e].selectedRange[P][3]=[C,R]}));var k={startRow:I[0],startCol:I[1],endRow:z[0],endCol:z[1]};ip_GridProps[e].resizing=!1;var O=k;return ip_RaiseEvent(e,"ip_SelectRange",ip_GeneratePublicKey(),{SelectRange:{Inputs:null,Effected:O}}),k}}function ip_SelectTextTool(e,r,o,i,t,l){l=null==l?!1:l,r=null==r?0:r,o=null==r?0:o,i=null==r?-1:i,t=null==r?-1:t,0>r&&(r=0),0>o&&(o=0);for(var n="",a=r;i>=a;a++){for(var s=o;t>=s;s++)n+=ip_GridProps[e].rowData[a].cells[s].value+(t>s?"	":"");n+=i>a?"\r\n":""}l&&(n=$("#"+e+"_selectTool").val()+"\r\n"+n),$("#"+e+"_selectTool").val(n),$("#"+e).enableSelection(),$("#"+e+"_selectTool").select(),$(document).disableSelection()}function ip_GetRangeIndex(e,r){for(var o=parseInt($(r).attr("startRow")),i=parseInt($(r).attr("startCol")),t=parseInt($(r).attr("endRow")),l=parseInt($(r).attr("endCol")),n=0;n<ip_GridProps[e].selectedRange.length;n++)if(ip_GridProps[e].selectedRange[n][0][0]==o&&ip_GridProps[e].selectedRange[n][0][1]==i&&ip_GridProps[e].selectedRange[n][1][0]==t&&ip_GridProps[e].selectedRange[n][1][1]==l)return n;return-1}function ip_CalculateRangeTop(e,r,o,i,t,l,n,a){var s=parseInt($(o).attr("row")),p=ip_GetQuad(e,s);if(i>=ip_GridProps[e].frozenRows){if(i>ip_GridProps[e].scrollY+ip_GridProps[e].loadedRows)return ip_GridProps[e].dimensions.scrollHeight;if(l<ip_GridProps[e].scrollY)return 0}var d=parseInt($(o).attr("col")),c=ip_CellRelativePosition(e,s,d),_=0,u=parseInt($(r).css("border-top-width").replace("px","")),g=c.localTop-u+_;return 1!=a&&-1==s?g+=ip_GridProps[e].dimensions.columnSelectorHeight+u:1==a&&-1==s&&(g+=u),(3==p||4==p)&&g>$("#"+e+"_q4_scrollbar_container_x").position().top&&(g=$("#"+e+"_q4_scrollbar_container_x").position().top-u),-1>g&&(g=-1),g}function ip_CalculateRangeLeft(e,r,o,i,t,l,n,a){if(t>=ip_GridProps[e].frozenCols){if(t>ip_GridProps[e].scrollX+ip_GridProps[e].loadedCols)return ip_GridProps[e].dimensions.scrollWidth;if(n<ip_GridProps[e].scrollX)return 0}var s=parseInt($(o).attr("row")),p=parseInt($(o).attr("col")),d=ip_CellRelativePosition(e,s,p),c=parseInt($(o).css("border-left-width").replace("px",""))+parseInt($(o).css("border-right-width").replace("px","")),_=parseInt($(r).css("border-left-width").replace("px",""))+parseInt($(o).css("border-right-width").replace("px","")),u=d.localLeft-_+c;return 1!=a&&-1==p?u+=ip_GridProps[e].dimensions.rowSelectorWidth+c/2:1==a&&-1==p&&(u+=c/2),-1>u&&(u=-(_-c)),u}function ip_setRangeID(e,r,o,i){var t=o[0],l=o[1],n=i[0],a=i[1],s=e+"_range_"+t+"_"+l+"_"+n+"_"+a;return $(r).attr("id",s),$(r).attr("startRow",t),$(r).attr("startCol",l),$(r).attr("endRow",n),$(r).attr("endCol",a),s}function ip_ValidateRangeOptions(e,r){var r=$.extend({range:{startRow:null,startCol:null,endRow:null,endCol:null},startCellOrdinates:[0,0],endCellOrdinates:null,startCell:null,endCell:null,mergedstartRow:null,mergedEndRow:null,mergedEndCol:null,mergedEndEnd:null,returnLastIfNull:!0,considerMerges:!0},r);if(null!=r.range.startRow&&null!=r.range.startCol?(r.startCellOrdinates=[r.range.startRow,r.range.startCol],r.startCell=ip_CellHtml(e,r.startCellOrdinates[0],r.startCellOrdinates[1],!0)):r.startCell?(r.startCellOrdinates=[parseInt($(r.startCell).attr("row")),parseInt($(r.startCell).attr("col"))],r.range.startRow=r.startCellOrdinates[0],r.range.startCol=r.startCellOrdinates[1]):(r.range.startRow=r.startCellOrdinates[0],r.range.startCol=r.startCellOrdinates[1],r.startCell=ip_CellHtml(e,r.startCellOrdinates[0],r.startCellOrdinates[1],!0)),null!=r.range.endRow&&null!=r.range.endCol?(r.endCellOrdinates=[r.range.endRow,r.range.endCol],r.endCell=ip_CellHtml(e,r.endCellOrdinates[0],r.endCellOrdinates[1],!0)):r.endCell?(r.endCellOrdinates=[parseInt($(r.endCell).attr("row")),parseInt($(r.endCell).attr("col"))],r.range.endRow=r.startCellOrdinates[0],r.range.endCol=r.startCellOrdinates[1]):r.endCellOrdinates?(r.range.endRow=r.endCellOrdinates[0],r.range.endCol=r.endCellOrdinates[1],r.endCell=ip_CellHtml(e,r.endCellOrdinates[0],r.endCellOrdinates[1],!0)):(r.endCellOrdinates=[r.startCellOrdinates[0],r.startCellOrdinates[1]],r.range.endRow=r.endCellOrdinates[0],r.range.endCol=r.endCellOrdinates[1],r.endCell=r.startCell),r.range.startRow<(ip_GridProps[e].selectedColumn.length>0?-1:0))return!1;if(r.range.startCol<(ip_GridProps[e].selectedRow.length>0?-1:0))return!1;if(r.range.endRow<0)return!1;if(r.range.endCol<0)return!1;if(r.range.startRow>=ip_GridProps[e].rows)return!1;if(r.range.startCol>=ip_GridProps[e].cols)return!1;if(r.range.endRow>=ip_GridProps[e].rows)return!1;if(r.range.endCol>=ip_GridProps[e].cols)return!1;if(r.considerMerges){var o=ip_GetRangeMergedCells(e,r.startCellOrdinates[0],r.startCellOrdinates[1],r.endCellOrdinates[0],r.endCellOrdinates[1]);o.endMerge&&(endCell=ip_CellHtml(e,o.endRow,o.endCol,!0),r.endCell=endCell,r.endCellOrdinates[0]=o.endRow,r.endCellOrdinates[1]=o.endCol,r.range.endRow=o.endRow,r.range.endCol=o.endCol,r.mergedEndRow=o.endRow,r.mergedEndCol=o.endCol,startCell=ip_CellHtml(e,o.startRow,o.startCol,!0),r.startCell=startCell,r.startCellOrdinates[0]=o.startRow,r.startCellOrdinates[1]=o.startCol,r.range.startRow=o.startRow,r.range.startCol=o.startCol,r.mergedStartRow=o.startRow,r.mergedStartCol=o.startCol)}return r}function ip_ShowRangeMove(e,r,o,i){ip_GridProps[e].resizing=!0,$("#"+e).ip_RemoveRangeHighlight();var t=$(i).attr("borderPosition"),l={clientX:o.clientX,clientY:o.clientY};"left"==t&&(l.clientX+=3),"right"==t&&(l.clientX-=3),"top"==t&&(l.clientY+=3),"bottom"==t&&(l.clientY-=3);var n=ip_SetHoverCell(e,r,l,!0),a=parseInt($(n).attr("row")),s=parseInt($(n).attr("col")),p=[];$("#"+e).ip_Copy({cut:!0,toClipBoard:!1});var d=$("#"+e+" .ip_grid_cell_rangeselector_selected");$(d).addClass("ip_grid_cell_rangeselector_move"),$(d).children(".ip_grid_cell_rangeselector_key").hide(),$(d).children(".ip_grid_cell_rangeselector_border").hide();for(var c=0;c<ip_GridProps[e].selectedRange.length;c++){var _=e+"_range_"+ip_GridProps[e].selectedRange[c][0][0]+"_"+ +ip_GridProps[e].selectedRange[c][0][1]+"_"+ +ip_GridProps[e].selectedRange[c][1][0]+"_"+ +ip_GridProps[e].selectedRange[c][1][1],u=$("#"+_);p[c]={StartX:$(u).position().left,StartY:$(u).position().top,StartCellOrdinates:ip_GridProps[e].selectedRange[c][0],EndCellOrdinates:ip_GridProps[e].selectedRange[c][1],RangeEl:u}}var g=p[0].StartCellOrdinates[0],w=p[0].StartCellOrdinates[1],f=-1,h=-1,m=null;ip_GridProps[e].events.moveRange_mouseMove=ip_UnBindEvent("#"+e,"mousemove",ip_GridProps[e].events.moveRange_mouseMove),$("#"+e).mousemove(ip_GridProps[e].events.moveRange_mouseMove=function(r){-1==f&&(f=r.pageX),-1==h&&(h=r.pageY);for(var o=r.pageX-f,i=r.pageY-h,l=0;l<p.length;l++){var n=p[l].StartX+o,d=p[l].StartY+i;"left"==t&&(n+=15),"right"==t&&(n-=15),"top"==t&&(d+=15),"bottom"==t&&(d-=15),$(p[l].RangeEl).css("left",n+"px"),$(p[l].RangeEl).css("top",d+"px")}m==ip_GridProps[e].hoverCell||ip_GridProps[e].scrollAnimate?ip_GridProps[e].scrollAnimate&&null!=ip_GridProps[e].events.showRangeMove_highlightMovePosition&&(clearTimeout(ip_GridProps[e].events.showRangeMove_highlightMovePosition),ip_GridProps[e].events.showRangeMove_highlightMovePosition=null,$("#"+e).ip_RemoveRangeHighlight({highlightType:"ip_grid_cell_rangeHighlight_hoverCell"})):(clearTimeout(ip_GridProps[e].events.showRangeMove_highlightMovePosition),m=ip_SetHoverCell(e,".ip_grid_cell_rangeselector_move",r,!0),ip_GridProps[e].events.showRangeMove_highlightMovePosition=setTimeout(function(){var r=parseInt($(m).attr("row")),o=parseInt($(m).attr("col")),i=r-(a-g),t=o-(s-w);ip_HighlightMovePosition(e,i,t)},100))}),ip_GridProps[e].events.moveRange_mouseUp=ip_UnBindEvent(document,"mouseup",ip_GridProps[e].events.moveRange_mouseUp),$(document).mouseup(ip_GridProps[e].events.moveRange_mouseUp=function(r){clearTimeout(ip_GridProps[e].events.showRangeMove_highlightMovePosition),ip_GridProps[e].events.moveRange_mouseMove=ip_UnBindEvent("#"+e,"mousemove",ip_GridProps[e].events.moveRange_mouseMove),ip_GridProps[e].events.moveRange_mouseUp=ip_UnBindEvent(document,"mouseup",ip_GridProps[e].events.moveRange_mouseUp);var o=ip_SetHoverCell(e,".ip_grid_cell_rangeselector_move",r,!0),i=parseInt($(o).attr("row")),l=parseInt($(o).attr("col"));if($("#"+e).ip_RemoveRangeHighlight({highlightType:"ip_grid_cell_rangeHighlight_hoverCell"}),n!=o){0>g&&(g=0),0>w&&(w=0),(g<=ip_GridProps[e].scrollY&&"top"==t||0>a)&&(a=g),(w<=ip_GridProps[e].scrollX&&"left"==t||0>s)&&(s=w);var d=i-(a-g),c=l-(s-w);$("#"+e).ip_Paste({changeFormula:!0,row:d,col:c})}else{$("#"+e).ip_ClearCopy();for(var _=0;_<p.length;_++)$("#"+e).ip_SelectRange({startCellOrdinates:p[_].StartCellOrdinates,endCellOrdinates:p[_].EndCellOrdinates,multiselect:0==_?!1:!0})}ip_GridProps[e].resizing=!1})}function ip_ValidateRangeOverlap(e,r){for(var o=[],i=[],t=0;t<r.length;t++)for(j=0;j<r.length;j++)if(t!=j){var l=r[t].startRow,n=r[t].endRow,a=r[t].startCol,s=r[t].endCol,p=r[j].startRow,d=r[j].endRow,c=r[j].startCol,_=r[j].endCol,u=p+""+c;null==i[u]&&((l>p||p>n||a>c||c>s)&&(l>d||d>n||a>c||c>s)&&(l>p||p>n||a>_||_>s)&&(l>d||d>n||a>_||_>s)?l>d||p>n||a>_||_>s||(i[u]=!0,o[o.length]=r[j]):(i[u]=!0,o[o.length]=r[j]))}return o}function ip_HighlightMovePosition(e,r,o){if(ip_GridProps[e].selectedRange.length>0)for(var i=r-ip_GridProps[e].selectedRange[0][0][0],t=o-ip_GridProps[e].selectedRange[0][0][1],l=0;l<ip_GridProps[e].selectedRange.length;l++){var n=ip_GridProps[e].selectedRange[l],a=n[0][0]+i,s=n[0][1]+t,p=n[1][0]+i,d=n[1][1]+t;$("#"+e).ip_RangeHighlight({fadeIn:!0,multiselect:0==l?!1:!0,highlightType:"ip_grid_cell_rangeHighlight_hoverCell",range:{startRow:a,startCol:s,endRow:p,endCol:d}})}}function ip_GetRangeData(e,r,o,i,t,l,n,a,s,p,d){var c=-1,_=-1,u={},g={rowData:[],mergeData:[],mergeData:[],mergeDataContained:[],startRow:o,startCol:i,endRow:t,endCol:l,rowDataLoading:!1},w=0,f=null,h=0;null==a&&(a=!0),null==n&&(n=!1),null==s&&(s=!1);for(var m=o;t>=m;m++){var v=0;g.rowData[w]=ip_CloneRow(e,m),ip_GridProps[e].rowData[m].loading&&(g.rowDataLoading=!0),d&&(0==h&&(f=m),ip_GridProps[e].rowData[m].groupCount>h?h=ip_GridProps[e].rowData[m].groupCount:h>0&&h--);for(var C=i;l>=C;C++){var R=ip_GridProps[e].rowData[m].cells[C].merge,G=m,P=C;if(null!=R&&s&&(G=R.mergedWithRow,P=R.mergedWithCol),ip_IsCellEmpty(e,m,C)||(m>c&&(c=m),C>_&&(_=C)),g.rowData[w].cells[v]=r?ip_GridProps[e].rowData[G].cells[P]:ip_CloneCell(e,G,P,m,C),null!=f&&(g.rowData[w].cells[v].groupValue=ip_GridProps[e].rowData[f].cells[C].value),null!=R&&a){var y=R.mergedWithRow+"-"+R.mergedWithCol;if(null==u[y]){u[y]=!0,R=ip_GridProps[e].rowData[R.mergedWithRow].cells[R.mergedWithCol].merge,g.mergeData[g.mergeData.length]=ip_mergeObject(),g.mergeData[g.mergeData.length-1].mergedWithRow=R.mergedWithRow,g.mergeData[g.mergeData.length-1].mergedWithCol=R.mergedWithCol,g.mergeData[g.mergeData.length-1].rowSpan=R.rowSpan,g.mergeData[g.mergeData.length-1].colSpan=R.colSpan,g.mergeData[g.mergeData.length-1].containsOverlap=ip_DoesRangeOverlapMerge(e,R,o,i,t,l);var D=R.mergedWithRow,T=R.mergedWithCol,b=D+R.rowSpan-1,x=T+R.colSpan-1;o>D&&(D=o),i>T&&(T=i),b>t&&(b=t),x>l&&(x=l),g.mergeDataContained[g.mergeDataContained.length]=ip_mergeObject(),g.mergeDataContained[g.mergeDataContained.length-1].mergedWithRow=D,g.mergeDataContained[g.mergeDataContained.length-1].mergedWithCol=T,g.mergeDataContained[g.mergeDataContained.length-1].rowSpan=b-D+1,g.mergeDataContained[g.mergeDataContained.length-1].colSpan=x-T+1}}v++}w++}if(n){if(c>-1){g.rowData.splice(c+1,g.rowData.length);for(var m=0;m<g.rowData.length;m++)g.rowData[m].cells.splice(_+1,g.rowData[m].cells.length);for(var S=0;S<g.mergeData.length;S++)(g.mergeData[S].mergedWithRow>c||g.mergeData[S].mergedWithCol>_)&&g.mergeData.splice(S,1);for(var S=0;S<g.mergeDataContained.length;S++)(g.mergeDataContained[S].mergedWithRow>c||g.mergeDataContained[S].mergedWithCol>_)&&g.mergeData.splice(S,1);if(null!=ip_GridProps[e].rowData[c].cells[_].merge)var R=ip_GridProps[e].rowData[c].cells[_].merge,c=R.mergedWithRow+ip_GridProps[e].rowData[R.mergedWithRow].cells[R.mergedWithCol].merge.rowSpan-1,_=R.mergedWithCol+ip_GridProps[e].rowData[R.mergedWithRow].cells[R.mergedWithCol].merge.colSpan-1}else g.rowData=[],g.mergeData=[],g.mergeData=[],g.mergeDataContained=[];g.endRow=c,g.endCol=_}return g}function ip_DragRange(e,r){var r=$.extend({range:null,dragToRange:null},r),o=ip_GenerateTransactionID(),i="",t={rowData:[],dragFromRange:ip_rangeObject(),dragToRange:ip_rangeObject()};if(null!=r.range&&null!=r.dragToRange){for(var l={},n=r.range.endRow;n>=r.range.startRow;n--)for(var a=r.dragToRange.startCol;a<=r.dragToRange.endCol;a++){var s=ip_CellDataType(e,n,a,!0),p=ip_CellDataType(e,n-1,a,!0);null==l[a]&&(l[a]={startPatternRow:r.range.startRow,endPatternRow:r.dragToRange.endRow,repeatPattern:Math.ceil((r.dragToRange.endRow-r.range.endRow+1)/(r.range.endRow-r.range.startRow+1)),rangeIncrement:r.range.endRow-r.range.startRow+1,dataTypeIncrement:{},values:Array(r.range.endRow-r.range.startRow+1),index:r.range.endRow-r.range.startRow}),null==l[a].dataTypeIncrement[s.dataType.dataType]&&(l[a].dataTypeIncrement[s.dataType.dataType]=0),l[a].dataTypeIncrement[s.dataType.dataType]++,l[a].values[l[a].index]="number"==s.dataType.dataType?{increment:n>r.range.startRow&&"number"==p.dataType.dataType?s.value-p.value:l[a].index+1<l[a].values.length?l[a].values[l[a].index+1].increment:0,value:s.value,dataType:s.dataType,dataTypeO:ip_GridProps[e].rowData[n].cells[a].dataType}:"text"==s.dataType.dataType?{increment:0,value:s.value,dataType:s.dataType,dataTypeO:ip_GridProps[e].rowData[n].cells[a].dataType}:{increment:0,value:s.value,dataType:s.dataType,dataTypeO:ip_GridProps[e].rowData[n].cells[a].dataType},l[a].index--}for(var d={startRow:r.range.endRow+1,startCol:r.dragToRange.startCol,endRow:r.dragToRange.endRow,endCol:r.dragToRange.endCol},c=ip_AddUndo(e,"ip_DragRange",o,"CellData",d),a=r.dragToRange.startCol;a<=r.dragToRange.endCol;a++)for(var _=0,u=1;u<=l[a].repeatPattern;u++)for(var g=0;g<l[a].values.length;g++){var n=l[a].startPatternRow+l[a].rangeIncrement*u+g;if(n<=l[a].endPatternRow){ip_AddUndoTransactionData(e,c,ip_CloneCell(e,n,a));var s=l[a].values[g].dataType.dataType,w=l[a].dataTypeIncrement[s],f=l[a].values[g].increment,h=l[a].values[g].value;"number"==s&&(h+=w*f*u),ip_GridProps[e].rowData[n].cells[a].dataType=l[a].values[g].dataType,ip_SetValue(e,n,a,null==h?null:h),null==t.rowData[_]&&(t.rowData[_]={cells:[],row:n}),t.rowData[_].cells[t.rowData[_].cells.length]=ip_CloneCell(e,n,a)}_++}t.dragFromRange=r.range,t.dragToRange=r.dragToRange,t.dragToRange.startRow=r.range.endRow+1,t.rowData.length>0&&ip_RaiseEvent(e,"ip_DragRange",o,{DragRange:{Inputs:r,Effected:t}}),ip_ReRenderRows(e)}else""==i&&(i="Please specify a range");""!=i&&ip_RaiseEvent(e,"warning",o,i)}function ip_ValidateRangeObjects(e,r,o,i){var t=[];if(r.length>0)for(var l=0;l<r.length;l++)t[t.length]=ip_ValidateRangeObject(e,r[l],o,i);return t}function ip_ValidateRangeObject(e,r,o,i){if(null!=r){var t=o?-1:0,l=i?-1:0;r.length>0&&(r={startRow:r[0][0],startCol:r[0][1],endRow:r[1][0],endCol:r[1][1]}),(null==r.startRow||r.startRow<t)&&(r.startRow=t),(null==r.startCol||r.startCol<l)&&(r.startCol=l),null!=r.endRow&&r.endRow<ip_GridProps[e].rows||(r.endRow=ip_GridProps[e].rows-1),null!=r.endCol&&r.endCol<ip_GridProps[e].cols||(r.endCol=ip_GridProps[e].cols-1)}return r}function ip_IsRangeOverLap(e,r,o){if(null!=r&&null!=o){var i=o.startRow,t=o.startCol;if(r.startRow==o.startRow&&r.endRow==o.endRow&&r.startCol==o.startCol&&r.endCol==o.endCol)return"exact";if(!(r.startRow<o.startRow||r.startRow>o.endRow||r.endRow<o.startRow||r.endRow>o.endRow||r.startCol<o.startCol||r.startCol>o.endCol||r.endCol<o.startCol||r.endCol>o.endCol))return"inside";if(!(o.startRow<r.startRow||o.startRow>r.endRow||o.endRow<r.startRow||o.endRow>r.endRow||o.startCol<r.startCol||o.startCol>r.endCol||o.endCol<r.startCol||o.endCol>r.endCol))return"outside";if(i=o.startRow,t=o.startCol,!(i<r.startRow||i>r.endRow||t<r.startCol||t>r.endCol))return"overlap";if(i=o.startRow,t=o.endCol,!(i<r.startRow||i>r.endRow||t<r.startCol||t>r.endCol))return"overlap";if(i=o.endRow,t=o.startCol,!(i<r.startRow||i>r.endRow||t<r.startCol||t>r.endCol))return"overlap";if(i=o.endRow,t=o.endCol,!(i<r.startRow||i>r.endRow||t<r.startCol||t>r.endCol))return"overlap";if(!(i<r.startRow||i>r.endRow||o.startCol>r.startCol||o.endCol<r.endCol))return"overlap";if(i=r.startRow,t=r.startCol,!(i<o.startRow||i>o.endRow||t<o.startCol||t>o.endCol))return"innerlap";if(i=r.startRow,t=r.endCol,!(i<o.startRow||i>o.endRow||t<o.startCol||t>o.endCol))return"innerlap";if(i=r.endRow,t=r.startCol,!(i<o.startRow||i>o.endRow||t<o.startCol||t>o.endCol))return"innerlap";if(i=r.endRow,t=r.endCol,!(i<o.startRow||i>o.endRow||t<o.startCol||t>o.endCol))return"innerlap"}return!1}function ip_TrimRange(e,r,o){var i=ip_rangeObject();return o.startRow>r.endRow?null:o.startCol>r.endCol?null:o.endRow<r.startRow?null:o.endCol<r.startCol?null:(i.startRow=o.startRow<r.startRow?r.startRow:o.startRow,i.startCol=o.startCol<r.startCol?r.startCol:o.startCol,i.endRow=o.endRow>r.endRow?r.endRow:o.endRow,i.endCol=o.endCol>r.endCol?r.endCol:o.endCol,i)}function ip_GetRangeHighlightIndex(e,r){for(var o=parseInt($(r).attr("startRow")),i=parseInt($(r).attr("startCol")),t=parseInt($(r).attr("endRow")),l=parseInt($(r).attr("endCol")),n=0;n<ip_GridProps[e].highlightRange.length;n++)if(ip_GridProps[e].highlightRange[n][0][0]==o&&ip_GridProps[e].highlightRange[n][0][1]==i&&ip_GridProps[e].highlightRange[n][1][0]==t&&ip_GridProps[e].highlightRange[n][1][1]==l)return n;return-1}function ip_setRangeHighlightID(e,r,o,i){var t=o[0],l=o[1],n=i[0],a=i[1],s=e+"_RangeHighlight_"+t+"_"+l+"_"+n+"_"+a;return $(r).attr("id",s),$(r).attr("startRow",t),$(r).attr("startCol",l),$(r).attr("endRow",n),$(r).attr("endCol",a),s}function ip_InitScrollX(e,r,o,i,t,l){var n=0,a=0,s=i?parseInt($("#"+e+"_q4_scrollbar_container_y").width()):0,p=o?$("#"+e+"_q4_scrollbar_container_x").height():0,d=(parseInt($("#"+e+"_table").height()),ip_TableWidth(e+"_q4_table")),c=parseInt($("#"+e+"_q4_table").outerHeight()),_=ip_TableWidth(e+"_q1_table"),u=parseInt($("#"+e+"_q1_table").outerHeight()),g=parseInt(ip_GridProps[e].dimensions.gridWidth),w=parseInt(ip_GridProps[e].dimensions.gridHeight),f=g-_-s,h=w-u-p;
    if("container"!=l&&f>d&&(f=d),$("#"+e+"_q2_container").css("width",f+"px"),$("#"+e+"_q4_container").css("width",f+"px"),$("#"+e+"_q2").css("width",f+s+"px"),$("#"+e+"_q4").css("width",f+s+"px"),h>c&&"container"!=t||($("#"+e+"_q3_container").css("height",h+"px"),$("#"+e+"_q4_container").css("height",h+"px")),o){$("#"+e+"_q4_scrollbar_container_x").css("display",""),$("#"+e+"_q4_scrollbar_container_x").css("width",f+"px");for(var m=0,v=0;10>v;)m=(d-f)/r,v=parseInt(f-m),10>v&&r++;v>d&&(v=f),$("#"+e+"_q4_scrollbar_gadget_x").css("width",v+"px"),$("#"+e+"_q4_scrollbar_gadget_x").draggable({axis:"x",containment:"parent",drag:function(o,i){(i.position.left>n||i.position.left<n)&&(a=i.position.left*r),ip_GridProps[e].scrollbarX=a,$("#"+e+"_q4_container").scrollLeft(a),$("#"+e+"_q2_container").scrollLeft(a),n=i.position.left,$("#ScrollCount").html(n)}},50)}else $("#"+e+"_q4_scrollbar_container_x").css("display","none")}function ip_InitScrollX_Large(e,r,o,i,t,l){var n=50,a=i?parseInt($("#"+e+"_q4_scrollbar_container_y").width()):0,s=o?$("#"+e+"_q4_scrollbar_container_x").height():0,p=(parseInt($("#"+e+"_table").height()),ip_TableWidth(e+"_q4_table")),d=parseInt($("#"+e+"_q4_table").outerHeight()),c=ip_TableWidth(e+"_q1_table"),_=parseInt($("#"+e+"_q1_table").outerHeight()),u=parseInt(ip_GridProps[e].dimensions.gridWidth),g=parseInt(ip_GridProps[e].dimensions.gridHeight),w=u-c-a,f=g-_-s;if(0>w&&(w=u,ip_RaiseEvent(e,"warning",arguments.callee.caller,"The grid may not be able to show properly because your frozen column[s] are wider than the browser allows for!")),ip_GridProps[e].loadedCols<ip_GridProps[e].frozenCols&&(w=a,ip_RaiseEvent(e,"warning",arguments.callee.caller,"The grid may not be able to show properly because your frozen columns[s] dont have enough space to fit!")),ip_GridProps[e].dimensions.scrollWidth=w,"container"!=l&&w>p&&(w=p),$("#"+e+"_q2_container").css("width",w+"px"),$("#"+e+"_q4_container").css("width",w+"px"),$("#"+e+"_q2").css("width",w+a+"px"),$("#"+e+"_q4").css("width",w+a+"px"),f>d&&"container"!=t||($("#"+e+"_q3_container").css("height",f+"px"),$("#"+e+"_q4_container").css("height",f+"px")),o){n>w&&(n=w-1),$("#"+e+"_q4_scrollbar_container_x").css("display",""),$("#"+e+"_q4_scrollbar_container_x").css("width",w+"px");for(var h=0,m=0;n>m;)h=(ip_GridProps[e].cols-(ip_GridProps[e].loadedCols-(ip_GridProps[e].loadedCols-ip_GridProps[e].frozenCols-1)))/r,m=parseInt(w-h),n>m&&(r+=.01);ip_GridProps[e].scrollXInterval=r,ip_GridProps[e].cols<ip_GridProps[e].loadedCols&&(m=w),$("#"+e+"_q4_scrollbar_gadget_x").css("width",m+"px");var v=!1,C=!0,R=0,G=ip_GridProps[e].frozenCols,P=parseInt(ip_GridProps[e].cols/20),y=0,D=0;-1==ip_GridProps[e].scrollX&&(ip_GridProps[e].scrollX=ip_GridProps[e].frozenCols),ip_GridProps[e].events.ip_InitScrollX_Large_MouseDown=ip_UnBindEvent("#"+e+"_q4_scrollbar_gadget_x","mousedown",ip_GridProps[e].events.ip_InitScrollX_Large_MouseDown),$("#"+e+"_q4_scrollbar_gadget_x").mousedown(ip_GridProps[e].events.ip_InitScrollX_Large_MouseDown=function(e){e.stopPropagation()}),$("#"+e+"_q4_scrollbar_gadget_x").draggable({axis:"x",containment:"parent",start:function(){if($("#"+e+"_q4_scrollbar_gadget_x").addClass("ip_grid_scrollBar_gadget_scrolling"),C=!0,ip_GridProps[e].loadedCols>=loadedColsThreshold.min){var r=null;ip_GridProps[e].events.ip_InitScrollX_Large_MouseMove=ip_UnBindEvent(document,"mousemove",ip_GridProps[e].events.ip_InitScrollX_Large_MouseMove),$(document).on("mousemove",ip_GridProps[e].events.ip_InitScrollX_Large_MouseMove=function(){null!==r&&clearTimeout(r),y>5&&(r=setTimeout(function(){clearTimeout(r),ip_GridProps[e].scrolling||(C=!0,ip_ScrollToX(e,G,!1,"all","none"))},P))})}},drag:function(o,i){(i.position.left>R||i.position.left<R)&&(G=parseInt(i.position.left*r+ip_GridProps[e].frozenCols)),G<ip_GridProps[e].cols?G<ip_GridProps[e].frozenCols&&(G=ip_GridProps[e].frozenCols):G=ip_GridProps[e].cols-1,D=1,y=G-ip_GridProps[e].scrollX,0>y&&(y=ip_GridProps[e].scrollX-G,D=-1),C||ip_GridProps[e].loadedCols>loadedColsThreshold.max?v=!0:y>5&&ip_GridProps[e].loadedCols>loadedColsThreshold.min?(setTimeout(function(){ip_GridProps[e].scrolling||ip_ScrollToX(e,ip_GridProps[e].scrollX+5*D,!1,"none","none")},5),v=!0):setTimeout(function(){ip_GridProps[e].scrolling||ip_ScrollToX(e,G,!1,"all","none")},10),R=i.position.left,C=!1},stop:function(o,i){(i.position.left>R||i.position.left<R)&&(G=parseInt(i.position.left*r+ip_GridProps[e].frozenCols)),G<ip_GridProps[e].cols||(G=ip_GridProps[e].cols-1),ip_GridProps[e].scrollX!=G&&ip_ScrollToX(e,G,!0,"all","none"),ip_GridProps[e].events.ip_InitScrollX_Large_MouseMove=ip_UnBindEvent(document,"mousemove",ip_GridProps[e].events.ip_InitScrollX_Large_MouseMove),R=i.position.left,$("#"+e+"_q4_scrollbar_gadget_x").removeClass("ip_grid_scrollBar_gadget_scrolling")}})}else $("#"+e+"_q4_scrollbar_container_x").css("display","none");return!0}function ip_InitScrollY_Large(e,r,o){var i=$("#"+e).position().left,t=$("#"+e+"_table").position().top,l=!1,n=35,a=parseInt($("#"+e+"_q4_scrollbar_container_x").height()),s=parseInt($("#"+e+"_q4_scrollbar_container_y").width()),p=(parseInt($("#"+e+"_table").height()),parseInt($("#"+e+"_q4_table").outerHeight()),parseInt($("#"+e+"_q4_container").outerHeight())),d=(parseInt($("#"+e+"_q1_table").outerWidth()),parseInt($("#"+e+"_q1_table").outerHeight())),c=parseInt(ip_GridProps[e].dimensions.gridWidth),_=parseInt(ip_GridProps[e].dimensions.gridHeight),u=_-d-a;if(ip_GridProps[e].dimensions.scrollHeight=u,0>u&&(u=_,ip_RaiseEvent(e,"warning",arguments.callee.caller,"The grid may not be able to show properly because your frozen rows[s] are taller than the browser allows for!")),ip_GridProps[e].loadedRows<ip_GridProps[e].frozenRows&&(u=a,ip_RaiseEvent(e,"warning",arguments.callee.caller,"The grid may not be able to show properly because your frozen columns[s] dont have enough space to fit!")),o){n>u&&(n=u-1),ip_GridProps[e].loadedRows>ip_GridProps[e].rows||(w=u),$("#"+e+"_q4_scrollbar_container_y").css("display",""),$("#"+e+"_q4_scrollbar_container_y").css("height",u+"px");for(var g=n-1,w=0;n>w;)g=(ip_GridProps[e].rows-(ip_GridProps[e].loadedRows-(ip_GridProps[e].loadedRows-ip_GridProps[e].frozenRows-1)))/r,w=parseInt(u-t-g),n>w&&(r+=.01);ip_GridProps[e].scrollYInterval=r,ip_GridProps[e].rows<ip_GridProps[e].loadedRows&&(w=p),-1==ip_GridProps[e].scrollY&&(ip_GridProps[e].scrollY=ip_GridProps[e].frozenRows),ip_GridProps[e].showGridResizerX?($("#"+e+"_gridResizer").css("width",s+"px"),$("#"+e+"_gridResizer").css("left",c+i-s+"px"),$("#"+e+"_gridResizer").css("top",t+"px"),$("#"+e+"_gridResizer").css("height",ip_GridProps[e].dimensions.columnSelectorHeight+"px"),$("#"+e+"_gridResizerLine").css("height",_-ip_GridProps[e].dimensions.columnSelectorHeight+"px")):$("#"+e+"_gridResizer").hide(),$("#"+e+"_q4_scrollbar_container_y").css("height",p+"px"),$("#"+e+"_q4_scrollbar_gadget_y").css("height",w+"px"),$("#"+e+"_q4_scrollbar_gadget_scrollIndecator_y").css("top",w/2-$("#"+e+"_q4_scrollbar_gadget_scrollIndecator_y").height()/1.5+"px");var f=(ip_GridProps[e].scrollY-ip_GridProps[e].frozenRows)/ip_GridProps[e].scrollYInterval,h=!1,m=0,v=ip_GridProps[e].frozenRows,C=!1;ip_GridProps[e].events.ip_InitScrollY_Large_MouseDown=ip_UnBindEvent("#"+e+"_q4_scrollbar_gadget_y","mousedown",ip_GridProps[e].events.ip_InitScrollY_Large_MouseDown),$("#"+e+"_q4_scrollbar_gadget_y").mousedown(ip_GridProps[e].events.ip_InitScrollY_Large_MouseDown=function(e){e.stopPropagation(),e.preventDefault()}),$("#"+e+"_q4_scrollbar_gadget_y").css("top",f+"px"),$("#"+e+"_q4_scrollbar_gadget_y").draggable({axis:"y",containment:"parent",start:function(){l&&$("#"+e+"_q4_scrollbar_gadget_scrollIndecator_y").show(),$("#"+e+"_q4_scrollbar_gadget_y").addClass("ip_grid_scrollBar_gadget_scrolling")},drag:function(o,i){if((i.position.top>m||i.position.top<m)&&(v=parseInt(i.position.top*r+ip_GridProps[e].frozenRows)),0>v?v=0:v<ip_GridProps[e].rows||(v=ip_GridProps[e].rows-1),ip_GridProps[e].scrolling||h)return!0;h=!0,clearTimeout(ip_GridProps[e].events.ip_InitScrollY_Large_scrollTimeout);var t=1,n=v-ip_GridProps[e].scrollY;0>n&&(n=ip_GridProps[e].scrollY-v,t=-1),ip_GridProps[e].events.ip_InitScrollY_Large_scrollTimeout=setTimeout(function(){ip_ScrollToY(e,v,!1,"all","none"),h=!1},15>n?15:50),l?$("#"+e+"_q4_scrollbar_gadget_scrollIndecator_y").text(v+(ip_GridProps[e].rowData[v].hide?" (hidden)":"")+" ..."):ip_GridProps[e].rowData[v].hide?(C||($("#"+e+"_q4_scrollbar_gadget_scrollIndecator_y").show(),C=!0),$("#"+e+"_q4_scrollbar_gadget_scrollIndecator_y").text(v+"*")):C&&($("#"+e+"_q4_scrollbar_gadget_scrollIndecator_y").hide(),C=!1),m=i.position.top},stop:function(o,i){(i.position.top>m||i.position.top<m)&&(v=i.position.top*r+ip_GridProps[e].frozenRows),v<ip_GridProps[e].rows||(v=ip_GridProps[e].rows-1),ip_GridProps[e].scrollY!=v&&ip_ScrollToY(e,v,!0,"all","none"),ip_GridProps[e].events.ip_InitScrollY_Large_MouseMove=ip_UnBindEvent(document,"mousemove",ip_GridProps[e].events.ip_InitScrollY_Large_MouseMove),$("#"+e+"_q4_scrollbar_gadget_scrollIndecator_y").fadeOut("fast"),$("#"+e+"_q4_scrollbar_gadget_y").removeClass("ip_grid_scrollBar_gadget_scrolling"),m=i.position.top}})}else $("#"+e+"_q4_scrollbar_container_y").css("display","none");return!0}function ip_InitScrollY(e,r,o){var i=0,t=0,l=parseInt($("#"+e+"_q4_scrollbar_container_x").height()),n=(parseInt($("#"+e+"_table").height()),parseInt($("#"+e+"_q4_table").outerHeight())),a=parseInt($("#"+e+"_q4_container").outerHeight()),s=(parseInt($("#"+e+"_q1_table").outerWidth()),parseInt($("#"+e+"_q1_table").outerHeight())),p=(parseInt(ip_GridProps[e].dimensions.gridWidth),parseInt(ip_GridProps[e].dimensions.gridHeight)),d=p-s-l;if(o){d>n&&(d=d),$("#"+e+"_q4_scrollbar_container_y").css("display",""),$("#"+e+"_q4_scrollbar_container_y").css("height",d+"px");for(var c=0,_=0;10>_;)c=(n-d)/r,_=parseInt(d-c),10>_&&r++;a>n&&(_=a),$("#"+e+"_q4_scrollbar_container_y").css("height",a+"px"),$("#"+e+"_q4_scrollbar_gadget_y").css("height",_+"px"),$("#"+e+"_q4_scrollbar_gadget_y").draggable({axis:"y",containment:"parent",drag:function(o,l){(l.position.top>i||l.position.top<i)&&(t=l.position.top*r),ip_GridProps[e].scrollY=t,$("#"+e+"_q3_container").scrollTop(t),$("#"+e+"_q4_container").scrollTop(t),i=l.position.top,$("#ScrollCount").html(i)}},50)}else $("#"+e+"_q4_scrollbar_container_y").css("display","none")}function ip_ScrollToY(e,r,o,i){if(ip_GridProps[e].scrolling)return!1;if(r=parseInt(r),ip_GridProps[e].scrollY!=r&&!ip_GridProps[e].scrolling){ip_GridProps[e].scrolling=!0,clearTimeout(ip_GridProps[e].timeouts.scrollYCompleteTimeout);var t=ip_GridProps[e].scrollY<r?"down":"up";o&&(r=ip_NextNonHiddenRow(e,r,null,ip_GridProps[e].scrollY,t)),r<ip_GridProps[e].rows?r<ip_GridProps[e].frozenRows&&(r=ip_GridProps[e].frozenRows):r=ip_GridProps[e].rows-1;var l=!1,n=ip_GridProps[e].loadedRows-ip_GridProps[e].frozenRows,a=ip_GridProps[e].scrollY,s=Math.abs(r-a),p=r,d=r+ip_GridProps[e].loadedRows,c=s;if("down"==t)if(ip_GridProps[e].scrollY=r,s>=ip_GridProps[e].loadedRows||l)ip_AddRow(e,{row:r,appendTo:"end",fullRerender:!0}),c=1;else{for(var _=a+n,u=a;r>u;u++)ip_RemoveRow(e,{row:u}),ip_GridProps[e].loadedRows--,ip_GridProps[e].dimensions.accumulativeScrollHeight<ip_GridProps[e].dimensions.scrollHeight&&_<ip_GridProps[e].rows&&(ip_GridProps[e].loadedRows++,ip_AddRow(e,{row:_,appendTo:"end"}),_++);for(;ip_GridProps[e].dimensions.accumulativeScrollHeight<ip_GridProps[e].dimensions.scrollHeight&&_<ip_GridProps[e].rows;)ip_GridProps[e].loadedRows++,ip_AddRow(e,{row:_,appendTo:"end"}),_++;p=r+s*(0>s?-1:1)}else if(ip_GridProps[e].scrollY=r,s>=ip_GridProps[e].loadedRows||l)ip_GridProps[e].loadedRows++,ip_AddRow(e,{row:r,appendTo:"end",fullRerender:!0}),c=1;else{for(var g=a+n-1,u=a-1;u>=r;u--)ip_GridProps[e].loadedRows++,ip_AddRow(e,{row:u,appendTo:"start"}),ip_GridProps[e].dimensions.accumulativeScrollHeight-ip_GridProps[e].rowData[g].height>=ip_GridProps[e].dimensions.scrollHeight&&g>ip_GridProps[e].frozenRows&&(ip_RemoveRow(e,{row:g}),ip_GridProps[e].loadedRows--,g--);for(;ip_GridProps[e].dimensions.accumulativeScrollHeight-ip_GridProps[e].rowData[g].height>ip_GridProps[e].dimensions.scrollHeight&&g>ip_GridProps[e].frozenRows;)ip_GridProps[e].loadedRows--,ip_RemoveRow(e,{row:g}),g--;p=r+s*(0>s?-1:1)}if(p>d&&(p=d),ip_SetRowColSpan(e,r,p,null,null,c),null!=i&&"none"!=i&&ip_RePoistionRanges(e,i,!1,!0),1==o){var w=(r-ip_GridProps[e].frozenRows)/ip_GridProps[e].scrollYInterval;$("#"+e+"_q4_scrollbar_gadget_y").css("top",w+"px")}return ip_GridProps[e].timeouts.scrollYCompleteTimeout=setTimeout(function(){ip_RaiseEvent(e,"ip_ScrollComplete","",{ScrollComplete:{Inputs:null,Effected:{scrollY:r,direction:t}}})},250),ip_GridProps[e].scrolling=!1,!0}return!1}function ip_ScrollToX(e,r,o,i){if(ip_GridProps[e].scrollX!=r&&!ip_GridProps[e].scrolling){ip_GridProps[e].scrolling=!0;var t=ip_GridProps[e].loadedCols-ip_GridProps[e].frozenCols,l=ip_GridProps[e].scrollX,n=r-l,a=r,s=r+ip_GridProps[e].loadedCols,p=n,d=$("#"+e);if(r=parseInt(r),r<ip_GridProps[e].cols?r<ip_GridProps[e].frozenCols&&(r=ip_GridProps[e].frozenCols):r=ip_GridProps[e].cols-1,ip_GridProps[e].scrollX<r)if(ip_GridProps[e].scrollX=r,r>l+ip_GridProps[e].loadedCols)ip_AddCol(e,{col:r,appendTo:"end",fullRerender:!0}),p=1;else{for(var c=l+t,_=l;r>_;_++)$(d).ip_RemoveCol({col:_}),ip_GridProps[e].loadedCols--,ip_GridProps[e].dimensions.accumulativeScrollWidth<ip_GridProps[e].dimensions.scrollWidth&&c<ip_GridProps[e].cols&&(ip_GridProps[e].loadedCols++,ip_AddCol(e,{col:c,appendTo:"end"}),c++);for(;ip_GridProps[e].dimensions.accumulativeScrollWidth<ip_GridProps[e].dimensions.scrollWidth&&c<ip_GridProps[e].cols;)ip_GridProps[e].loadedCols++,ip_AddCol(e,{col:c,appendTo:"end"}),c++;a=r+n*(0>n?-1:1)}else if(ip_GridProps[e].scrollX>r)if(ip_GridProps[e].scrollX=r,l-t>r)ip_AddCol(e,{col:r,appendTo:"end",fullRerender:!0}),p=1;else{for(var u=l+t-1,_=l-1;_>=r;_--){ip_GridProps[e].loadedCols++,ip_AddCol(e,{col:_,appendTo:"start"});{ip_GridProps[e].dimensions.accumulativeScrollWidth}ip_GridProps[e].dimensions.accumulativeScrollWidth-ip_ColWidth(e,u,!0)>=ip_GridProps[e].dimensions.scrollWidth&&u>ip_GridProps[e].frozenCols&&(ip_RemoveCol(e,{col:u}),ip_GridProps[e].loadedCols--,u--)}for(;ip_GridProps[e].dimensions.accumulativeScrollWidth-ip_ColWidth(e,u,!0)>ip_GridProps[e].dimensions.scrollWidth&&u>ip_GridProps[e].frozenCols;)ip_RemoveCol(e,{col:u}),ip_GridProps[e].loadedCols--,u--;a=r+n*(0>n?-1:1)}if(a>s&&(a=s),ip_SetRowColSpan(e,null,null,r,a,p),null!=i&&"none"!=i&&(clearTimeout(ip_GridProps[e].events.scrollToXY_RangeTimeout),ip_GridProps[e].events.scrollToXY_RangeTimeout=setTimeout(function(){ip_RePoistionRanges(e,i,!0,!1)},15)),1==o||null==o){var g=(r-ip_GridProps[e].frozenCols)/ip_GridProps[e].scrollXInterval;$("#"+e+"_q4_scrollbar_gadget_x").css("left",g+"px")}ip_GridProps[e].scrollX=r,ip_GridProps[e].scrolling=!1}}function ip_EnableScrollAnimate(e){if(!ip_GridProps[e].scrollAnimate){ip_GridProps[e].scrollAnimate=!0;var r=$("#"+e+"_table").offset().top,o=$("#"+e+"_table").offset().left,i=ip_GridProps[e].dimensions.gridHeight,t=ip_GridProps[e].dimensions.gridWidth;ip_GridProps[e].events.scrollAnimate_MouseMove=ip_UnBindEvent("#"+e,"mousemove",ip_GridProps[e].events.scrollAnimate_MouseMove),$("#"+e).mousemove(ip_GridProps[e].events.scrollAnimate_MouseMove=function(l){ip_ScrollAnimate(e,r,i,o,t,l,10)}),ip_GridProps[e].events.scrollAnimate_MouseUp=ip_UnBindEvent(document,"mouseup",ip_GridProps[e].events.scrollAnimate_MouseUp),$(document).mouseup(ip_GridProps[e].events.scrollAnimate_MouseUp=function(){ip_DisableScrollAnimate(e),ip_GridProps[e].events.scrollAnimate_MouseMove=ip_UnBindEvent("#"+e,"mousemove",ip_GridProps[e].events.scrollAnimate_MouseMove),ip_GridProps[e].events.scrollAnimate_MouseUp=ip_UnBindEvent(document,"mouseup",ip_GridProps[e].events.scrollAnimate_MouseUp)})}}function ip_ScrollAnimate(e,r,o,i,t,l,n){ip_GridProps[e].scrollAnimate=!0;var a=ip_GridProps[e].dimensions.defaultRowHeight,s=r+o-a,p=r+a,d=i+t-a,c=i+a;if(n=null==n?0:n,l.pageY<=p&&ip_GridProps[e].scrollY>ip_GridProps[e].frozenRows){if(null!=ip_GridProps[e].timeouts.scrollAnimateInterval)return;return void(ip_GridProps[e].timeouts.scrollAnimateInterval=setInterval(function(){ip_ScrollToY(e,ip_GridProps[e].scrollY-1,!0,"all","none")},n))}if(l.pageY>=s&&ip_GridProps[e].scrollY<ip_GridProps[e].rows-1){if(null!=ip_GridProps[e].timeouts.scrollAnimateInterval)return;return void(ip_GridProps[e].timeouts.scrollAnimateInterval=setInterval(function(){ip_ScrollToY(e,ip_GridProps[e].scrollY+1,!0,"all","none")},n))}if(l.pageX<=c&&ip_GridProps[e].scrollX>ip_GridProps[e].frozenCols){if(null!=ip_GridProps[e].timeouts.scrollAnimateInterval)return;return void(ip_GridProps[e].timeouts.scrollAnimateInterval=setInterval(function(){ip_ScrollToX(e,ip_GridProps[e].scrollX-1,!0,"all","none")},n))}if(l.pageX>=d&&ip_GridProps[e].scrollX<ip_GridProps[e].cols-1){if(null!=ip_GridProps[e].timeouts.scrollAnimateInterval)return;return void(ip_GridProps[e].timeouts.scrollAnimateInterval=setInterval(function(){ip_ScrollToX(e,ip_GridProps[e].scrollX+1,!0,"all","none")},n))}ip_DisableScrollAnimate(e)}function ip_DisableScrollAnimate(e){clearInterval(ip_GridProps[e].timeouts.scrollAnimateInterval),ip_GridProps[e].timeouts.scrollAnimateInterval=null,ip_GridProps[e].scrollAnimate=!1}function ip_ScrollCell(e,r,o,i,t,l,n,a){if(t=null==t?o:t,l=null==l?i:l,n=0>n?-1*n:n,o!=t||"up"!=r&&"down"!=r){if(l==t&&("left"==i||"right"==r)){var s=ip_GetQuad(e,null,i);if(1==s||3==s)return}}else{var s=ip_GetQuad(e,o,null);if(1==s||2==s)return}if("up"==r){var p=ip_CellRelativePosition(e,o+1,i,!0),d=ip_CellRelativePosition(e,t+1,l,!0);if(p.localTop<=1||d.localTop<=1)return ip_ScrollToY(e,ip_GridProps[e].scrollY-n,!0,a,"none"),"up"}else if("down"==r&&t<ip_GridProps[e].rows-1){var c=ip_GridProps[e].dimensions.scrollHeight,p=ip_CellRelativePosition(e,o,i,!0),d=ip_CellRelativePosition(e,t+1,l,!0);if(p.localBottom>=c||d.localBottom>=c)return ip_ScrollToY(e,ip_GridProps[e].scrollY+n,!0,a,"none"),"down"}else if("left"==r){var p=ip_CellRelativePosition(e,o,i+1,!0),d=ip_CellRelativePosition(e,t,l+1,!0);if(p.localLeft<=1||d.localLeft<=1)return ip_ScrollToX(e,ip_GridProps[e].scrollX-n,!0,a,"all"),"left"}else if("right"==r&&t<ip_GridProps[e].rows-1){var _=ip_GridProps[e].dimensions.scrollWidth,p=ip_CellRelativePosition(e,o,i,!0),d=ip_CellRelativePosition(e,t,l,!0);if(p.localRight>=_||d.localRight>=_)return ip_ScrollToX(e,ip_GridProps[e].scrollX+n,!0,a,"none"),"right"}}function ip_AddRow(e,r){var r=$.extend({row:ip_GridProps[e].rows,count:1,visualize:!0,appendTo:"end",fullRerender:!1},r);r.row<ip_GridProps[e].rows||(r.row=ip_GridProps[e].rows),r.fullRerender&&(r.count=1);var o=!1,i=0,t=[],l=[],n=null,a=null,s=ip_LoadedRowsCols(e),p=ip_GetQuad(e,r.row,-1),d=1==p?2:4,c=r.row+r.count,_=null;if(r.fullRerender){if(1==p)return ip_RaiseEvent(e,"warning",arguments.callee.caller,"Full re-render only works in scrollable zone"),!1;if(ip_GridProps[e].dimensions.accumulativeScrollHeight=0,"ie"==thisBrowser.name&&thisBrowser.version<10?($("#"+e+"_q3_table tbody tr").remove(),$("#"+e+"_q4_table tbody tr").remove()):(document.getElementById(e+"_q3_table_tbody").innerHTML="",document.getElementById(e+"_q4_table_tbody").innerHTML=""),ip_GridProps[e].rows==ip_GridProps[e].frozenRows)return!1}for(var u=r.row;c>u;u++){if(u>=ip_GridProps[e].rows){null==_&&(_=ip_GenerateTransactionID());{var g={startRow:r.row,startCol:0,endRow:r.row,endCol:ip_GridProps[e].cols-1};ip_AddUndo(e,"ip_AddRow",_,"function",g,g,{row:g.startRow,col:g.startCol},null,function(){ip_RemoveRow(e,{row:r.row,count:1,mode:"destroy",render:!1,raiseEvent:!1,createUndo:!1})})}ip_GridProps[e].rows++,ip_ValidateData(e,ip_GridProps[e].rows,-1),ip_GridProps[e].dimensions.accumulativeScrollHeight>ip_GridProps[e].dimensions.scrollHeight||ip_GridProps[e].loadedRows++,s=ip_LoadedRowsCols(e),o=!0}u>s.rowTo_scroll&&!r.fullRerender&&(r.visualize=!1),r.visualize&&(n={showColSelector:!1,showRowSelector:ip_GridProps[e].showRowSelector,id:e+"_q"+p,cols:ip_GridProps[e].frozenCols,Quad:p,GridID:e,row:u,startCol:0,loadedScrollable:s},a={showColSelector:!1,showRowSelector:!1,id:e+"_q"+d,cols:ip_GridProps[e].cols-ip_GridProps[e].frozenCols,Quad:d,GridID:e,row:u,startCol:ip_GridProps[e].scrollX,loadedScrollable:s},ip_CreateGridQuadRow(n,t),ip_CreateGridQuadRow(a,l),3==p&&(ip_GridProps[e].dimensions.accumulativeScrollHeight+=ip_RowHeight(e,u,!0)),r.fullRerender&&ip_GridProps[e].dimensions.accumulativeScrollHeight<ip_GridProps[e].dimensions.scrollHeight&&u<ip_GridProps[e].rows-1&&c++,i++)}if(r.fullRerender&&(ip_GridProps[e].loadedRows=i+ip_GridProps[e].frozenRows),t.length>0)if(r.fullRerender)if("ie"==thisBrowser.name&&thisBrowser.version<10)$("#"+e+"_q"+p+"_table_tbody").append(t.join("")),$("#"+e+"_q"+d+"_table_tbody").append(l.join(""));else{var w=document.getElementById(e+"_q"+p+"_table_tbody"),f=document.getElementById(e+"_q"+d+"_table_tbody");null!=w&&(w.innerHTML=t.join("")),null!=f&&(f.innerHTML=l.join(""))}else"end"==r.appendTo?($("#"+e+"_q"+p+"_table_tbody").append(t.join("")),$("#"+e+"_q"+d+"_table_tbody").append(l.join(""))):($("#"+e+"_q"+p+"_table_tbody").prepend(t.join("")),$("#"+e+"_q"+d+"_table_tbody").prepend(l.join("")));if(o){$("#"+e).ip_Scrollable();var h={count:r.count};ip_RaiseEvent(e,"ip_AddRow",_,{AddRow:{Inputs:r,Effected:h}})}return!0}function ip_RemoveRow(e,r){var r=$.extend({row:ip_GridProps[e].rows-1,count:1,mode:"hide",render:!0,raiseEvent:!0,createUndo:!0},r);null==r.row&&ip_GridProps[e].selectedRow.length>0?r.row=ip_GridProps[e].selectedRow[0]:null==r.row&&(r.row=ip_GridProps[e].rows),null==r.count&&ip_GridProps[e].selectedRow.length>0?r.count=ip_GridProps[e].selectedRow.length:null==r.count&&(r.count=1);var o=ip_GetQuad(e,r.row,-1),i=1==o?2:4;if(r.row+r.count>ip_GridProps[e].rows&&(r.count=ip_GridProps[e].rows-r.row),"hide"==r.mode)for(var t=0;t<r.count;t++){var l=document.getElementById(e+"_q"+o+"_gridRow_"+r.row),n=document.getElementById(e+"_q"+i+"_gridRow_"+r.row);null!=l&&null!=n&&("ie"==thisBrowser.name&&thisBrowser.version<10?(l.parentNode.removeChild(l),n.parentNode.removeChild(n)):(l.outerHTML="",n.outerHTML=""),ip_GridProps[e].dimensions.accumulativeScrollHeight-=ip_RowHeight(e,r.row,!0))}else if(r.row<ip_GridProps[e].rows){for(var a=ip_GenerateTransactionID(),s={row:r.row,count:r.count,rowData:null},p=ip_ChangeFormulaOrigin(e,{rowDiff:-r.count,range:{startRow:r.row+r.count}}),t=0;t<r.count;t++){if(r.createUndo){var d={startRow:r.row,startCol:-1,endRow:r.row,endCol:ip_GridProps[e].cols-1},c=ip_AddUndo(e,"ip_RemoveRow",a,"CellData",d,0==t?{startRow:d.startRow,startCol:d.startCol,endRow:d.endRow+r.count-1,endCol:d.endCol}:null,0==t?{row:d.startRow,col:d.startCol}:null,null,null),_=ip_AddUndo(e,"ip_RemoveRow",a,"MergeData",d);ip_AddUndo(e,"ip_RemoveRow",a,"RowData",d,null,null,null,ip_CloneRow(e,r.row)),ip_AddUndo(e,"ip_RemoveRow",a,"function",d,null,null,null,function(){ip_InsertRow(e,{row:r.row,count:1,render:!1,raiseEvent:!1,createUndo:!1})})}for(var u=ip_ValidateRangeMergedCells(e,r.row,0,r.row,ip_GridProps[e].cols-1),g=0;g<u.merges.length;g++)ip_AddUndoTransactionData(e,_,ip_mergeObject(u.merges[g].mergedWithRow,u.merges[g].mergedWithCol,u.merges[g].rowSpan,u.merges[g].colSpan)),ip_ResetCellMerge(e,u.merges[g].mergedWithRow,u.merges[g].mergedWithCol);for(var w=0;w<ip_GridProps[e].rowData[r.row].cells.length;w++)ip_AddUndoTransactionData(e,c,ip_CloneCell(e,r.row,w));ip_ReshuffelMergesRow(e,r.row+1,ip_GridProps[e].rows-1,-1,!1),ip_GridProps[e].rows--,ip_GridProps[e].rowData.splice(r.row,1);for(var g=0;g<u.merges.length;g++)ip_AddRowToMerge(e,u.merges[g],-1);ip_GridProps[e].rows>ip_GridProps[e].frozenRows||(ip_GridProps[e].frozenRows=ip_GridProps[e].rows),ip_GridProps[e].scrollY<ip_GridProps[e].rows||(ip_GridProps[e].scrollY=ip_GridProps[e].rows-1),ip_GridProps[e].scrollY<ip_GridProps[e].frozenRows&&(ip_GridProps[e].scrollY=ip_GridProps[e].frozenRows)}var f=0==r.row?null:ip_rangeObject(0,0,r.row-1,ip_GridProps[e].cols-1);for(var h in p){var m=ip_GridProps[e].indexedData.formulaData[h];ip_SetCellFormula(e,{row:m.row,col:m.col,formula:ip_MoveFormulaOrigon(e,ip_GridProps[e].rowData[m.row].cells[m.col].formula,m.row,m.col,m.row-r.count,m.col,f)}),ip_AppendEffectedRowData(e,s,{row:m.row,col:m.col,formula:ip_GridProps[e].rowData[m.row].cells[m.col].formula})}r.render&&(ip_ReRenderRows(e),$("#"+e).ip_Scrollable()),r.row+r.count<ip_GridProps[e].rows-1?$("#"+e).ip_SelectRow({row:r.row,count:r.count,unselect:!1}):$("#"+e).ip_UnselectRow(),r.raiseEvent&&ip_RaiseEvent(e,"ip_RemoveRow",a,{RemoveRow:{Inputs:r,Effected:s}})}}function ip_AddCol(e,r){var r=$.extend({col:ip_GridProps[e].cols,count:1,visualize:!0,appendTo:"end",fullRerender:!1},r);r.col<ip_GridProps[e].cols||(r.col=ip_GridProps[e].cols),r.fullRerender&&(r.count=1);var o=!1,i=ip_GetQuad(e,-1,r.col),t=2==i?4:3,l=null,n=null,a=null,s=null,p=r.col+r.count,d=ip_LoadedRowsCols(e),c=0,_=null;if(r.fullRerender){if(1==i)return ip_RaiseEvent(e,"warning",arguments.callee.caller,"Full re-render only works in scrollable zone"),!1;if(ip_GridProps[e].dimensions.accumulativeScrollWidth=0,$("#"+e+"_q2_table .ip_grid_columnSelectorCell").remove(),$("#"+e+"_q2_table .ip_grid_cell").remove(),$("#"+e+"_q4_table .ip_grid_columnSelectorCell").remove(),$("#"+e+"_q4_table .ip_grid_cell").remove(),ip_GridProps[e].cols==ip_GridProps[e].frozenCols)return!1}for(var u=r.col;p>u;u++){if(u>=ip_GridProps[e].cols){null==_&&(_=ip_GenerateTransactionID());{var g={startRow:0,startCol:r.col,endRow:ip_GridProps[e].rows-1,endCol:r.col};ip_AddUndo(e,"ip_AddCol",_,"function",g,g,{row:g.startRow,col:g.startCol},null,function(){ip_RemoveCol(e,{col:r.col,count:1,mode:"destroy",render:!1,raiseEvent:!1,createUndo:!1})})}ip_GridProps[e].cols++,ip_ValidateData(e,-1,ip_GridProps[e].cols),ip_GridProps[e].dimensions.accumulativeScrollWidth>ip_GridProps[e].dimensions.scrollWidth||ip_GridProps[e].loadedCols++,d=ip_LoadedRowsCols(e),o=!0}if(u>d.colTo_scroll+1&&!r.fullRerender&&(r.visualize=!1),r.visualize){for(var w=-1;w<=d.rowTo_frozen;w++)if(a={showColSelector:ip_GridProps[e].showColSelector,showRowSelector:!1,id:e+"_q"+i,Quad:i,GridID:e,col:u,row:w,cellType:-1==w?"ColSelector":""},l=ip_CreateGridQuadCell(a),"end"==r.appendTo)$("#"+e+"_q"+i+"_gridRow_"+w).append(l);else{var f="";f=-1==w?e+"_q"+i+"_columnSelectorCell_-1":e+"_q"+i+"_rowSelecterCell_"+w,$(l).insertAfter($("#"+f))}for(var w=-1;w<=d.rowTo_scroll;w++){if(s={showColSelector:!1,showRowSelector:!1,id:e+"_q"+t,Quad:t,GridID:e,col:u,row:w,cellType:-1==w?"ColSelector":""},n=ip_CreateGridQuadCell(s),"end"==r.appendTo)$("#"+e+"_q"+t+"_gridRow_"+w).append(n);else{var f="";f=-1==w?e+"_q"+t+"_columnSelectorCell_-1":e+"_q"+t+"_rowSelecterCell_"+w,$(n).insertAfter($("#"+f))}-1==w&&(w=d.rowFrom_scroll-1)}2==i&&(ip_GridProps[e].dimensions.accumulativeScrollWidth+=ip_ColWidth(e,u,!0)),r.fullRerender&&ip_GridProps[e].dimensions.accumulativeScrollWidth<ip_GridProps[e].dimensions.scrollWidth&&u<ip_GridProps[e].cols-1&&p++,c++}}if(r.fullRerender&&(ip_GridProps[e].loadedCols=c+ip_GridProps[e].frozenCols),o){$("#"+e).ip_Scrollable({initY:!1});var h={count:r.count};ip_RaiseEvent(e,"ip_AddCol",_,{AddCol:{Inputs:r,Effected:h}})}return!0}function ip_RemoveCol(e,r){var r=$.extend({col:ip_GridProps[e].cols-1,mode:"hide",count:1,render:!0,raiseEvent:!0,createUndo:!0},r);null==r.col&&ip_GridProps[e].selectedColumn.length>0?r.col=ip_GridProps[e].selectedColumn[0]:null==r.col&&(r.col=ip_GridProps[e].cols),null==r.count&&ip_GridProps[e].selectedColumn.length>0?r.count=ip_GridProps[e].selectedColumn.length:null==r.count&&(r.count=1);var o=ip_GetQuad(e,-1,r.col),i=1==o?3:4,t=ip_LoadedRowsCols(e);if(r.col+r.count>ip_GridProps[e].cols&&(r.count=ip_GridProps[e].cols-r.col),"hide"==r.mode)for(var l=0;l<r.count;l++){for(var n=-1;n<t.rowLoaded_frozen;n++){var a="";a=-1==n?e+"_q"+o+"_columnSelectorCell_"+r.col:e+"_cell_"+n+"_"+r.col;var s=document.getElementById(a);null!=s&&("ie"==thisBrowser.name&&thisBrowser.version<10?s.parentNode.removeChild(s):s.outerHTML="")}for(var n=-1;n<t.rowFrom_scroll+t.rowLoaded_scroll;n++){var a="";a=-1==n?e+"_q"+i+"_columnSelectorCell_"+r.col:e+"_cell_"+n+"_"+r.col;var s=document.getElementById(a);null!=s&&("ie"==thisBrowser.name&&thisBrowser.version<10?s.parentNode.removeChild(s):s.outerHTML=""),-1==n&&(n=ip_GridProps[e].scrollY-1,null!=s&&(ip_GridProps[e].dimensions.accumulativeScrollWidth-=ip_ColWidth(e,r.col,!0)))}}else if(r.col<ip_GridProps[e].cols){for(var p=ip_GenerateTransactionID(),d={col:r.col,count:r.count,rowData:null},c=ip_ChangeFormulaOrigin(e,{colDiff:-r.count,range:{startCol:r.col+r.count}}),l=0;l<r.count;l++){if(r.createUndo){var _={startRow:-1,startCol:r.col,endRow:ip_GridProps[e].rows-1,endCol:r.col},u=ip_AddUndo(e,"ip_RemoveCol",p,"CellData",_,0==l?{startRow:_.startRow,startCol:_.startCol,endRow:_.endRow,endCol:_.endCol+r.count-1}:null,0==l?{row:_.startRow,col:_.startCol}:null),g=ip_AddUndo(e,"ip_RemoveCol",p,"MergeData",_);ip_AddUndo(e,"ip_RemoveCol",p,"ColData",_,null,null,null,ip_CloneCol(e,r.col)),ip_AddUndo(e,"ip_RemoveCol",p,"function",_,null,null,null,function(){ip_InsertCol(e,{col:r.col,count:1,render:!1,raiseEvent:!1,createUndo:!1})})}for(var w=ip_ValidateRangeMergedCells(e,0,r.col,ip_GridProps[e].rows-1,r.col),f=0;f<w.merges.length;f++)ip_AddUndoTransactionData(e,g,ip_mergeObject(w.merges[f].mergedWithRow,w.merges[f].mergedWithCol,w.merges[f].rowSpan,w.merges[f].colSpan)),ip_ResetCellMerge(e,w.merges[f].mergedWithRow,w.merges[f].mergedWithCol);ip_ReshuffelMergesCol(e,r.col+1,ip_GridProps[e].cols-1,-1,!1),ip_GridProps[e].cols--,ip_IsColLoaded(e,r.col,t,!0)&&(ip_GridProps[e].dimensions.accumulativeScrollWidth-=ip_ColWidth(e,r.col,!0));for(var n=0;n<ip_GridProps[e].rowData.length;n++)ip_AddUndoTransactionData(e,u,ip_CloneCell(e,n,r.col)),ip_GridProps[e].rowData[n].cells.splice(r.col,1);ip_GridProps[e].colData.splice(r.col,1);for(var f=0;f<w.merges.length;f++)ip_AddColumnToMerge(e,w.merges[f],-1);ip_GridProps[e].cols>ip_GridProps[e].frozenCols||(ip_GridProps[e].frozenCols=ip_GridProps[e].cols),ip_GridProps[e].scrollX<ip_GridProps[e].cols||(ip_GridProps[e].scrollX=ip_GridProps[e].cols-1),ip_GridProps[e].scrollX<ip_GridProps[e].frozenCols&&(ip_GridProps[e].scrollX=ip_GridProps[e].frozenCols)}var h=0==r.col?null:ip_rangeObject(0,0,ip_GridProps[e].rows-1,r.col-1);for(var m in c){var v=ip_GridProps[e].indexedData.formulaData[m];ip_SetCellFormula(e,{row:v.row,col:v.col,formula:ip_MoveFormulaOrigon(e,ip_GridProps[e].rowData[v.row].cells[v.col].formula,v.row,v.col,v.row,v.col-r.count,h)}),ip_AppendEffectedRowData(e,d,{row:v.row,col:v.col,formula:ip_GridProps[e].rowData[v.row].cells[v.col].formula})}r.render&&(ip_ReRenderCols(e),$("#"+e).ip_Scrollable({initY:!1})),r.col+r.count<ip_GridProps[e].cols-1?$("#"+e).ip_SelectColumn({col:r.col,count:r.count,unselect:!1}):$("#"+e).ip_UnselectColumn(),r.raiseEvent&&ip_RaiseEvent(e,"ip_RemoveCol",p,{RemoveCol:{Inputs:r,Effected:d}})}}function ip_InsertCol(e,r){var r=$.extend({col:ip_GridProps[e].cols,count:1,appendTo:"before",render:!0,raiseEvent:!0,createUndo:!0},r),o=ip_GenerateTransactionID();if(null==r.col&&ip_GridProps[e].selectedColumn.length>0?r.col=ip_GridProps[e].selectedColumn[0]:null==r.col&&(r.col=ip_GridProps[e].cols),null==r.count&&ip_GridProps[e].selectedColumn.length>0?r.count=ip_GridProps[e].selectedColumn.length:null==r.count&&(r.count=1),r.col<ip_GridProps[e].cols){var i="before"==r.appendTo?r.col:r.col+1,t={col:r.col,count:r.count,appendTo:r.appendTo,rowData:null};if(r.createUndo){var l={startRow:0,startCol:i,endRow:ip_GridProps[e].rows-1,endCol:i+r.count-1};ip_AddUndo(e,"ip_InsertCol",o,"function",l,l,{row:l.startRow,col:l.startCol},null,function(){ip_RemoveCol(e,{col:i,count:r.count,mode:"destroy",render:!1,raiseEvent:!1,createUndo:!1})})}var n=ip_ChangeFormulaOrigin(e,{colDiff:r.count,range:{startCol:i}}),a="before"==r.appendTo?r.col-1:r.col+1,s=ip_ValidateRangeMergedCells(e,0,a,ip_GridProps[e].rows-1,a);ip_ReshuffelMergesCol(e,"before"==r.appendTo?r.col:r.col+1,ip_GridProps[e].cols-1,r.count,!1);
    for(var p=0;p<r.count;p++){{ip_GetQuad(e,-1,i)}ip_GridProps[e].cols++;var d=ip_colObject();ip_GridProps[e].colData.splice(i,0,d);for(var c=0;c<ip_GridProps[e].rows;c++){var _=ip_cellObject(null,null,null,c,i);ip_GridProps[e].rowData[c].cells.splice(i,0,_)}}for(var u=0;u<s.merges.length;u++){var g=s.merges[u].mergedWithCol,w=s.merges[u].mergedWithCol+s.merges[u].colSpan-1;a!=g&&"after"==r.appendTo?(ip_ResetCellMerge(e,s.merges[u].mergedWithRow,s.merges[u].mergedWithCol,0,r.count),ip_AddColumnToMerge(e,s.merges[u],r.count)):a!=w&&"before"==r.appendTo&&(ip_ResetCellMerge(e,s.merges[u].mergedWithRow,s.merges[u].mergedWithCol,0,r.count),ip_AddColumnToMerge(e,s.merges[u],r.count))}var f=0==i?null:ip_rangeObject(0,0,ip_GridProps[e].rows-1,i-1);for(var h in n){var m=ip_GridProps[e].indexedData.formulaData[h];ip_SetCellFormula(e,{row:m.row,col:m.col,formula:ip_MoveFormulaOrigon(e,ip_GridProps[e].rowData[m.row].cells[m.col].formula,m.row,m.col,m.row,m.col+r.count,f)}),ip_AppendEffectedRowData(e,t,{row:m.row,col:m.col,formula:ip_GridProps[e].rowData[m.row].cells[m.col].formula})}r.render&&(ip_ReRenderCols(e),$("#"+e).ip_Scrollable({initY:!1})),$("#"+e).ip_SelectColumn({col:i,count:r.count,unselect:!1}),r.raiseEvent&&ip_RaiseEvent(e,"ip_InsertCol",o,{InsertCol:{Inputs:r,Effected:t}})}else ip_AddCol(e,{count:r.count})}function ip_InsertRow(e,r){var r=$.extend({row:ip_GridProps[e].rows,count:1,appendTo:"before",render:!0,raiseEvent:!0,createUndo:!0},r),o=ip_GenerateTransactionID();if(null==r.row&&ip_GridProps[e].selectedRow.length>0?r.row=ip_GridProps[e].selectedRow[0]:null==r.row&&(r.row=ip_GridProps[e].rows),null==r.count&&ip_GridProps[e].selectedRow.length>0?r.count=ip_GridProps[e].selectedRow.length:null==r.count&&(r.count=1),r.row<ip_GridProps[e].rows){var i="before"==r.appendTo?r.row:r.row+1,t={row:r.row,count:r.count,appendTo:r.appendTo,rowData:null};if(r.createUndo){var l={startRow:i,startCol:0,endRow:i+r.count-1,endCol:ip_GridProps[e].cols-1};ip_AddUndo(e,"ip_InsertRow",o,"function",l,l,{row:l.startRow,col:l.startCol},null,function(){ip_RemoveRow(e,{row:i,count:r.count,mode:"destroy",render:!1,raiseEvent:!1,createUndo:!1})})}var n=ip_ChangeFormulaOrigin(e,{rowDiff:r.count,range:{startRow:i}}),a="before"==r.appendTo?r.row-1:r.row+1,s=ip_ValidateRangeMergedCells(e,a,0,a,ip_GridProps[e].cols-1);ip_ReshuffelMergesRow(e,"before"==r.appendTo?r.row:r.row+1,ip_GridProps[e].rows-1,r.count,!1);for(var p=0;p<r.count;p++){{ip_GetQuad(e,i,-1)}ip_GridProps[e].rows++;var d=ip_rowObject(ip_GridProps[e].dimensions.defaultRowHeight,null,i,ip_GridProps[e].cols);ip_GridProps[e].rowData.splice(i,0,d)}for(var c=0;c<s.merges.length;c++){var _=s.merges[c].mergedWithRow,u=s.merges[c].mergedWithRow+s.merges[c].rowSpan-1;a!=_&&"after"==r.appendTo?(ip_ResetCellMerge(e,s.merges[c].mergedWithRow,s.merges[c].mergedWithCol,r.count),ip_AddRowToMerge(e,s.merges[c],r.count)):a!=u&&"before"==r.appendTo&&(ip_ResetCellMerge(e,s.merges[c].mergedWithRow,s.merges[c].mergedWithCol,r.count),ip_AddRowToMerge(e,s.merges[c],r.count))}var g=0==i?null:ip_rangeObject(0,0,i-1,ip_GridProps[e].cols-1);for(var w in n){var f=ip_GridProps[e].indexedData.formulaData[w];ip_SetCellFormula(e,{row:f.row,col:f.col,formula:ip_MoveFormulaOrigon(e,ip_GridProps[e].rowData[f.row].cells[f.col].formula,f.row,f.col,f.row+r.count,f.col,g)}),ip_AppendEffectedRowData(e,t,{row:f.row,col:f.col,formula:ip_GridProps[e].rowData[f.row].cells[f.col].formula})}r.render&&(ip_ReRenderRows(e,"frozen"),$("#"+e).ip_Scrollable(),ip_ReRenderRows(e,"scroll")),$("#"+e).ip_SelectRow({row:i,count:r.count,unselect:!1}),r.raiseEvent&&ip_RaiseEvent(e,"ip_InsertRow",o,{InsertRow:{Inputs:r,Effected:t}})}else ip_AddRow(e,{count:r.count})}function ip_FrozenDone(e){ip_HideFloatingHandles(e),ip_GridProps[e].resizing=!1}function ip_ShowColumnFrozenHandle(r,o){ip_HideFloatingHandles(r);var i=$("#"+r+"_columnFrozenHandle"),t=ip_GridProps[r].scrollX<ip_GridProps[r].frozenCols?ip_GridProps[r].frozenCols:ip_GridProps[r].scrollX,l=ip_TableWidth(r+"_q1_table"),n=(ip_CellRelativePosition(r,-1,t),$("#"+r+"_q1_columnSelectorCell_-1")),a=$("#"+r+"_columnFrozenHandleLine");if(n.length>0){var s=$("#"+r+"_table").position().top,p=parseInt($(n).css("border-left-width").replace("px",""))+parseInt($(n).css("border-right-width").replace("px","")),d=l-(0==t?$(i).width():$(i).width()/2+1);$(i).show(),$(i).css("top",p+s),$(i).css("height",$(n).height()-p/2+"px"),$(i).css("left",d+"px"),$(a).css("height",ip_GridProps[r].dimensions.gridHeight+"px"),o||$(i).draggable({snap:".ip_grid_columnSelectorCell,.ip_grid_cell,.ip_grid_columnSelectorCellCorner,.ip_grid_rowSelecterCell",snapTolerance:15,snapMode:"outer",axis:"x",containment:"parent",start:FrozenStart=function(){ip_GridProps[r].resizing=!0,$(i).css("pointer-events","none"),$(a).show()},drag:FrozenDrag=function(){},stop:FrozenEnd=function(){var o=$.map($(this).data("draggable").snapElements,function(e){var r=$(e.item).attr("col");return r&&e.snapping?parseInt(r):void 0}),t=null;for(e in o)(null==t||t>o[e])&&(t=o[e]);null==t&&(t=-1),t++,ip_FrozenDone(r,i),$("#"+r).ip_FrozenRowsCols({cols:t}),$(i).css("pointer-events","all"),ip_ShowColumnFrozenHandle(r,!0)}})}}function ip_ShowRowFrozenHandle(r,o){ip_HideFloatingHandles(r);var i=$("#"+r+"_rowFrozenHandle"),t=ip_GridProps[r].scrollY<ip_GridProps[r].frozenRows?ip_GridProps[r].frozenRows:ip_GridProps[r].scrollY,l=$("#"+r+"_q1_table").outerHeight(),n=(ip_CellRelativePosition(r,t,-1),$("#"+r+"_q1_columnSelectorCell_-1")),a=$("#"+r+"_rowFrozenHandleLine");if(n.length>0){var s=$("#"+r+"_table").position().top,p=parseInt($(n).css("border-bottom-width").replace("px","")),d=l+s-(0==t||0==ip_GridProps[r].frozenRows?$(i).height():$(i).height()/2);$(i).show(),$(i).css("left",p),$(i).css("width",$(n).width()+"px"),$(i).css("top",d+"px"),$(a).css("width",ip_GridProps[r].dimensions.gridWidth+"px"),o||$(i).draggable({snap:".ip_grid_row,.ip_grid_columnSelectorRow",snapTolerance:10,snapMode:"outer",axis:"y",containment:"parent",start:FrozenStart=function(){ip_GridProps[r].resizing=!0,$(i).css("pointer-events","none"),$(a).show()},drag:FrozenDrag=function(){},stop:FrozenEnd=function(){var o=$.map($(this).data("draggable").snapElements,function(e){var r=$(e.item).attr("row");return r&&e.snapping?parseInt(r):void 0}),t=null;for(e in o)(null==t||t>o[e])&&(t=o[e]);null==t?t=-1:t++,ip_FrozenDone(r,i),$("#"+r).ip_FrozenRowsCols({rows:t}),$(i).css("pointer-events","all"),ip_ShowRowFrozenHandle(r,!0)}})}}function ip_HideFloatingHandles(e){$("#"+e+"_rowResizer").hide(),$("#"+e+"_columnResizer").hide(),$("#"+e+"_rowFrozenHandleLine").hide(),$("#"+e+"_columnFrozenHandleLine").hide()}function ip_resizeDone(e,r){$("#"+e+"_columnLine").hide(),$("#"+e+"_rowLine").hide(),$(r).hide(),ip_GridProps[e].resizing=!1}function ip_ShowColumnResizer(e,r){ip_HideFloatingHandles(e);var o=$("#"+e+"_columnResizer"),i=ip_TableWidth(e+"_q1_table"),t=r<ip_GridProps[e].frozenCols?1:2,l=ip_CellRelativePosition(e,-1,r),n=$("#"+e+"_q"+t+"_columnSelectorCell_"+r),a=$("#"+e+"_columnLine"),s=$("#"+e+"_table").position().top;$(o).show();var p=$(o).width(),d=parseInt($(n).css("border-left-width").replace("px","")),c=parseInt($(n).css("border-top-width").replace("px","")),_=l.localLeft+(2==t?i:0)+$(n).width()-p+d+$(a).position().left+1;$(a).css("height",ip_GridProps[e].dimensions.gridHeight+"px"),$(o).css("top",d+s),$(o).css("height",$(n).height()+2*c+"px"),$(o).css("left",_+"px"),ip_GridProps[e].events.colResizer_dblClick=ip_UnBindEvent(o,"dblclick",ip_GridProps[e].events.colResizer_dblClick),$(o).dblclick(ip_GridProps[e].events.colResizer_dblClick=function(){for(var i="",t=[],l=0;l<ip_GridProps[e].selectedColumn.length;l++)t[l]=ip_GridProps[e].selectedColumn[l];-1!=jQuery.inArray(-1,t)?(t=[],t[0]=-1):-1==jQuery.inArray(parseInt(r),t)&&(t=[],t[0]=r),$("#"+e).ip_ResizeColumn({columns:t,size:i}),ip_resizeDone(e,o)}),ip_GridProps[e].events.colResizer_MouseDown=ip_UnBindEvent(o,"mousedown",ip_GridProps[e].events.colResizer_MouseDown),$(o).mousedown(ip_GridProps[e].events.colResizer_MouseDown=function(){ip_GridProps[e].resizing=!0,$(a).show(),ip_GridProps[e].events.colResizer_MouseUp=ip_UnBindEvent("#"+e,"mouseup",ip_GridProps[e].events.colResizer_MouseUp),$("#"+e).mouseup(ip_GridProps[e].events.colResizer_MouseUp=function(){ip_GridProps[e].resizing=!1})}),ip_GridProps[e].events.colResizer_MouseLeave=ip_UnBindEvent(o,"mouseleave",ip_GridProps[e].events.colResizer_MouseLeave),$(o).mouseleave(ip_GridProps[e].events.colResizer_MouseLeave=function(){ip_GridProps[e].resizing||ip_resizeDone(e,o)});var u=l.localLeft+(2==t?i:0),g=$(n).width(),w=null;$(o).draggable({axis:"x",containment:"parent",start:resizerStart=function(r,o){null==w&&(w=o.position.left),ip_GridProps[e].resizing=!0},drag:resizerDrag=function(e,r){return r.position.left<u?!1:void 0},stop:resizerEnd=function(i,t){for(var l=g+((t.position.left<u?u:t.position.left)-w),n=[],a=0;a<ip_GridProps[e].selectedColumn.length;a++)n[a]=parseInt(ip_GridProps[e].selectedColumn[a]);-1!=jQuery.inArray(-1,n)?(n=[],n[0]=-1):-1==jQuery.inArray(parseInt(r),n)&&(n=[],n[0]=r),$("#"+e).ip_ResizeColumn({columns:n,size:l}),ip_resizeDone(e,o)}})}function ip_ShowRowResizer(e,r){ip_HideFloatingHandles(e);var o=$("#"+e+"_rowResizer"),i=$("#"+e+"_q1_table").outerHeight(),t=ip_CellRelativePosition(e,r,-1),l=r<ip_GridProps[e].frozenRows?1:3,n=$("#"+e+"_q"+l+"_rowSelecterCell_"+r),a=$("#"+e+"_rowLine"),s=$(o).height(),p=parseInt($(n).css("border-bottom-width").replace("px","")),d=$(n).height(),c=$(n).offset().top,_=c+d-s;$(o).show(),$(o).offset({top:_}),$(o).css("left",p),$(o).css("width",$(n).width()+p+"px"),$(a).css("width",ip_GridProps[e].dimensions.gridWidth+"px"),ip_GridProps[e].events.rowResizer_dblClick=ip_UnBindEvent(o,"dblclick",ip_GridProps[e].events.rowResizer_dblClick),$(o).dblclick(ip_GridProps[e].events.rowResizer_dblClick=function(){for(var i="",t=[],l=0;l<ip_GridProps[e].selectedRow.length;l++)t[l]=ip_GridProps[e].selectedRow[l];-1!=jQuery.inArray(-1,t)?(t=[],t[0]=-1):-1==jQuery.inArray(parseInt(r),t)&&(t=[],t[0]=r),$("#"+e).ip_ResizeRow({rows:t,size:i}),ip_resizeDone(e,o)}),ip_GridProps[e].events.rowResizer_MouseDown=ip_UnBindEvent(o,"mousedown",ip_GridProps[e].events.rowResizer_MouseDown),$(o).mousedown(ip_GridProps[e].events.rowResizer_MouseDown=function(){ip_GridProps[e].resizing=!0,$(a).show(),ip_GridProps[e].events.rowResizer_MouseUp=ip_UnBindEvent("#"+e,"mouseup",ip_GridProps[e].events.rowResizer_MouseUp),$("#"+e).mouseup(ip_GridProps[e].events.rowResizer_MouseUp=function(){ip_GridProps[e].resizing=!1})}),ip_GridProps[e].events.rowResizer_MouseLeave=ip_UnBindEvent(o,"mouseleave",ip_GridProps[e].events.rowResizer_MouseLeave),$(o).mouseleave(ip_GridProps[e].events.rowResizer_MouseLeave=function(){ip_GridProps[e].resizing||ip_resizeDone(e,o)});var u=t.localTop+(3==l?i:0)-s+1,g=$(n).height(),w=null;$(o).draggable({axis:"y",containment:"parent",start:resizerStart=function(r,o){null==w&&(w=o.position.top),ip_GridProps[e].resizing=!0},drag:resizerDrag=function(e,r){return r.position.top<u?!1:void 0},stop:resizerEnd=function(i,t){for(var l=g+((t.position.top<u?u:t.position.top)-w),n=[],a=0;a<ip_GridProps[e].selectedRow.length;a++)n[a]=parseInt(ip_GridProps[e].selectedRow[a]);-1!=jQuery.inArray(-1,n)?(n=[],n[0]=-1):-1==jQuery.inArray(parseInt(r),n)&&(n=[],n[0]=r),$("#"+e).ip_ResizeRow({rows:n,size:l}),ip_resizeDone(e,o)}})}function ip_ShowGridResizerHandle(e){var r=$("#"+e+"_gridResizer"),o=$(document.body);$(r).unbind("dblclick"),$(r).on("dblclick",function(){var r=$("#"+e).parent().width(),o=$("#"+e).width(),i=r>o?r:Math.ceil(r/2);ip_ResizeGrid(e,i)}),$(r).draggable({snap:$(o),snapMode:"outer",axis:"x",containment:o,start:resizerStart=function(){ip_GridProps[e].resizing=!0,$(r).addClass("resizing"),$("#"+e+"_gridResizerLine").show()},drag:resizerDrag=function(){},stop:resizerEnd=function(i,t){$(r).removeClass("resizing");var l=$(r).width()+t.position.left-$("#"+e).position().left;l>$(o).width()&&(l=$(o).width());var n=ip_ResizeGrid(e,l);ip_GridProps[e].resizing=!1,""!=n&&($(r).css("left",ip_GridProps[e].dimensions.gridWidth-parseInt($("#"+e+"_q4_scrollbar_container_y").width())+"px"),ip_RaiseEvent(e,"warning",null,n))}})}function ip_ResizeGrid(e,r,o){var i="",t=parseInt($("#"+e+"_q1_table").outerWidth());if(null==o&&(o=!0),null==r&&(r=$("#"+e).width()),$("#"+e+"_gridResizerLine").hide(),r>t?(ip_GridProps[e].dimensions.gridWidth=r,$("#"+e).width(r),$("#"+e).ip_Scrollable(),ip_ReRenderCols(e,"scroll")):i="Your grid size may not be smaller than frozen columns, please re-adjust the width so that it is beyond the frozen columns",""==i&&o){var l={width:r};ip_RaiseEvent(e,"ip_ResizeGrid",ip_GenerateTransactionID(),{ResizeGrid:{Inputs:null,Effected:l}})}return i}function ip_MoveColumn(e,r){var r=$.extend({col:0,toCol:0,count:1,prevalidated:null,render:!0,raiseEvent:!0,createUndo:!0},r),o=r.col,i=r.toCol,t=r.count,l=i-o,n=null==r.prevalidated?ip_ValidateColumnMove(e,o,i,t):r.prevalidated,a=ip_GenerateTransactionID(),s={col:o,toCol:i,count:t,rowData:null},p={startCol:i,endCol:i+t-1,startRow:0,endRow:ip_GridProps[e].rows-1},d={startCol:o,endCol:o+t-1,startRow:0,endRow:ip_GridProps[e].rows-1};if(n.valid&&o>=0&&o<ip_GridProps[e].cols&&i>=0&&i<ip_GridProps[e].cols){if(r.createUndo){var c={startRow:-1,startCol:o,endRow:ip_GridProps[e].rows-1,endCol:o+t-1};ip_AddUndo(e,"ip_MoveCol",a,"function",c,c,{row:c.startRow,col:c.startCol},null,function(){ip_MoveColumn(e,{col:i,toCol:o,count:t,render:!1,raiseEvent:!1,createUndo:!1})})}for(var _=0;_<n.containsMerges.merges.length;_++)ip_ResetCellMerge(e,n.containsMerges.merges[_].mergedWithRow,n.containsMerges.merges[_].mergedWithCol);l>0?ip_ReshuffelMergesCol(e,o,i+t-1,-t,!1):ip_ReshuffelMergesCol(e,i,o,t,!1);for(var u=[],g=0;t>g;g++)u[g]=ip_GridProps[e].colData[o+g];ip_GridProps[e].colData.splice(o,t);for(var g=0;g<u.length;g++)ip_GridProps[e].colData.splice(i+g,0,u[g]);s.rowData=ip_ChangeFormulasForColumMove(e,{count:t,fromCol:o,toCol:i}).rowData;for(var w=0;w<ip_GridProps[e].rows;w++){for(var f=ip_GridProps[e].rowData[w].cells,h=[],g=0;t>g;g++)h[g]=f[o+g];f.splice(o,t);for(var g=0;g<h.length;g++)f.splice(i+g,0,h[g])}for(var m=0;m<n.containsMerges.merges.length;m++){var v=n.containsMerges.merges[m].mergedWithRow,C=n.containsMerges.merges[m].mergedWithCol+l,R=n.containsMerges.merges[m].mergedWithRow+n.containsMerges.merges[m].rowSpan-1,G=C+n.containsMerges.merges[m].colSpan-1;ip_SetCellMerge(e,v,C,R,G)}return s.rowData=s.rowData.concat(ip_ReCalculateFormulas(e,{range:[d,p],transactionID:a,render:!1,raiseEvent:!1,createUndo:!1}).Effected.rowData),r.render&&(ip_ReRenderCols(e,"frozen"),$("#"+e).ip_Scrollable(),ip_ReRenderCols(e,"scroll")),r.raiseEvent&&ip_RaiseEvent(e,"ip_MoveCol",a,{MoveCol:{Inputs:r,Effected:s}}),!0}return ip_RaiseEvent(e,"warning",arguments.callee.caller,n.error),!1}function ip_ChangeFormulasForColumMove(e,r){var o,r=$.extend({fromCol:null,toCol:null,count:1},r),i={rowData:[]},t=r.count,l=r.fromCol,n=r.toCol,a=n-l,s=({startCol:n,endCol:n+t-1,startRow:0,endRow:ip_GridProps[e].rows-1},{startCol:l,endCol:l+t-1,startRow:0,endRow:ip_GridProps[e].rows-1});o=0>a?{startCol:n,endCol:l-1,startRow:0,endRow:ip_GridProps[e].rows-1}:{startCol:l+t,endCol:n+t-1,startRow:0,endRow:ip_GridProps[e].rows-1};var p=ip_FormulasInRange(e,s,!0,!0),d=ip_FormulasInRange(e,o,!0,!0);for(var c in p){var _=ip_GridProps[e].indexedData.formulaData[c],u=_.formula,g="";g=ip_MoveFormulaOrigon(e,u,_.row,_.col,_.row,_.col+a,null,s,0,0>a?t:-t,o,s);var w=ip_SetCellFormula(e,{row:_.row,col:_.col,formula:g,isRowColShuffel:!0});w.col<s.startCol||w.col>s.endCol?a>=0||w.col<n||w.col>l?0>=a||w.col>n||w.col<l||(w.col-=t):w.col+=t:w.col+=a,u!=g&&ip_AppendEffectedRowData(e,i,{row:w.row,col:w.col,formula:g})}for(var c in d)if(null==p[c]&&null!=ip_GridProps[e].indexedData.formulaData[c]){var _=ip_GridProps[e].indexedData.formulaData[c],u=_.formula,g=ip_MoveFormulaOrigon(e,u,_.row,_.col,_.row,_.col+(0>a?t:-t),null,o,null,null,null,o),w=ip_SetCellFormula(e,{row:_.row,col:_.col,formula:g});0>=a||w.col<o.startCol||w.col>o.endCol?a>=0||w.col<o.startCol||w.col>o.endCol||(w.col+=t):w.col-=t,u!=g&&ip_AppendEffectedRowData(e,i,{row:w.row,col:w.col,formula:g})}return i}function ip_MoveRow(e,r){var r=$.extend({row:0,toRow:0,count:1,revalidated:null,render:!0,raiseEvent:!0,createUndo:!0},r),o=r.row,i=r.toRow,t=r.count,l=i-o,n=null==r.prevalidated?ip_ValidateRowMove(e,o,i,t):r.prevalidated,a=ip_GeneratePublicKey(),s={row:o,toRow:i,count:t,rowData:null},p={startRow:o,endRow:o+t-1,startCol:0,endCol:ip_GridProps[e].cols-1},d={startRow:i,endRow:i+t-1,startCol:0,endCol:ip_GridProps[e].cols-1};if(n.valid&&o>=0&&o<ip_GridProps[e].rows&&i>=0&&i<ip_GridProps[e].rows){if(r.createUndo){var c={startRow:o,startCol:-1,endRow:o+t-1,endCol:ip_GridProps[e].cols-1};ip_AddUndo(e,"ip_MoveRow",a,"function",c,c,{row:c.startRow,col:c.startCol},null,function(){ip_MoveRow(e,{row:i,toRow:o,count:t,render:!1,raiseEvent:!1,createUndo:!1})})}s.rowData=ip_ChangeFormulasForRowMove(e,{count:t,fromRow:o,toRow:i}).rowData;for(var _=0;_<n.containsMerges.merges.length;_++)ip_ResetCellMerge(e,n.containsMerges.merges[_].mergedWithRow,n.containsMerges.merges[_].mergedWithCol);l>0?ip_ReshuffelMergesRow(e,o,i+t-1,-t,!1):ip_ReshuffelMergesRow(e,i,o,t,!1);for(var u=[],g=0;t>g;g++)u[g]=ip_GridProps[e].rowData[o+g];ip_GridProps[e].rowData.splice(o,t);for(var g=0;t>g;g++)ip_GridProps[e].rowData.splice(i+g,0,u[g]);for(var w=0;w<n.containsMerges.merges.length;w++){var f=n.containsMerges.merges[w].mergedWithRow+l,h=n.containsMerges.merges[w].mergedWithCol,m=f+n.containsMerges.merges[w].rowSpan-1,v=n.containsMerges.merges[w].mergedWithCol+n.containsMerges.merges[w].colSpan-1;ip_SetCellMerge(e,f,h,m,v)}return s.rowData=s.rowData.concat(ip_ReCalculateFormulas(e,{range:[p,d],transactionID:a,render:!1,raiseEvent:!1,createUndo:!1}).Effected.rowData),r.render&&(ip_ReRenderRows(e,"frozen"),$("#"+e).ip_Scrollable(),ip_ReRenderRows(e,"scroll")),r.raiseEvent&&ip_RaiseEvent(e,"ip_MoveRow",a,{MoveRow:{Inputs:r,Effected:s}}),!0}return ip_RaiseEvent(e,"warning",arguments.callee.caller,n.error),!1}function ip_ChangeFormulasForRowMove(e,r){var o,r=$.extend({fromRow:null,toRow:null,count:1},r),i={rowData:[]},t=r.count,l=r.fromRow,n=r.toRow,a=n-l,s=({startRow:n,endRow:n+t-1,startCol:0,endCol:ip_GridProps[e].cols-1},{startRow:l,endRow:l+t-1,startCol:0,endCol:ip_GridProps[e].cols-1});o=0>a?{startRow:n,endRow:l-1,startCol:0,endCol:ip_GridProps[e].cols-1}:{startRow:l+t,endRow:n+t-1,startCol:0,endCol:ip_GridProps[e].cols-1};var p=ip_FormulasInRange(e,s,!0,!0),d=ip_FormulasInRange(e,o,!0,!0);for(var c in p){var _=ip_GridProps[e].indexedData.formulaData[c],u=_.formula,g="";g=ip_MoveFormulaOrigon(e,u,_.row,_.col,_.row+a,_.col,null,s,0>a?t:-t,0,o,s);var w=ip_SetCellFormula(e,{row:_.row,col:_.col,formula:g,isRowColShuffel:!0});w.row<s.startRow||w.row>s.endRow?a>=0||w.row<n||w.row>l?0>=a||w.row>n||w.row<l||(w.row-=t):w.row+=t:w.row+=a,u!=g&&ip_AppendEffectedRowData(e,i,{row:w.row,col:w.col,formula:g})}for(var c in d)if(null==p[c]&&null!=ip_GridProps[e].indexedData.formulaData[c]){var _=ip_GridProps[e].indexedData.formulaData[c],u=_.formula,g=ip_MoveFormulaOrigon(e,u,_.row,_.col,_.row+(0>a?t:-t),_.col,null,o,null,null,null,o),w=ip_SetCellFormula(e,{row:_.row,col:_.col,formula:g});0>=a||w.row<o.startRow||w.row>o.endRow?a>=0||w.row<o.startRow||w.row>o.endRow||(w.row+=t):w.row-=t,u!=g&&ip_AppendEffectedRowData(e,i,{row:w.row,col:w.col,formula:g})}return i}function ip_ShowColumnMove(e,r){ip_GridProps[e].resizing=!0,ip_GridProps[e].selectedColumn.sort(function(e,r){return e-r}),$("#"+e).ip_RemoveRangeHighlight();var o=$("#"+e+" .ip_grid_cell_rangeselector_selected");$(o).addClass("ip_grid_cell_rangeselector_move"),$(o).each(function(){this.startPos=$(this).position().left});for(var i=[],t=-2,l=0;l<ip_GridProps[e].selectedColumn.length;l++){var n=ip_GridProps[e].selectedColumn[l];n-t!=1?i[i.length]={col:n,count:1,toCol:n}:i[i.length-1].count++,t=n}var a=-1,s=0;$("#"+e).mousemove(ip_GridProps[e].events.moveRange_mouseMove=function(t){-1==a&&(a=t.pageX);var l=t.pageX-a;$(o).each(function(){$(this).css("left",this.startPos+l+"px")}),ip_SetHoverCell(e,".ip_grid_cell_rangeselector_move",t);var n=parseInt($(ip_GridProps[e].hoverCell).attr("col")),p=n-r;if(s!=p){for(var d=0;d<i.length;d++)$("#"+e).ip_RangeHighlight({multiselect:0==d?!1:!0,highlightType:"ip_grid_cell_rangeHighlight_move",range:{startRow:0,startCol:i[d].col+p,endRow:ip_GridProps[e].rows-1,endCol:i[d].col+p+i[d].count-1}});s=p}}),$(document).mouseup(ip_GridProps[e].events.moveRange_mouseUp=function(o){ip_GridProps[e].resizing=!1,ip_SetHoverCell(e,".ip_grid_cell_rangeselector_move",o),ip_GridProps[e].events.moveRange_mouseUp=ip_UnBindEvent(document,"mouseup",ip_GridProps[e].events.moveRange_mouseUp),ip_GridProps[e].events.moveRange_mouseMove=ip_UnBindEvent("#"+e,"mousemove",ip_GridProps[e].events.moveRange_mouseMove),$("#"+e).ip_RemoveRangeHighlight();var t=parseInt($(ip_GridProps[e].hoverCell).attr("col")),l=t-r,n="";if(0!=l){for(var a=0;a<i.length;a++)i[a].toCol=i[a].col+l;for(var a=0;a<i.length;a++){i[a].prevalidated=ip_ValidateColumnMove(e,i[a].col,i[a].toCol,i[a].count);var n=i[a].prevalidated.error;""!=n&&(a=i.length)}if(""==n){if(l>0)for(var a=i.length-1;a>=0;a--)ip_MoveColumn(e,i[a]);else for(var a=0;a<i.length;a++)ip_MoveColumn(e,i[a]);for(var a=0;a<i.length;a++)$("#"+e).ip_SelectColumn({multiselect:0==a?!1:!0,unselect:!1,col:i[a].toCol,count:i[a].count})}else{for(var a=0;a<i.length;a++)$("#"+e).ip_SelectColumn({multiselect:0==a?!1:!0,col:i[a].col,count:i[a].count});ip_RaiseEvent(e,"warning",null,n)}}else for(var a=0;a<i.length;a++)$("#"+e).ip_SelectColumn({multiselect:0==a?!1:!0,col:i[a].col,count:i[a].count})})}function ip_ShowRowMove(e,r){ip_GridProps[e].resizing=!0,ip_GridProps[e].selectedRow.sort(function(e,r){return e-r}),$("#"+e).ip_RemoveRangeHighlight();var o=$("#"+e+" .ip_grid_cell_rangeselector_selected");$(o).addClass("ip_grid_cell_rangeselector_move"),$(o).each(function(){this.startPos=$(this).position().top});for(var i=[],t=-2,l=0;l<ip_GridProps[e].selectedRow.length;l++){var n=ip_GridProps[e].selectedRow[l];n-t!=1?i[i.length]={row:n,count:1,toRow:n}:i[i.length-1].count++,t=n}var a=-1,s=0;$("#"+e).mousemove(ip_GridProps[e].events.moveRange_mouseMove=function(t){-1==a&&(a=t.pageY);var l=t.pageY-a;$(o).each(function(){$(this).css("top",this.startPos+l+"px")}),ip_SetHoverCell(e,".ip_grid_cell_rangeselector_move",t);var n=parseInt($(ip_GridProps[e].hoverCell).attr("row")),p=n-r;if(s!=p){for(var d=0;d<i.length;d++)$("#"+e).ip_RangeHighlight({multiselect:0==d?!1:!0,highlightType:"ip_grid_cell_rangeHighlight_move",range:{startRow:i[d].row+p,startCol:0,endRow:i[d].row+p+i[d].count-1,endCol:ip_GridProps[e].cols-1}});s=p}}),$(document).mouseup(ip_GridProps[e].events.moveRange_mouseUp=function(o){ip_GridProps[e].resizing=!1,ip_SetHoverCell(e,".ip_grid_cell_rangeselector_move",o),ip_GridProps[e].events.moveRange_mouseUp=ip_UnBindEvent(document,"mouseup",ip_GridProps[e].events.moveRange_mouseUp),ip_GridProps[e].events.moveRange_mouseMove=ip_UnBindEvent("#"+e,"mousemove",ip_GridProps[e].events.moveRange_mouseMove),$("#"+e).ip_RemoveRangeHighlight();var t=parseInt($(ip_GridProps[e].hoverCell).attr("row")),l=t-r,n="";if(0!=l){for(var a=0;a<i.length;a++)i[a].toRow=i[a].row+l;for(var a=0;a<i.length;a++){i[a].prevalidated=ip_ValidateRowMove(e,i[a].row,i[a].toRow,i[a].count);var n=i[a].prevalidated.error;""!=n&&(a=i.length)}if(""==n){if(l>0)for(var a=i.length-1;a>=0;a--)ip_MoveRow(e,i[a]);else for(var a=0;a<i.length;a++)ip_MoveRow(e,i[a]);for(var a=0;a<i.length;a++)$("#"+e).ip_SelectRow({multiselect:0==a?!1:!0,unselect:!1,row:i[a].toRow,count:i[a].count})}else{for(var a=0;a<i.length;a++)$("#"+e).ip_SelectRow({multiselect:0==a?!1:!0,row:i[a].row,count:i[a].count});ip_RaiseEvent(e,"warning",null,n)}}else for(var a=0;a<i.length;a++)$("#"+e).ip_SelectRow({multiselect:0==a?!1:!0,row:i[a].row,count:i[a].count})})}function ip_ValidateColumnMove(e,r,o,i){var t={error:"",containsMerges:null,valid:!0},l=o-r,n="";(0>o||o>=ip_GridProps[e].cols)&&(n="When moving columns, make sure the move stays within the range of the sheet"),t.containsMerges=ip_ValidateRangeMergedCells(e,0,r,ip_GridProps[e].rows-1,r+i-1),1==t.containsMerges.containsOverlap&&(n="When moving columns that contain merges please take the full merge, or unmerge your cells");for(var a=0;a<t.containsMerges.merges.length;a++)if(t.containsMerges.merges[a].containsOverlap){var s=t.containsMerges.merges[a].mergedWithRow,p=t.containsMerges.merges[a].mergedWithCol,d=s+t.containsMerges.merges[a].rowSpan-1,c=p+t.containsMerges.merges[a].colSpan-1;$("#"+e).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,range:{startRow:s,startCol:p,endRow:d,endCol:c}})}var _=ip_ValidateRangeMergedCells(e,0,r+l,ip_GridProps[e].rows-1,r+l+i-1);_.containsOverlap=!1;for(var a=0;a<_.merges.length;a++)if(_.merges[a].containsOverlap){var s=_.merges[a].mergedWithRow,p=_.merges[a].mergedWithCol,d=s+_.merges[a].rowSpan-1,c=p+_.merges[a].colSpan-1;l>0&&c>=o+i?(_.containsOverlap=!0,$("#"+e).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,range:{startRow:s,startCol:p,endRow:d,endCol:c}})):0>l&&o>p&&(_.containsOverlap=!0,$("#"+e).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,range:{startRow:s,startCol:p,endRow:d,endCol:c}}))}return 1==_.containsOverlap&&(n+=(""!=n?", you also c":"C")+"annot move columns on top cells that contain merges"),t.error=n,t.valid=""==n?!0:!1,t}function ip_ValidateRowMove(e,r,o,i){var t={error:"",containsMerges:null,valid:!0},l=o-r,n="";(0>o||o>=ip_GridProps[e].rows)&&(n="When moving rows, make sure the move stays within the range of the sheet"),t.containsMerges=ip_ValidateRangeMergedCells(e,r,0,r+i-1,ip_GridProps[e].cols-1),1==t.containsMerges.containsOverlap&&(n="When moving rows that contain merges please take the full merge, or unmerge your cells");for(var a=0;a<t.containsMerges.merges.length;a++)if(t.containsMerges.merges[a].containsOverlap){var s=t.containsMerges.merges[a].mergedWithRow,p=t.containsMerges.merges[a].mergedWithCol,d=s+t.containsMerges.merges[a].rowSpan-1,c=p+t.containsMerges.merges[a].colSpan-1;$("#"+e).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,range:{startRow:s,startCol:p,endRow:d,endCol:c}})}var _=ip_ValidateRangeMergedCells(e,r+l,0,r+l+i-1,ip_GridProps[e].cols-1);_.containsOverlap=!1;for(var a=0;a<_.merges.length;a++)if(_.merges[a].containsOverlap){var s=_.merges[a].mergedWithRow,p=_.merges[a].mergedWithCol,d=s+_.merges[a].rowSpan-1,c=p+_.merges[a].colSpan-1;l>0&&d>=o+i?(_.containsOverlap=!0,$("#"+e).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,range:{startRow:s,startCol:p,endRow:d,endCol:c}})):0>l&&o>s&&(_.containsOverlap=!0,$("#"+e).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,range:{startRow:s,startCol:p,endRow:d,endCol:c}}))}return 1==_.containsOverlap&&(n+=(""!=n?", you also c":"C")+"annot move rows on top cells that contain merges"),t.error=n,t.valid=""==n?!0:!1,t}function ip_NextNonHiddenRow(e,r,o,i,t,l){if(0>r&&(r=0),l&&r<ip_GridProps[e].scrollY&&(r=ip_GridProps[e].scrollY),r>=ip_GridProps[e].rows)return i;if(!ip_GridProps[e].rowData[r].hide)return r;var n=r;if("down"==t)for(null==o&&(o=ip_GridProps[e].rows-1);o>=n;){if(!ip_GridProps[e].rowData[n].hide)return n;n++}else for(null==o&&(o=0);n>=o;){if(!ip_GridProps[e].rowData[n].hide)return n;n--}return i}function ip_NextNonHiddenCol(e,r,o,i,t,l){if(0>r&&(r=0),l&&r<ip_GridProps[e].scrollX&&(r=ip_GridProps[e].scrollX),!ip_GridProps[e].colData[r].hide)return r;var n=r;if("right"==t)for(null==o&&(o=ip_GridProps[e].cols-1);o>=n;){if(!ip_GridProps[e].colData[n].hide)return n;n++}else for(null==o&&(o=0);n>=o;){if(!ip_GridProps[e].colData[n].hide)return n;n--}return i}function ip_CalculateHiddenRowSpan(e,r,o){for(var i=0,t=r;o>=t;t++)ip_GridProps[e].rowData[t].hide||i++;return i}function ip_CalculateHiddenColSpan(e,r,o){for(var i=0,t=r;o>=t;t++)ip_GridProps[e].colData[t].hide||i++;return i}function ip_RemoveAllMerges(e){for(key in ip_GridProps[e].mergeData){var r=ip_GridProps[e].mergeData[key].mergedWithRow,o=ip_GridProps[e].mergeData[key].mergedWithCol,i=r+ip_GridProps[e].mergeData[key].rowSpan-1,t=o+ip_GridProps[e].mergeData[key].colSpan-1;ip_ResetMerge(e,r,o,i,t)}}function ip_ResetCellMerge(e,r,o,i,t){null==i&&(i=0),null==t&&(t=0);var l=ip_GridProps[e].rowData[r].cells[o].merge;if(null!=l){l=ip_GridProps[e].rowData[l.mergedWithRow].cells[l.mergedWithCol].merge;var n=l.mergedWithRow+l.rowSpan-1+i,a=l.mergedWithCol+l.colSpan-1+t;r=l.mergedWithRow,o=l.mergedWithCol,ip_ResetMerge(e,r,o,n,a)}}function ip_ResetMerge(e,r,o,i,t){delete ip_GridProps[e].mergeData[r+"-"+o];for(var l=r;i>=l;l++){for(var n=o;t>=n;n++)if(null!=ip_GridProps[e].rowData[l].cells[n].merge&&delete ip_GridProps[e].rowData[l].cells[n].merge,null!=ip_GridProps[e].colData[n].containsMerges){for(var a=ip_GridProps[e].colData[n].containsMerges.length-1;a>=0;a--){var s=ip_GridProps[e].colData[n].containsMerges[a];s.mergedWithRow==r&&s.mergedWithCol==o&&(ip_GridProps[e].colData[n].containsMerges.splice(a,1),a=0)}0==ip_GridProps[e].colData[n].containsMerges.length&&(ip_GridProps[e].colData[n].containsMerges=null)}if(null!=ip_GridProps[e].rowData[l].containsMerges){for(var p=ip_GridProps[e].rowData[l].containsMerges.length-1;p>=0;p--){var s=ip_GridProps[e].rowData[l].containsMerges[p];s.mergedWithRow==r&&s.mergedWithCol==o&&(ip_GridProps[e].rowData[l].containsMerges.splice(p,1),p=0)}0==ip_GridProps[e].rowData[l].containsMerges.length&&(ip_GridProps[e].rowData[l].containsMerges=null)}}}function ip_SetCellMerge(e,r,o,i,t,l,n){for(var a=ip_ValidateFrozenMerge(e,r,o,i,t),s=0;s<a.length;s++){var p=a[s].startRow,d=a[s].startCol,c=a[s].endRow,_=a[s].endCol,u=0,g=p,w=d,f=c-p+1,h=_-d+1,v=null;if(0>p&&(p=0),0>d&&(d=0),c<ip_GridProps[e].rows||(c=ip_GridProps[e].rows-1),_<ip_GridProps[e].cols||(_=ip_GridProps[e].cols-1),0>c)return!1;if(0>_)return!1;if(p>=ip_GridProps[e].rows)return!1;if(d>=ip_GridProps[e].cols)return!1;var v=ip_GridProps[e].rowData[p].cells[d].merge;if(null==v||v.rowSpan!=f||v.colSpan!=h){p<ip_GridProps[e].frozenRows&&c>=ip_GridProps[e].frozenRows&&(c=ip_GridProps[e].frozenRows-1),d<ip_GridProps[e].frozenCols&&_>=ip_GridProps[e].frozenCols&&(_=ip_GridProps[e].frozenCols-1);var C=ip_ValidateRangeMergedCells(e,p,d,c,_);for(m=0;m<C.merges.length;m++)ip_AddUndoTransactionData(e,n,ip_mergeObject(C.merges[m].mergedWithRow,C.merges[m].mergedWithCol,C.merges[m].rowSpan,C.merges[m].colSpan)),ip_ResetCellMerge(e,C.merges[m].mergedWithRow,C.merges[m].mergedWithCol);var v=ip_mergeObject();v.mergedWithRow=g,v.mergedWithCol=w,v.rowSpan=f,v.colSpan=h,ip_GridProps[e].mergeData[v.mergedWithRow+"-"+v.mergedWithCol]=v;for(var R=p;c>=R;R++){var G=0;null==ip_GridProps[e].rowData[R].containsMerges&&(ip_GridProps[e].rowData[R].containsMerges=[]),ip_GridProps[e].rowData[R].containsMerges[ip_GridProps[e].rowData[R].containsMerges.length]=v;for(var P=d;_>=P;P++)ip_AddUndoTransactionData(e,l,ip_CloneCell(e,R,P)),null==ip_GridProps[e].colData[P].containsMerges&&(ip_GridProps[e].colData[P].containsMerges=[]),R==p&&(ip_GridProps[e].colData[P].containsMerges[ip_GridProps[e].colData[P].containsMerges.length]=v),null==ip_GridProps[e].rowData[R].cells[P].merge&&(ip_GridProps[e].rowData[R].cells[P].merge=ip_mergeObject()),(R!=g||P!=w)&&ip_SetValue(e,R,P,null),ip_GridProps[e].rowData[R].cells[P].merge.mergedWithRow=g,ip_GridProps[e].rowData[R].cells[P].merge.mergedWithCol=w,ip_GridProps[e].rowData[R].cells[P].merge.rowSpan=f-u,ip_GridProps[e].rowData[R].cells[P].merge.colSpan=h-G,G++;u++}}}return!0}function ip_ValidateFrozenMerge(e,r,o,i,t){var l=[];
    return r<ip_GridProps[e].frozenRows&&i>=ip_GridProps[e].frozenRows&&o<ip_GridProps[e].frozenCols&&t>=ip_GridProps[e].frozenCols?(l[l.length]={startRow:r,startCol:o,endRow:ip_GridProps[e].frozenRows-1,endCol:ip_GridProps[e].frozenCols-1},l[l.length]={startRow:r,startCol:ip_GridProps[e].frozenCols,endRow:ip_GridProps[e].frozenRows-1,endCol:t},l[l.length]={startRow:ip_GridProps[e].frozenRows,startCol:o,endRow:i,endCol:ip_GridProps[e].frozenCols-1},l[l.length]={startRow:ip_GridProps[e].frozenRows,startCol:ip_GridProps[e].frozenCols,endRow:i,endCol:t}):r<ip_GridProps[e].frozenRows&&i>=ip_GridProps[e].frozenRows?(l[l.length]={startRow:r,endRow:ip_GridProps[e].frozenRows-1,startCol:o,endCol:t},l[l.length]={startRow:ip_GridProps[e].frozenRows,endRow:i,startCol:o,endCol:t}):o<ip_GridProps[e].frozenCols&&t>=ip_GridProps[e].frozenCols?(l[l.length]={startRow:r,endRow:i,startCol:o,endCol:ip_GridProps[e].frozenCols-1},l[l.length]={startRow:r,endRow:i,startCol:ip_GridProps[e].frozenCols,endCol:t}):l[l.length]={startRow:r,startCol:o,endRow:i,endCol:t},l}function ip_SetRowColSpan(e,r,o,i,t,l,n){var a=[];if(null==l&&(l=0),o<ip_GridProps[e].rows||(o=ip_GridProps[e].rows-1),t<ip_GridProps[e].cols||(t=ip_GridProps[e].cols-1),null!=r)for(var s=r;o>=s;s++)if(null!=ip_GridProps[e].rowData[s].containsMerges){null==n&&(n=ip_LoadedRowsCols(e,!1));for(var p=0;p<ip_GridProps[e].rowData[s].containsMerges.length;p++){var d=ip_GridProps[e].rowData[s].containsMerges[p],c=d.mergedWithRow+"-"+d.mergedWithCol;if(null==a[c]){var _=ip_GetMergeLoadedProperties(e,d,n);if(null!=_){for(var u=_.startRow;u<=_.endRow;u++)$("#"+e+"_cell_"+u+"_"+_.startCol).addClass("ip_grid_MergedCell");var g=ip_CalculateHiddenRowSpan(e,_.startRow,_.endRow);$("#"+e+"_cell_"+_.startRow+"_"+_.startCol).attr("rowspan",g);var w=ip_CalculateHiddenColSpan(e,_.startCol,_.endCol);$("#"+e+"_cell_"+_.startRow+"_"+_.startCol).attr("colspan",w),$("#"+e+"_cell_"+_.startRow+"_"+_.startCol).removeClass("ip_grid_MergedCell")}}a[c]=!0}}if(null!=i)for(var f=i;t>=f;f++)if(null!=ip_GridProps[e].colData[f].containsMerges){null==n&&(n=ip_LoadedRowsCols(e,!1));for(var p=0;p<ip_GridProps[e].colData[f].containsMerges.length;p++){var d=ip_GridProps[e].colData[f].containsMerges[p],c=d.mergedWithRow+"-"+d.mergedWithCol;if(null==a[c]){var _=ip_GetMergeLoadedProperties(e,d,n);if(null!=_){for(var h=_.startCol;h<=_.endCol;h++)$("#"+e+"_cell_"+_.startRow+"_"+h).addClass("ip_grid_MergedCell");var w=ip_CalculateHiddenColSpan(e,_.startCol,_.endCol);$("#"+e+"_cell_"+_.startRow+"_"+_.startCol).attr("colspan",w);var g=ip_CalculateHiddenRowSpan(e,_.startRow,_.endRow);$("#"+e+"_cell_"+_.startRow+"_"+_.startCol).attr("rowspan",g),$("#"+e+"_cell_"+_.startRow+"_"+_.startCol).removeClass("ip_grid_MergedCell")}}a[c]=!0}}}function ip_GetNextMergedCell(e,r,o,i){var t=ip_CellData(e,r,o),l={row:r,col:o};if(null!=t&&null!=t.merge){if(l.row=ip_NextNonHiddenRow(e,t.merge.mergedWithRow,t.merge.mergedWithRow+t.merge.rowSpan-1,r,"down"),l.col=ip_NextNonHiddenCol(e,t.merge.mergedWithCol,t.merge.mergedWithCol+t.merge.colSpan-1,o,"right"),null!=t.merge.mergedWithRow){var n=t.merge.mergedWithRow+t.merge.rowSpan+(r-t.merge.mergedWithRow);"down"==i&&r>t.merge.mergedWithRow&&n>r?l.row=n:r>t.merge.mergedWithRow&&n>r&&(l.row=t.merge.mergedWithRow)}if(null!=t.merge.mergedWithCol){var a=t.merge.mergedWithCol+t.merge.colSpan+(o-t.merge.mergedWithCol);"right"==i&&o>t.merge.mergedWithCol&&a>o?l.col=a:o>t.merge.mergedWithCol&&a>o&&(l.col=t.merge.mergedWithCol)}}return l}function ip_GetMergeLoadedProperties(e,r,o){var i=r.mergedWithRow,t=r.mergedWithRow+r.rowSpan-1,l=r.mergedWithCol,n=r.mergedWithCol+r.colSpan-1,a=ip_GetQuad(e,i,l);if(o=null==o?ip_LoadedRowsCols(e,!1):o,1==a||2==a){if(i<o.rowFrom_frozen&&t<o.rowFrom_frozen)return null;if(i>o.rowTo_frozen&&t>o.rowTo_frozen)return null}else if(3==a||4==a){if(i<o.rowFrom_scroll&&t<o.rowFrom_scroll)return null;if(i>o.rowTo_scroll&&t>o.rowTo_scroll)return null}if(1==a||3==a){if(l<o.colFrom_frozen&&n<o.colFrom_frozen)return null;if(l>o.colTo_frozen&&n>o.colTo_frozen)return null}else if(2==a||4==a){if(l<o.colFrom_scroll&&n<o.colFrom_scroll)return null;if(l>o.colTo_scroll&&n>o.colTo_scroll)return null}var s={startRow:i,startCol:l,endRow:t,endCol:n,rowSpan:r.rowSpan,colSpan:r.colSpan};return 4==a?(i<o.rowFrom_scroll&&(s.startRow=o.rowFrom_scroll),t>o.rowTo_scroll&&(s.endRow=o.rowTo_scroll),l<o.colFrom_scroll&&(s.startCol=o.colFrom_scroll),n>o.colTo_scroll&&(s.endCol=o.colTo_scroll)):3==a?(i<o.rowFrom_scroll&&(s.startRow=o.rowFrom_scroll),t>o.rowTo_scroll&&(s.endRow=o.rowTo_scroll),l<o.colFrom_frozen&&(s.startCol=o.colFrom_frozen),n>o.colTo_frozen&&(s.endCol=o.colTo_frozen)):2==a&&(i<o.rowFrom_frozen&&(s.startRow=o.rowFrom_frozen),t>o.rowTo_frozen&&(s.endRow=o.rowTo_frozen),l<o.colFrom_scroll&&(s.startCol=o.colFrom_scroll),n>o.colTo_scroll&&(s.endCol=o.colTo_scroll)),s.startRow=ip_NextNonHiddenRow(e,s.startRow,s.endRow,s.startRow,"down"),s.startCol=ip_NextNonHiddenCol(e,s.startCol,s.endCol,s.startCol,"right"),s}function ip_GetRangeMergedCells(e,r,o,i,t){-1>r&&(r=-1),-1>o&&(o=-1);var l={startRow:r,startCol:o,endRow:i,endCol:t,startMerge:!1,endMerge:!1};if(i>=ip_GridProps[e].rows||t>=ip_GridProps[e].cols)return l;if(0>i||0>t)return l;if(-1!=l.startRow){var n=ip_CellData(e,l.startRow,l.endCol);if(null!=n.merge){var a=ip_CellData(e,n.merge.mergedWithRow,n.merge.mergedWithCol),s=a.merge.mergedWithRow,p=a.merge.mergedWithCol,d=a.merge.mergedWithRow+a.merge.rowSpan-1,c=a.merge.mergedWithCol+a.merge.colSpan-1;s<l.startRow&&(l.startRow=s),p<l.startCol&&(l.startCol=p),d>l.endRow&&(l.endRow=d),c>l.endCol&&(l.endCol=c)}}if(-1!=l.startCol){var _=ip_CellData(e,l.endRow,l.startCol);if(null!=_.merge){var a=ip_CellData(e,_.merge.mergedWithRow,_.merge.mergedWithCol),s=a.merge.mergedWithRow,p=a.merge.mergedWithCol,d=a.merge.mergedWithRow+a.merge.rowSpan-1,c=a.merge.mergedWithCol+a.merge.colSpan-1;s<l.startRow&&(l.startRow=s),p<l.startCol&&(l.startCol=p),d>l.endRow&&(l.endRow=d),c>l.endCol&&(l.endCol=c)}}if(-1!=l.startRow&&-1!=l.startCol){var u=ip_CellData(e,l.startRow,l.startCol);if(null!=u.merge){var a=ip_CellData(e,u.merge.mergedWithRow,u.merge.mergedWithCol),s=a.merge.mergedWithRow,p=a.merge.mergedWithCol,d=a.merge.mergedWithRow+a.merge.rowSpan-1,c=a.merge.mergedWithCol+a.merge.colSpan-1;s<l.startRow&&(l.startRow=s),p<l.startCol&&(l.startCol=p),d>l.endRow&&(l.endRow=d),c>l.endCol&&(l.endCol=c),l.startMerge=!0}}var g=ip_CellData(e,l.endRow,l.endCol);if(null!=g.merge){var a=ip_CellData(e,g.merge.mergedWithRow,g.merge.mergedWithCol),s=a.merge.mergedWithRow,p=a.merge.mergedWithCol,d=a.merge.mergedWithRow+a.merge.rowSpan-1,c=a.merge.mergedWithCol+a.merge.colSpan-1;s<l.startRow&&(l.startRow=s),p<l.startCol&&(l.startCol=p),d>l.endRow&&(l.endRow=d),c>l.endCol&&(l.endCol=c),l.endMerge=!0}return l.startRow=ip_NextNonHiddenRow(e,l.startRow,l.endRow,l.startRow,"down"),l.startCol=ip_NextNonHiddenCol(e,l.startCol,l.endCol,l.startCol,"right"),l}function ip_ValidateRangeMergedCells(e,o,i,t,l){var n={containsOverlap:!1,merges:[],containsUnmergedCells:!1,mergesIdentical:!0},a=[];for(0>o&&(o=0),0>i&&(i=0),t<ip_GridProps[e].rows||(t=ip_GridProps[e].rows-1),l<ip_GridProps[e].cols||(t=ip_GridProps[e].cols-1),r=o;t>=r;r++)if(null!=ip_GridProps[e].rowData[r].containsMerges)for(c=i;l>=c;c++){var s=ip_CellData(e,r,c);if(null!=s.merge){var p=s.merge,d=p.mergedWithRow+"-"+p.mergedWithCol;if(null==a[d]){var _=ip_mergeObject(),u=ip_DoesRangeOverlapMerge(e,p,o,i,t,l);_.containsOverlap=u,_.mergedWithRow=p.mergedWithRow,_.mergedWithCol=p.mergedWithCol,_.rowSpan=ip_GridProps[e].rowData[p.mergedWithRow].cells[p.mergedWithCol].merge.rowSpan,_.colSpan=ip_GridProps[e].rowData[p.mergedWithRow].cells[p.mergedWithCol].merge.colSpan,n.merges[n.merges.length]=_,1==u&&(n.containsOverlap=!0)}a[d]=!0}}for(var g=-1,w=-1,f=0,h=(t-o+1)*(l-i+1),m=0;m<n.merges.length;m++)g!=n.merges[m].rowSpan&&-1!=g?n.mergesIdentical=!1:w!=n.merges[m].colSpan&&-1!=w&&(n.mergesIdentical=!1),f+=n.merges[m].rowSpan*n.merges[m].colSpan,-1==g&&(g=n.merges[m].rowSpan),-1==w&&(w=n.merges[m].colSpan);return h>f&&(n.containsUnmergedCells=!0),n}function ip_ReshuffelMergesCol(e,r,o,i,t){var l=[],n=1;if(null!=r&&null!=o&&null!=i){if(i>0){var a=r;r=o,o=a,n=-1}for(var s=r;0>n?s>=o:o>=s;s+=n)if(null!=ip_GridProps[e].colData[s].containsMerges){for(var p=ip_GridProps[e].colData[s].containsMerges,d=0;d<p.length;d++){var c=p[d].mergedWithRow,_=p[d].mergedWithCol,u=c+p[d].rowSpan-1,g=_+p[d].colSpan-1,w=c+"-"+_;if(null==l[w]&&(_>=r&&n>0||_>=o&&0>n)){for(var f=c;u>=f;f++)for(var h=_;g>=h;h++)null!=ip_GridProps[e].rowData[f].cells[h].merge&&(ip_GridProps[e].rowData[f].cells[h].merge.mergedWithCol=_+i);ip_GridProps[e].colData[s].containsMerges[d].mergedWithCol=_+i,delete ip_GridProps[e].mergeData[w],w=c+"-"+(_+i),ip_GridProps[e].mergeData[w]=ip_GridProps[e].colData[s].containsMerges[d],l[w]=!0}}t&&(ip_GridProps[e].colData[s+i].containsMerges=ip_GridProps[e].colData[s].containsMerges,ip_GridProps[e].colData[s].containsMerges=null)}}}function ip_ReshuffelMergesRow(e,r,o,i,t){var l=[],n=1;if(null!=r&&null!=o&&null!=i){if(i>0){var a=r;r=o,o=a,n=-1}for(var s=r;0>n?s>=o:o>=s;s+=n)if(null!=ip_GridProps[e].rowData[s].containsMerges){for(var p=ip_GridProps[e].rowData[s].containsMerges,d=0;d<p.length;d++){var c=p[d].mergedWithRow,_=p[d].mergedWithCol,u=c+p[d].rowSpan-1,g=_+p[d].colSpan-1,w=c+"-"+_;if(null==l[w]&&(c>=r&&n>0||c>=o&&0>n)){for(var f=c;u>=f;f++)for(var h=_;g>=h;h++)ip_GridProps[e].rowData[f].cells[h].merge.mergedWithRow=c+i;ip_GridProps[e].rowData[s].containsMerges[d].mergedWithRow=c+i,delete ip_GridProps[e].mergeData[w],w=c+i+"-"+_,ip_GridProps[e].mergeData[w]=ip_GridProps[e].rowData[s].containsMerges[d],l[w]=!0}}t&&(ip_GridProps[e].rowData[s+i].containsMerges=ip_GridProps[e].rowData[s].containsMerges,ip_GridProps[e].rowData[s].containsMerges=null)}}}function ip_AddColumnToMerge(e,r,o){if(null!=r){var i=r.mergedWithRow,t=r.mergedWithCol,l=i+r.rowSpan-1,n=t+r.colSpan-1;n+=o,l<ip_GridProps[e].rows||(l=ip_GridProps[e].rows-1),n<ip_GridProps[e].cols||(n=ip_GridProps[e].cols-1),t>n||i==l&&t==n||ip_SetCellMerge(e,i,t,l,n)}}function ip_AddRowToMerge(e,r,o){if(null!=r){var i=r.mergedWithRow,t=r.mergedWithCol,l=i+r.rowSpan-1,n=t+r.colSpan-1;l+=o,l<ip_GridProps[e].rows||(l=ip_GridProps[e].rows-1),n<ip_GridProps[e].cols||(n=ip_GridProps[e].cols-1),i>l||i==l&&t==n||ip_SetCellMerge(e,i,t,l,n)}}function ip_GetColumnMerge(e,r){var o=ip_mergeObject();return r>-1&&ip_GridProps[e].rows>0&&null!=ip_GridProps[e].rowData[ip_GridProps[e].rows-1].cells[r].merge?(o=ip_GridProps[e].rowData[ip_GridProps[e].rows-1].cells[r].merge,ip_GridProps[e].rowData[ip_GridProps[e].rows-1].cells[o.mergedWithCol].merge):(o.mergedWithCol=r,o.colSpan=1,o.rowSpan=1,o)}function ip_GetRowMerge(e,r){var o=ip_mergeObject();return r>-1&&ip_GridProps[e].cols>0&&null!=ip_GridProps[e].rowData[r].cells[ip_GridProps[e].cols-1].merge?(o=ip_GridProps[e].rowData[r].cells[ip_GridProps[e].cols-1].merge,ip_GridProps[e].rowData[o.mergedWithRow].cells[ip_GridProps[e].cols-1].merge):(o.mergedWithRow=r,o.colSpan=1,o.rowSpan=1,o)}function ip_DoesRangeOverlapMerge(e,r,o,i,t,l){var n=!1;return r.mergedWithRow<o?n=!0:r.mergedWithRow+r.rowSpan-1>t?n=!0:r.mergedWithCol<i?n=!0:r.mergedWithCol+r.colSpan-1>l&&(n=!0),n}function ip_IsMergeInRange(e,r,o){for(var i=0;i<o.length;i++){if(r.mergedWithRow<o[i].startRow)return!1;if(r.mergedWithCol<o[i].startCol)return!1;if(r.mergedWithRow>o[i].endRow)return!1;if(r.mergedWithCol>o[i].endCol)return!1}return!0}function ip_MergedHeight(e,r,o){var i=ip_GridProps[e].rowData[r].cells[o].merge;if(i)for(var t=ip_GridProps[e].dimensions.defaultBorderHeight,l=ip_GridProps[e].dimensions.gridHeight,n=0,a=r+(ip_GridProps[e].loadedRows<i.rowSpan?ip_GridProps[e].loadedRows:i.rowSpan),s=r;a>s;s++)if(n+=ip_GridProps[e].rowData[s].height+t,n>=l)return n-t;return n-t}function ip_ReRender(e){ip_RecalculateLoadedRowsCols(e,!1,!0,!0),ip_ReRenderCols(e),ip_ShowColumnFrozenHandle(e,!0),ip_ShowRowFrozenHandle(e,!0)}function ip_ReRenderCell(e,r,o,i){$("#"+e+"_cell_"+r+"_"+o).replaceWith(ip_CreateGridQuadCell({GridID:e,row:r,col:o,Quad:ip_GetQuad(e,r,o)})),i&&$("#"+e).ip_SelectCell({raiseEvent:!1,unselect:!1})}function ip_ReRenderCells(e,r,o){for(var o=null==o?ip_LoadedRowsCols(e,!1):o,i=0;i<r.length;i++)for(var t=0;t<r[i].cells.length;t++){var l=r[i].cells[t].row,n=r[i].cells[t].col;ip_IsCellLoaded(e,l,n,o)&&ip_ReRenderCell(e,l,n)}}function ip_ReRenderRanges(e,r,o,i){for(var o=null==o?ip_LoadedRowsCols(e,!1):o,t=0;t<r.length;t++){var l=r[t],n={startRow:o.rowFrom_frozen,startCol:o.colFrom_frozen,endRow:o.rowTo_frozen,endCol:o.colTo_frozen};if(n=ip_TrimRange(e,n,l),null!=n)for(var a=n.startRow;a<=n.endRow;a++)for(var s=n.startCol;s<=n.endCol;s++){var p=a,d=s;ip_IsCellLoaded(e,p,d,o)&&ip_ReRenderCell(e,p,d)}var c={startRow:o.rowFrom_frozen,startCol:o.colFrom_scroll,endRow:o.rowTo_frozen,endCol:o.colTo_scroll};if(c=ip_TrimRange(e,c,l),null!=c)for(var a=c.startRow;a<=c.endRow;a++)for(var s=c.startCol;s<=c.endCol;s++){var p=a,d=s;ip_IsCellLoaded(e,p,d,o)&&ip_ReRenderCell(e,p,d)}var _={startRow:o.rowFrom_scroll,startCol:o.colFrom_frozen,endRow:o.rowTo_scroll,endCol:o.colTo_frozen};if(_=ip_TrimRange(e,_,l),null!=_)for(var a=_.startRow;a<=_.endRow;a++)for(var s=_.startCol;s<=_.endCol;s++){var p=a,d=s;ip_IsCellLoaded(e,p,d,o)&&ip_ReRenderCell(e,p,d)}var u={startRow:o.rowFrom_scroll,startCol:o.colFrom_scroll,endRow:o.rowTo_scroll,endCol:o.colTo_scroll};if(u=ip_TrimRange(e,u,l),null!=u)for(var a=u.startRow;a<=u.endRow;a++)for(var s=u.startCol;s<=u.endCol;s++){var p=a,d=s;ip_IsCellLoaded(e,p,d,o)&&ip_ReRenderCell(e,p,d)}}i&&ip_ReRenderCols(e,"header")}function ip_ReRenderCols(e,r){if(null==r&&(r="all"),"all"==r||"frozen"==r){$("#"+e+"_q1_table .ip_grid_columnSelectorCell").remove(),$("#"+e+"_q1_table .ip_grid_cell").remove(),$("#"+e+"_q3_table .ip_grid_columnSelectorCell").remove(),$("#"+e+"_q3_table .ip_grid_cell").remove();for(var o=0;o<ip_GridProps[e].frozenCols;o++)ip_AddCol(e,{col:o,appendTo:"end"});ip_ShowColumnFrozenHandle(e,!0)}("all"==r||"scroll"==r)&&(ip_AddCol(e,{col:ip_GridProps[e].scrollX,appendTo:"end",fullRerender:!0})||ip_GridProps[e].loadedCols--),"header"==r&&($("#"+e+"_q1_table .ip_grid_columnSelectorCell").each(function(){var r=parseInt($(this).attr("col"));this.outerHTML=ip_CreateGridQuadCell({GridID:e,id:e+"_q1",col:r,row:-1,cellType:"ColSelector",Quad:1,showColSelector:ip_GridProps[e].showColSelector})}),$("#"+e+"_q2_table .ip_grid_columnSelectorCell").each(function(){var r=parseInt($(this).attr("col"));this.outerHTML=ip_CreateGridQuadCell({GridID:e,id:e+"_q2",col:r,row:-1,cellType:"ColSelector",Quad:2,showColSelector:ip_GridProps[e].showColSelector})}))}function ip_ReRenderRows(e,r){if(null==r&&(r="all"),"all"==r||"frozen"==r){"ie"==thisBrowser.name&&thisBrowser.version<10?($("#"+e+"_q1_table tbody tr").remove(),$("#"+e+"_q2_table tbody tr").remove()):(document.getElementById(e+"_q1_table_tbody").innerHTML="",document.getElementById(e+"_q2_table_tbody").innerHTML="");for(var o=0;o<ip_GridProps[e].frozenRows;o++)ip_AddRow(e,{row:o,appendTo:"end"});ip_ShowRowFrozenHandle(e,!0)}("all"==r||"scroll"==r)&&(ip_AddRow(e,{row:ip_GridProps[e].scrollY,appendTo:"end",fullRerender:!0})||ip_GridProps[e].loadedRows--)}function ip_ReRenderValues(e,r,o,i,t,l){if(null!=r)for(var n=0;n<r.length;n++)for(var a=0;a<r[n].cells.length;a++){var s=r[n].cells[a].row,p=r[n].cells[a].col;$("#"+e+"_cell_"+s+"_"+p+" .ip_grid_cell_innerContent").html(ip_CellInner(e,s,p))}else{var d=ip_LoadedRowsCols(e,!0),c=-1,_=-1,u=-1,g=-1;o=null==o?d.rowFrom_frozen:o,t=null==t?d.rowTo_scroll:t,i=null==i?d.colFrom_frozen:i,l=null==l?d.rowTo_scroll:l,c=o<d.rowFrom_frozen?d.rowFrom_frozen:o,_=i<d.colFrom_frozen?d.colFrom_frozen:i,u=t>d.rowTo_frozen?d.rowTo_frozen:t,g=l>d.colTo_frozen?d.colTo_frozen:l;for(var s=c;u>=s;s++)for(var p=_;g>=p;p++)$("#"+e+"_cell_"+s+"_"+p+" .ip_grid_cell_innerContent").html(ip_CellInner(e,s,p));c=o<d.rowFrom_scroll?d.rowFrom_scroll:o,_=i<d.colFrom_frozen?d.colFrom_frozen:i,u=t>d.rowTo_scroll?d.rowTo_scroll:t,g=l>d.colTo_frozen?d.colTo_frozen:l;for(var s=c;u>=s;s++)for(var p=_;g>=p;p++)$("#"+e+"_cell_"+s+"_"+p+" .ip_grid_cell_innerContent").html(ip_CellInner(e,s,p));c=o<d.rowFrom_frozen?d.rowFrom_frozen:o,_=i<d.colFrom_scroll?d.colFrom_scroll:i,u=t>d.rowTo_frozen?d.rowTo_frozen:t,g=l>d.colTo_scroll?d.colTo_scroll:l;for(var s=c;u>=s;s++)for(var p=_;g>=p;p++)$("#"+e+"_cell_"+s+"_"+p+" .ip_grid_cell_innerContent").html(ip_CellInner(e,s,p));c=o<d.rowFrom_scroll?d.rowFrom_scroll:o,_=i<d.colFrom_scroll?d.colFrom_scroll:i,u=t>d.rowTo_scroll?d.rowTo_scroll:t,g=l>d.colTo_scroll?d.colTo_scroll:l;for(var s=c;u>=s;s++)for(var p=_;g>=p;p++)$("#"+e+"_cell_"+s+"_"+p+" .ip_grid_cell_innerContent").html(ip_CellInner(e,s,p))}}function ip_CopyToClipboard(){}function ip_KeyDownLoop(e,r,o,i,t){null==ip_GridProps[e].timeouts.keyDownTimeout&&(ip_GridProps[e].timeouts.keyDownTimeout=0);var l=(r.ctrlKey,r.shiftKey);if(37==r.keyCode||38==r.keyCode||39==r.keyCode||40==r.keyCode||34==r.keyCode||33==r.keyCode){var i=null==i?parseInt($(ip_GridProps[e].selectedCell).attr("row")):i,t=null==t?parseInt($(ip_GridProps[e].selectedCell).attr("col")):t,n=0,a=0,s=0,p="";37==r.keyCode?(a--,p="left"):38==r.keyCode?(n--,p="up"):39==r.keyCode?(a++,p="right"):40==r.keyCode?(n++,p="down"):34==r.keyCode?(n+=ip_GridProps[e].loadedRows-1,p="down"):33==r.keyCode&&(n-=ip_GridProps[e].loadedRows-1,p="up"),t+=a,i+=n,0!=a?s=a:0!=n&&(s=n),l?l&&ip_ChangeRange(e,ip_GridProps[e].selectedRange[ip_GridProps[e].selectedRangeIndex],null,0,n,a,!1,s):0>i||0>t||$("#"+e).ip_SelectCell({row:i,col:t,multiselect:!1,scrollIncrement:s,direction:p,raiseEvent:!1})}var d=0==o?250:o<ip_GridProps[e].loadedRows?10:0;ip_GridProps[e].timeouts.keyDownTimeout=setTimeout(function(){ip_KeyDownLoop(e,r,o+1,i,t)},d)}function ip_OptimzeLoadedRows(e){for(var r=ip_LoadedRowsCols(e,!1,!0,!1),o=r.rowTo_scroll+1;ip_GridProps[e].dimensions.accumulativeScrollHeight<ip_GridProps[e].dimensions.scrollHeight&&o<ip_GridProps[e].rows;)ip_GridProps[e].loadedRows++,ip_AddRow(e,{row:o,appendTo:"end"}),o++;for(var i=r.rowTo_scroll;ip_GridProps[e].dimensions.accumulativeScrollHeight-ip_RowHeight(e,i,!0)>ip_GridProps[e].dimensions.scrollHeight&&i>ip_GridProps[e].frozenRows;)ip_RemoveRow(e,{row:i}),ip_GridProps[e].loadedRows--,i--}function ip_OptimizeLoadedCols(e){for(var r=ip_LoadedRowsCols(e,!1,!1,!0),o=r.colTo_scroll+1;ip_GridProps[e].dimensions.accumulativeScrollWidth<ip_GridProps[e].dimensions.scrollWidth&&o<ip_GridProps[e].cols;)ip_GridProps[e].loadedCols++,ip_AddCol(e,{col:o,appendTo:"end"}),o++;for(var i=r.colTo_scroll;ip_GridProps[e].dimensions.accumulativeScrollWidth-ip_ColWidth(e,i,!0)>ip_GridProps[e].dimensions.scrollWidth&&i>ip_GridProps[e].frozenCols;)ip_RemoveCol(e,{col:i}),ip_GridProps[e].loadedCols--,i--}function ip_CellDataType(e,r,o,i,t,l){var n=l,a=ip_GetMaskObj(e,r,o,i),s=ip_GetEnabledDecimals(e,null,r,o,!0),p={output:function(){return""+this.value},mask:null,dataType:ip_dataTypeObject("default"),display:null,value:null,valid:!1,expectedDataType:ip_dataTypeObject("default"),decimals:s};if(0>r)return p.expectedDataType.dataType=ip_GridProps[e].colData[o].dataType.dataType,p.expectedDataType.dataTypeName=ip_GridProps[e].colData[o].dataType.dataTypeName,p.dataType.dataType=ip_GridProps[e].colData[o].dataType.dataType,p.dataType.dataTypeName=ip_GridProps[e].colData[o].dataType.dataTypeName,p;var d=ip_CellData(e,r,o);if(p.display=d.display,p.value=null!=t?t:d.value,null!=a){p.mask=a;try{var c=a.input(p.value);p.value=isNaN(c)?p.value:c,p.output=function(){return this.mask.output(t,n,s)}}catch(_){p.value=t?t:d.value}}return null!=d?(null!=d.dataType.dataType&&(p.expectedDataType.dataType=d.dataType.dataType?d.dataType.dataType.toLowerCase():"default",p.expectedDataType.dataTypeName=d.dataType.dataTypeName?d.dataType.dataTypeName.toLowerCase():null,p.dataType.dataTypeName=p.expectedDataType.dataTypeName),i&&"default"==p.expectedDataType.dataType.toLowerCase()&&null!=ip_GridProps[e].colData[o].dataType.dataType&&(p.expectedDataType.dataType=ip_GridProps[e].colData[o].dataType.dataType?ip_GridProps[e].colData[o].dataType.dataType.toLowerCase():"default",p.expectedDataType.dataTypeName=ip_GridProps[e].colData[o].dataType.dataTypeName?ip_GridProps[e].colData[o].dataType.dataTypeName.toLowerCase():null),(null==p.value||"default"!=p.expectedDataType.dataType)&&"number"!=p.expectedDataType.dataType||isNaN(ip_parseNumber(p.value))?(null==p.value||"default"!=p.expectedDataType.dataType)&&"date"!=p.expectedDataType.dataType||isNaN(ip_parseDate(p.value))?(null==p.value||"default"!=p.expectedDataType.dataType)&&"currency"!=p.expectedDataType.dataType||isNaN(ip_parseCurrency(p.value))?"text"==p.expectedDataType.dataType?(p.dataType.dataType="text",p.value=ip_parseString(p.value),p.valid=!0):"default"==p.expectedDataType.dataType?null==p.value?(p.dataType.dataType="text",p.value="",p.valid=!0):(p.value=ip_parseAny(e,p.value),p.dataType.dataType=typeof p.value,"string"==p.dataType.dataType?p.dataType.dataType="text":"object"==p.dataType.dataType&&"function"==typeof p.value.getMonth&&(p.dataType.dataType="date"),p.valid=!0):p.dataType.dataTypeName=null:(p.dataType.dataType="currency",p.value=ip_parseCurrency(p.value),a||(p.output=function(){return null==this.decimals?this.value:this.value.toFixed(this.decimals)}),p.valid=!0):(p.dataType.dataType="date",p.value=ip_parseDate(p.value),p.valid=!0):(p.dataType.dataType="number",p.value=ip_parseNumber(p.value),a||(p.output=function(){return null==this.decimals?this.value:this.value.toFixed(this.decimals)}),p.valid=!0),"default"==p.dataType.dataType&&(p.dataType.dataType=""),null==p.dataType.dataTypeName&&(p.dataType.dataTypeName=p.dataType.dataType),"default"==p.expectedDataType.dataType&&(p.expectedDataType.dataType=""),null==p.expectedDataType.dataTypeName&&(p.expectedDataType.dataTypeName=p.expectedDataType.dataType),p):null}function ip_CellStyle(e,r,o){return(null==ip_GridProps[e].colData[o].style?"":ip_GridProps[e].colData[o].style)+(null==ip_GridProps[e].rowData[r].cells[o].style?"":ip_GridProps[e].rowData[r].cells[o].style)}function ip_CellData(e,r,o,i){if(ip_GridProps[e].rowData.length>r&&r>=0&&ip_GridProps[e].rowData[r].cells.length>o&&o>=0){var t=ip_GridProps[e].rowData[r].cells[o],l=ip_GridProps[e].colData[o];if(i){var n=ip_GridProps[e].rowData[r].groupCount,a=ip_GridProps[e].rowData[r].loading,s=ip_GridProps[e].rowData[r].cells[o].error&&ip_GridProps[e].rowData[r].cells[o].error.errorCode?" ip_grid_cell_error":"",p=ip_GridProps[e].rowData[r].hide?" ip_grid_cell_hideRow":"",d=ip_GridProps[e].colData[o].hide?" ip_grid_cell_hideCol":"",c=n>0?" ip_grid_rowGroup":"",_=a?" ip_grid_cell_loading":"",u="",g=(null==l.border?"":l.border)+(null==t.border?"":t.border),w="",f="",h=null,m="";return null!=t.merge&&(u=" ip_grid_MergedCell",(t.merge.mergedWithRow!=r||t.merge.mergedWithCol!=o)&&(h=ip_CellData(e,t.merge.mergedWithRow,t.merge.mergedWithCol)),t.merge.mergedWithRow==r&&t.merge.mergedWithCol==o?u="":o==ip_GridProps[e].scrollX&&r==t.merge.mergedWithRow?u="":r==ip_GridProps[e].scrollY&&o==t.merge.mergedWithCol?u="":o==ip_NextNonHiddenCol(e,t.merge.mergedWithCol,o+t.merge.colSpan-1,o,"right",!0)&&r==ip_NextNonHiddenRow(e,t.merge.mergedWithRow,r+t.merge.rowSpan-1,r,"down",!0)&&(u=""),w=""==u?ip_CalculateHiddenRowSpan(e,r,r+t.merge.rowSpan-1):t.merge.rowSpan,f=""==u?ip_CalculateHiddenColSpan(e,o,o+t.merge.colSpan-1):t.merge.colSpan,w='rowspan="'+w+'"',f='colspan="'+f+'"',null!=h&&(t=h),""!=g&&(m="ie"==ip_GridProps.index.browser.name?"height:"+ip_MergedHeight(e,r,o)+"px;":"height:100%;")),{cell:t,isLoading:a,iconDD:"dropdown"==ip_GetEnabledControlType(e,null,r,o,!0)?'<div class="ip_grid_cell_dropdownIconContainer"><div class="ip_grid_cell_dropdownIcon"></div></div>':"",iconGP:n>0&&ip_GridProps[e].rowData[r].groupColumn==o?'<div class="ip_grid_cell_groupIcon '+(ip_GridProps[e].rowData[r+1].hide?"collapsed":"expanded")+'">'+(ip_GridProps[e].rowData[r+1].hide?"+":"-")+"</div>":"",css:u+_+p+c+d+s,style:ip_CellStyle(e,r,o)+m,rowSpan:w,colSpan:f,border:g}}return t}}function ip_CellInput(e,r){var r=$.extend({range:null,row:null,col:null,valueRAW:null,value:null,formula:null,formulaObj:null,validation:null,controlType:null,hashTags:null,style:null,dataType:null,raiseEvent:!0,render:!0},r),o=ip_GenerateTransactionID(),i={cell:null,rowData:[],PropertyAppendModes:""},t=null,l=null,n=null,a=0;null==r.range?r.range=[ip_rangeObject(r.row,r.col,r.row,r.col)]:r.range.length||(r.range=[r.range]);for(var s=0;s<r.range.length;s++)for(var p=ip_AddUndo(e,"ip_CellInput",o,"CellData",r.range[s],r.range[s],0==s?{row:r.range[s].startRow,col:r.range[s].startCol}:null),d=r.range[s].startRow;d<=r.range[s].endRow;d++)for(var c=r.range[s].startCol;c<=r.range[s].endCol;c++){l=d,n=c;var _=ip_ValidateCellValue(e,null!=r.valueRAW?ip_fxValue(e,r.valueRAW,l,n):{error:null,value:r.value,formula:r.formula},l,n,!0);_.reject?ip_TextEditbleCancel(e):(ip_AddUndoTransactionData(e,p,ip_CloneCell(e,d,c)),ip_GridProps[e].rowData[l].cells[n].error=_.error&&"allow"!=_.validation.validationAction?_.error:ip_errorObject("",""),ip_SetValue(e,l,n,_.value,void 0,void 0,_.dataType.decimals),ip_SetCellFormula(e,{row:l,col:n,formula:_.formula,formulaObj:r.formulaObj}),ip_SetCellControlType(e,l,n),ip_SetCellFormat(e,{row:l,col:n,validation:r.validation,dataType:r.dataType,style:r.style,hashTags:r.hashTags,raiseEvent:!1,render:!1,transactionID:o}),null==i.rowData[a]&&(i.rowData[a]={cells:[]}),i.rowData[a].cells[i.rowData[a].cells.length]=ip_CloneCell(e,l,n),i.rowData[a].cells.length==ip_GridProps[e].cols&&a++)}t=ip_ReCalculateFormulas(e,{recalcSource:!1,render:!1,raiseEvent:!1,transactionID:o,range:r.range}).Effected,i.rowData=i.rowData.concat(t.rowData),(r.raiseEvent||r.render)&&(1!=i.rowData.length||1!=i.rowData[0].cells.length||null!=t&&0!=t.rowData.length?i.rowData.length>0&&(r.render&&ip_ReRenderCells(e,i.rowData),r.raiseEvent&&ip_RaiseEvent(e,"ip_SetCellValues",o,{SetCellValues:{Inputs:{range:i.range},Effected:i}})):(i.cell=ip_GridProps[e].rowData[l].cells[n],i.cell.row=l,i.cell.col=n,r.render&&ip_ReRenderCell(e,l,n),r.raiseEvent&&ip_RaiseEvent(e,"ip_CellInput",o,{SetCellValue:{Inputs:r,Effected:i}})))}function ip_SetValue(e,r,o,i,t){var l=ip_GridProps[e].rowData[r].cells[o].value;if(l!=i){if(void 0===i&&(i=ip_GridProps[e].rowData[r].cells[o].value),null==i)ip_GridProps[e].rowData[r].cells[o].value=null,ip_GridProps[e].rowData[r].cells[o].display="";else{var n=ip_GridProps[e].rowData[r].cells[o].error,a={},s="";null==n||n&&""==n.errorCode?(a=ip_CellDataType(e,r,o,!0,i,t),s=a.valid?a.output():i):(a.value=i,s=i),ip_GridProps[e].rowData[r].cells[o].value=a.value,ip_GridProps[e].rowData[r].cells[o].display=s}return!0}return!1}function ip_SetCellFormat(e,r){var r=$.extend({transactionID:ip_GenerateTransactionID(),range:null,row:null,col:null,dataType:null,style:null,border:null,validation:null,PropertyAppendModes:"style:append;cell:auto",controlType:null,hashTags:null,mask:null,decimals:null,decimalsInc:null,fxCallerName:null,recalculate:!1,raiseEvent:!0,render:!0,createUndo:!0},r);if(null!=r.dataType||null!=r.style||null!=r.validation||null!=r.controlType||null!=r.hashTags||null!=r.mask||null!=r.decimals||null!=r.decimalsInc){var o=r.transactionID,i="",t=null,l=ip_formatObject();if(null==r.range&&null!=r.row&&null!=r.col&&(r.range=[ip_rangeObject(r.row,r.col,-1==r.row?ip_GridProps[e].rows-1:r.row,r.col)]),null==r.range&&0==ip_GridProps[e].selectedRange.length)i="Please specify a range";else if(null==r.range){r.range=[];for(var n=0;n<ip_GridProps[e].selectedRange.length;n++)r.range[n]=ip_rangeObject(ip_GridProps[e].selectedRange[n][0][0],ip_GridProps[e].selectedRange[n][0][1],ip_GridProps[e].selectedRange[n][1][0],ip_GridProps[e].selectedRange[n][1][1],null,r.col)}if(null!=r.range&&""==i){t={range:[],rowData:[],cellFormat:{style:r.style,dataType:r.dataType,validation:r.validation,controlType:r.controlType,hashTags:r.hashTags,mask:r.mask,decimals:r.decimals,decimalsInc:r.decimalsInc}};for(var n=0;n<r.range.length;n++){r.range[n].PropertyAppendModes=r.PropertyAppendModes;var a=r.range[n].startRow,s=r.range[n].startRow,p=r.range[n].startCol,d=r.range[n].endRow,c=r.range[n].endCol;0>s&&(s=0),0>p&&(p=0),d<ip_GridProps[e].rows||(s=ip_GridProps[e].rows-1),p<ip_GridProps[e].cols||(p=ip_GridProps[e].cols-1);var _={startRow:s,startCol:p,endRow:d,endCol:c};if(r.createUndo)var u=ip_AddUndo(e,"ip_FormatCell",o,"CellData",_,_,{row:_.startRow,col:_.startCol});-1==r.range[n].PropertyAppendModes.indexOf("cell:auto")||a>0||d!=ip_GridProps[e].rows-1||(r.range[n].PropertyAppendModes=r.range[n].PropertyAppendModes.replace("cell:auto","cell:colnotnull"));var g={colnotnull:-1!=r.range[n].PropertyAppendModes.indexOf("cell:colnotnull")?!0:!1,cellnotnull:-1!=r.range[n].PropertyAppendModes.indexOf("cell:notnull")?!0:!1,stylappend:-1!=r.range[n].PropertyAppendModes.indexOf("style:append")?!0:!1};if(g.colnotnull&&""==i){for(var w=[],f={},h=r.range[n].startCol;h<=r.range[n].endCol;h++)w[w.length]=h,f[h]=ip_GridProps[e].colData[h].mask;var m=$.extend(m,r);m.columns=w,m.raiseEvent=!1,m.render=!1,m.createUndo=r.createUndo,m.transactionID=o,l=ip_SetColumnFormat(e,m)}for(var v=!1,C=s;d>=C;C++)for(var h=p;c>=h;h++)if((g.cellnotnull||g.colnotnull)&&!ip_isCellEmpty(e,C,h)||!g.cellnotnull&&!g.colnotnull){var R=ip_GridProps[e].rowData[C].cells[h],G=void 0,P=!1,y=!1;if(r.createUndo&&ip_AddUndoTransactionData(e,u,ip_CloneCell(e,C,h)),null!=r.style&&(R.style=""==r.style?null:g.stylappend?ip_AppendCssStyle(e,ip_GridProps[e].rowData[C].cells[h].style,r.style):r.style),null!=r.controlType&&(R.controlType=""==r.controlType||g.colnotnull?null:r.controlType),null!=r.hashTags&&(R.hashTags=""==r.hashTags||g.colnotnull?null:r.hashTags),null!=r.border&&(R.border=""==r.border||g.colnotnull?null:r.border),null!=r.validation&&(null!=r.validation.validationCriteria&&(R.validation.validationCriteria=""==r.validation.validationCriteria||g.colnotnull?null:r.validation.validationCriteria,y=!0),null!=r.validation.validationAction&&(R.validation.validationAction=""==r.validation.validationAction||g.colnotnull?null:r.validation.validationAction,y=!0)),null!=r.dataType&&(R.dataType.dataType=""==r.dataType.dataType||g.colnotnull?null:r.dataType.dataType,R.dataType.dataTypeName=""==r.dataType.dataTypeName||g.colnotnull?null:r.dataType.dataTypeName,v||(r.mask=ip_DefaultMask(e,r.dataType,r.mask?r.mask:R.mask),r.mask=null==r.mask?"":r.mask,t.cellFormat.mask=r.mask,v=!0)),null!=r.mask&&(G=null==R.mask&&void 0!=f&&null!=f[h]?f[h]:ip_GetEnabledMask(e,null,C,h,!0),ip_GridProps[e].rowData[C].cells[h].mask=g.colnotnull?null:r.mask,P=!0),null!=r.decimalsInc){var D=R.decimals;null!=D||g.colnotnull||(D=ip_GetEnabledDecimals(e,null,C,h,!0),null==D&&(D=0)),null!=D&&(R.decimals=D+r.decimalsInc)}if(null!=r.decimals&&(R.decimals=g.colnotnull?null:r.decimals),R.decimals<0&&(R.decimals=null),(r.decimals||r.decimalsInc)&&(P=!0),y){var T=ip_ValidateCellValue(e,null,C,h,!1).error;ip_CompareError(e,T,R.error)||(R.error=T,null==T&&(T=ip_errorObject("","")),ip_AppendEffectedRowData(e,t,{row:C,col:h,error:T}))}P&&ip_SetValue(e,C,h,void 0,G),l=ip_GetEnabledFormats(e,l,C,h)}ip_AddDataTypeToIndex(e,r.dataType),_.PropertyAppendModes=r.range[n].PropertyAppendModes,t.range[t.range.length]=_}r.recalculate&&(t.rowData=t.rowData.concat(ip_ReCalculateFormulas(e,{range:r.range,transactionID:o,render:!0,raiseEvent:!1}).Effected.rowData))}return""==i?(r.render&&ip_ReRenderRanges(e,r.range,null,g.colnotnull),r.raiseEvent&&t.range.length>0&&ip_RaiseEvent(e,"ip_FormatCell",o,{CellFormat:{Inputs:r,Effected:t}}),l):(ip_RaiseEvent(e,"warning",o,i),null)}}function ip_SetCellFormula(e,r){var r=$.extend({row:null,col:null,formula:null,isRowColShuffel:!1},r);if(null!=r.row&&null!=r.col){{var o=r.row,i=r.col,t=r.fx;r.transactionID}if(ip_RemoveCellFormulaIndex(e,{row:o,col:i,clearFormula:!0}),t=null==t&&"string"==typeof r.formula?ip_fxObject(e,r.formula,o,i):r.formula){var l=(ip_GridProps[e].rowData[r.row].cells[r.col],ip_GenerateTransactionID());
    ip_GridProps[e].indexedData.formulaData[l]=t,ip_GridProps[e].rowData[r.row].cells[r.col].fxIndex=l,ip_GridProps[e].rowData[r.row].cells[r.col].formula=t.formula;for(key in t.ranges)for(var n=t.ranges[key].range,a=n.startRow;a<=n.endRow;a++)for(var s=n.startCol;s<=n.endCol;s++)(a!=o||s!=i||r.isRowColShuffel)&&(null==ip_GridProps[e].indexedData.cellIndex[a+"-"+s]&&(ip_GridProps[e].indexedData.cellIndex[a+"-"+s]={}),null==ip_GridProps[e].indexedData.cellIndex[a+"-"+s].fxIndexLnk&&(ip_GridProps[e].indexedData.cellIndex[a+"-"+s].fxIndexLnk={}),ip_GridProps[e].indexedData.cellIndex[a+"-"+s].fxIndexLnk[l]=!0)}return t}return null}function ip_SetCellControlType(e,r,o){if(null!=e&&null!=r&&null!=o){var i=ip_GridProps[e].rowData[r].cells[o].fxIndex,t=ip_GetCellControlType(e,null,i,r,o);t&&(ip_GridProps[e].rowData[r].cells[o].validation.validationCriteria=t.validation.validationCriteria,ip_GridProps[e].rowData[r].cells[o].formula=t.formula,ip_GridProps[e].rowData[r].cells[o].controlType=t.controlType)}}function ip_GetCellControlType(e,r,o,i,t){if(null==e||null==r&&null==o){if(e)var l={controlType:null,formula:r,validation:ip_validationObject()}}else{var n=o?ip_GridProps[e].indexedData.formulaData[o]:ip_fxObject(e,r,i,t);if(n){n.functions||(n.functions=[""]),"=()"==n.formula&&(n.formula=n.formula.replace("=()",""));var l={controlType:null,formula:r,validation:ip_validationObject()};switch(n.functions[0].toLowerCase()){case"gantt":return l.controlType="gantt",l.validation.validationCriteria=n.inputs?n.formula:null,l;case"dropdown":return l.validation.validationCriteria=n.inputs?n.formula:null,l.formula=null,l.controlType="dropdown",l;case"text":return l.controlType="text",l.validation.validationCriteria=n.inputs?n.formula:null,l;default:return l.controlType="",l.formula=n.formula,l.validation.validationCriteria="",l}}}}function ip_ValidateCellValue(e,r,o,i,t){var l=ip_GridProps[e].rowData[o].cells[i];if(null==r&&(r={reject:!1,Error:null,value:l.value,formula:l.formula}),r.reject=!1,!r.Error){if(r.validation=ip_GetEnabledValidation(e,null,o,i,!0),r.dataType=ip_CellDataType(e,o,i,!0,r.value),r.dataType.valid){if(r.validation.validationAction&&"allow"!=r.validation.validationAction&&r.validation.inputs){for(var n=!1,a=0;a<r.validation.inputs.length;a++){var s=ip_fxRangeObject(e,null,null,r.validation.inputs[a]);if(s)for(var p=s.startRow;p<=s.endRow;p++)for(var d=s.startCol;d<=s.endCol;d++){var c=ip_CellData(e,p,d);if(c&&c.value&&c.value.match("\\b"+r.value+"\\b","gi")){n=!0;break}}else if(r.validation.inputs[a].match("\\b"+r.value+"\\b","gi")){n=!0;break}}if(!n){var _=r.validation.inputs.join();r.error=ip_errorObject("03",'"'+r.value+'" is an invalid cell value, try one of these: '+(_.length>40?_.substr(0,40)+" ...":_))}}}else r.error=ip_errorObject("02",'Value should be a "'+r.dataType.expectedDataType.dataTypeName+'"'+(r.dataType.mask?", in the format "+r.dataType.mask.mask:""))}return r.error&&r.error.errorDescription&&t&&(ip_ShowFooterAlert("You have entered an invalid cell value",r.error.errorDescription+".",null,"allow"==r.validation.validationAction?"green":"red"),"prevent"==r.validation.validationAction&&(r.reject=!0)),r}function ip_RemoveCellFormulaIndex(e,r){var r=$.extend({row:null,col:null,fxIndex:null,clearFormula:!1},r),o=r.fxIndex?r.fxIndex:ip_GridProps[e].rowData[r.row].cells[r.col].fxIndex,i=ip_GridProps[e].indexedData.formulaData[o];if(null!=i){for(key in i.ranges)for(var t=i.ranges[key].range,l=t.startRow;l<=t.endRow;l++)for(var n=t.startCol;n<=t.endCol;n++)null!=ip_GridProps[e].indexedData.cellIndex[l+"-"+n]&&null!=ip_GridProps[e].indexedData.cellIndex[l+"-"+n].fxIndexLnk[o]&&delete ip_GridProps[e].indexedData.cellIndex[l+"-"+n].fxIndexLnk[o];r.clearFormula&&(ip_GridProps[e].rowData[i.row].cells[i.col].formula=""),ip_GridProps[e].rowData[i.row].cells[i.col].fxIndex=null,delete ip_GridProps[e].indexedData.formulaData[o]}}function ip_ReCalculateFormulas(e,r){var r=$.extend({range:null,level:0,transactionID:null,render:!0,raiseEvent:!0,createUndo:!0,undoMode:null,recalcSource:!0,cellUndoData:null},r),o={rowData:[],range:r.range},i={};if(null!=r.range&&r.range.length>0){var t=r.transactionID,l=!1,n=r.cellUndoData;null==t&&(t=ip_GenerateTransactionID());for(var a=0;a<r.range.length;a++){var s=r.range[a];null==s.endRow&&(s.endRow=s.startRow),null==s.endCol&&(s.endCol=s.startCol);var p=ip_FormulasInRange(e,s,r.recalcSource,!0);for(var d in p){null==t&&(t=ip_GenerateTransactionID());var c=ip_GridProps[e].indexedData.formulaData[d],_=c.row,u=c.col,g=d,w=null;if(100==r.level)return ip_SetValue(e,_,u,"#ERROR"),ip_GridProps[e].rowData[_].cells[u].error=ip_errorObject("2","Circular dependancy detected"),{Effected:o,fxDone:i};if(null==i[g]){i[g]={row:_,col:u,valChange:!1},l&&(rIndex++,l=!1),r.createUndo&&("server"!=r.undoMode?(null==n&&(n=ip_AddUndo(e,"ip_ReCalculateFormulas",t,"CellData",{startRow:_,startCol:u,endRow:_,endCol:u})),ip_AddUndoTransactionData(e,n,ip_CloneCell(e,_,u))):null==n&&(n=ip_AddUndo(e,"ip_ReCalculateFormulas",t,"undoServer",r.range[a],r.range[a],{row:r.range[a].startRow,col:r.range[a].startCol})));var f=ip_CloneCell(e,_,u),h=ip_fxValue(e,c.formula,_,u);if(ip_SetValue(e,_,u,h.value),ip_GridProps[e].rowData[_].cells[u].error=h.error?h.error:ip_errorObject("",""),ip_CompareCell(e,f,ip_GridProps[e].rowData[_].cells[u])||(i[g].valChange=!0),!h.error&&null!=ip_GridProps[e].indexedData.cellIndex[_+"-"+u]&&null!=ip_GridProps[e].indexedData.cellIndex[_+"-"+u].fxIndexLnk){{var m=ip_GridProps[e].indexedData.cellIndex[_+"-"+u];ip_GridProps[e].indexedData.formulaData[m]}w=ip_ReCalculateFormulas(e,{cellUndoData:n,recalcSource:!1,createUndo:r.createUndo,level:r.level+1,transactionID:t,range:[{startRow:_,startCol:u}]}),i=$.extend(i,w.fxDone)}}}}if(0==r.level){for(var v in i)i[v].valChange&&ip_AppendEffectedRowData(e,o,{row:i[v].row,col:i[v].col,error:ip_GridProps[e].rowData[i[v].row].cells[i[v].col].error,value:ip_GridProps[e].rowData[i[v].row].cells[i[v].col].value,formula:ip_GridProps[e].rowData[i[v].row].cells[i[v].col].formula});o.rowData.length>0&&r.render&&ip_ReRenderCells(e,o.rowData),o.rowData.length>0&&r.raiseEvent&&ip_RaiseEvent(e,"ip_SetCellValues",t,{SetCellValues:{Inputs:null,Effected:{rowData:o.rowData}}})}}return{Effected:o,fxDone:i}}function ip_ChangeFormulaOrigin(e,r){var o,r=$.extend({fxIndex:null,range:null,rowDiff:0,colDiff:0,fromRow:null,fromCol:null,toRow:null,toCol:null,changeFormula:!1},r),i=null,t=null,l=null;if(2==r.fromRow,null!=r.fxIndex&&null!=ip_GridProps[e].indexedData.formulaData[r.fxIndex]?i=r.fxIndex:null!=r.fromRow&&null!=r.fromCol&&null!=ip_GridProps[e].rowData[r.fromRow].cells[r.fromCol].fxIndex?i=ip_GridProps[e].rowData[r.fromRow].cells[r.fromCol].fxIndex:null!=r.toRow&&null!=r.toCol&&null!=ip_GridProps[e].rowData[r.toRow].cells[r.toCol].fxIndex?i=ip_GridProps[e].rowData[r.toRow].cells[r.toCol].fxIndex:null==r.range||0==r.rowDiff&&0==r.colDiff||(t=ip_FormulasInRange(e,r.range,!0,!1)),null!=i){var n=ip_GridProps[e].indexedData.formulaData[i];null==r.toRow&&(r.toRow=n.row),null==r.toCol&&(r.toCol=n.col),o=n.row,l=n.col,n.row=r.toRow,n.col=r.toCol,r.changeFormula&&ip_SetCellFormula(e,{row:n.row,col:n.col,formula:ip_MoveFormulaOrigon(e,ip_GridProps[e].rowData[o].cells[l].formula,o,l,n.row,n.col)}),t={},t[i]=!0}else if(null!=t)for(var a in t)n=ip_GridProps[e].indexedData.formulaData[a],o=n.row,l=n.col,n.row+=r.rowDiff,n.col+=r.colDiff,r.changeFormula&&ip_SetCellFormula(e,{row:n.row,col:n.col,formula:ip_MoveFormulaOrigon(e,ip_GridProps[e].rowData[o].cells[l].formula,o,l,n.row,n.col)});return t}function ip_MoveFormulaOrigon(e,r,o,i,t,l,n,a,s,p,d,c){if(null!=r&&null!=o&&null!=i&&null!=t&&null!=l){var _=t-o,u=l-i;r=r.replace(ip_GridProps.index.regEx.range,function(r){var o=ip_fxRangeObject(e,null,null,r);if(null!=o){if(n&&ip_IsRangeOverLap(e,n,o))return r;var i=a?ip_IsRangeOverLap(e,a,o):!1;if(null!=a&&!i)return r;var t=c?ip_IsRangeOverLap(e,o,c):!1;return null!=c&&"exact"!=t&&"inside"!=t?r:(null!=d&&ip_IsRangeOverLap(e,d,o)?(o.startRowLock||(o.startRow+=s),o.startColLock||(o.startCol+=p),o.endRowLock||(o.endRow+=s),o.endColLock||(o.endCol+=p)):(o.startRowLock||(o.startRow+=_),o.startColLock||(o.startCol+=u),o.endRowLock||(o.endRow+=_),o.endColLock||(o.endCol+=u)),ip_fxRangeToString(e,o))}})}return r}function ip_ChangeFormulasForCellMove(e,r,o,i,t,l,n){var a={rowData:[]};if(null!=e&&(null!=o||null!=i||null!=t||null!=l)){var s=ip_FormulasInRange(e,ip_rangeObject(o,i,o,i),!0,!0);for(var p in s){var d=ip_GridProps[e].indexedData.formulaData[p],c=d.formula,_=ip_MoveFormulaOrigon(e,d.formula,o,i,t,l,null,null,null,null,null,n);c!=_&&(ip_AddUndoTransactionData(e,r,ip_CloneCell(e,d.row,d.col)),ip_SetCellFormula(e,{row:d.row,col:d.col,formula:_}),ip_AppendEffectedRowData(e,a,{row:d.row,col:d.col,formula:_}))}return a}}function ip_FormulasInRange(e,r,o,i){var t={};if(null!=r){r=ip_ValidateRangeObject(e,r);var l=(r.endRow-r.startRow+1)*(r.endCol-r.startCol+1);if(l<Object.keys(ip_GridProps[e].indexedData.formulaData).length)for(var n=r.startRow;n<=r.endRow;n++)for(var a=r.startCol;a<=r.endCol;a++)o&&null!=ip_GridProps[e].rowData[n].cells[a].fxIndex?t[ip_GridProps[e].rowData[n].cells[a].fxIndex]=!0:i&&null!=ip_GridProps[e].indexedData.cellIndex[n+"-"+a]&&null!=ip_GridProps[e].indexedData.cellIndex[n+"-"+a].fxIndexLnk&&(t=$.extend(t,ip_GridProps[e].indexedData.cellIndex[n+"-"+a].fxIndexLnk));else for(var s in ip_GridProps[e].indexedData.formulaData){var p=ip_GridProps[e].indexedData.formulaData[s];if(!o||p.row<r.startRow||p.row>r.endRow||p.col<r.startCol||p.col>r.endCol){if(i)for(rangeKey in p.ranges)ip_IsRangeOverLap(e,p.ranges[rangeKey].range,r)&&(t[s]=!0)}else t[s]=!0}}return t}function ip_SetColumnFormat(e,r){var r=$.extend({transactionID:ip_GenerateTransactionID(),render:!0,raiseEvent:!0,columns:null,style:null,border:null,validation:null,dataType:null,controlType:null,hashTags:null,mask:null,decimals:null,decimalsInc:null,PropertyAppendModes:"style:append",createUndo:!0},r),o=r.transactionID,i="",t=null,l=ip_formatObject();if(t={colData:[]},null!=r.columns&&""==i){r.columns.sort(function(e,r){return e-r});var n=!1,a={startRow:-1,startCol:r.columns[0],endRow:ip_GridProps[e].rows-1,endCol:r.columns[r.columns.length-1]};if(r.createUndo)var s=ip_AddUndo(e,"ip_SetColDataType",o,"ColData",a,a,{row:a.startRow,col:a.startCol});for(var p=0;p<r.columns.length;p++){var d=r.columns[p];if(r.createUndo&&ip_AddUndoTransactionData(e,s,ip_CloneCol(e,d)),t.colData[t.colData.length]={col:d,style:null,dataType:null,controlType:null,hashTags:null,validation:null,decimalsInc:null,decimals:null,mask:null},null!=r.style&&(ip_GridProps[e].colData[d].style=""==r.style?null:-1!=r.PropertyAppendModes.indexOf("style:append")?ip_AppendCssStyle(e,ip_GridProps[e].colData[d].style,r.style):r.style,t.colData[t.colData.length-1].style=null==ip_GridProps[e].colData[d].style?"":ip_GridProps[e].colData[d].style),null!=r.controlType&&(ip_GridProps[e].colData[d].controlType=""==r.controlType?null:r.controlType,t.colData[t.colData.length-1].controlType=r.controlType),null!=r.hashTags&&(ip_GridProps[e].colData[d].hashTags=""==r.hashTags?null:r.hashTags,t.colData[t.colData.length-1].hashTags=r.hashTags),null!=r.border&&(ip_GridProps[e].colData[d].border=""==r.border?null:r.border,t.colData[t.colData.length-1].border=r.border),null!=r.validation&&(ip_GridProps[e].colData[d].validation.validationCriteria=""==r.validation.validationCriteria?null:r.validation.validationCriteria,ip_GridProps[e].colData[d].validation.validationAction=""==r.validation.validationAction?null:r.validation.validationAction,t.colData[t.colData.length-1].validation=ip_validationObject(r.validation.validationCriteria,r.validation.validationAction)),null!=r.dataType&&(ip_GridProps[e].colData[d].dataType.dataType=""==r.dataType.dataType?null:r.dataType.dataType,ip_GridProps[e].colData[d].dataType.dataTypeName=""==r.dataType.dataTypeName?null:r.dataType.dataTypeName,t.colData[t.colData.length-1].dataType=ip_dataTypeObject(r.dataType.dataType,r.dataType.dataTypeName),n||(r.mask=ip_DefaultMask(e,ip_GridProps[e].colData[d].dataType,r.mask?r.mask:ip_GridProps[e].colData[d].mask),r.mask=null==r.mask?"":r.mask,n=!0)),null!=r.mask&&(ip_GridProps[e].colData[d].mask=""==r.mask?null:r.mask,t.colData[t.colData.length-1].mask=r.mask),null!=r.decimalsInc){var c=ip_GridProps[e].colData[d].decimals;null==c&&(c=0),ip_GridProps[e].colData[d].decimals=c+r.decimalsInc}null!=r.decimals&&(ip_GridProps[e].colData[d].decimals=r.decimals),ip_GridProps[e].colData[d].decimals<0&&(ip_GridProps[e].colData[d].decimals=null),l=ip_GetEnabledFormats(e,l,-1,d)}ip_AddDataTypeToIndex(e,r.dataType),r.render&&ip_ReRenderCols(e),r.raiseEvent&&null!=t.colData&&t.colData.length>0&&ip_RaiseEvent(e,"ip_FormatColumn",o,{ColDataType:{Inputs:r,Effected:t}})}else""==i&&(i="Please specify columns");return""!=i?(ip_RaiseEvent(e,"warning",o,i),null):l}function ip_AddDataTypeToIndex(e,r){if(e&&r){for(var o=!1,i=ip_GridProps[e].dataTypes,t=0;t<i.length;t++)if(i[t].dataTypeName==r.dataTypeName&&i[t].dataType==r.dataType){o=!0;break}o||i.push(r)}}function ip_ResetGridValues(e,r){for(var o=0;o<ip_GridProps[e].rowData.length;o++){ip_GridProps[e].rowData[o].loading=r;for(var i=0;i<ip_GridProps[e].rowData[o].cells.length;i++)ip_SetValue(e,o,i,null)}}function ip_ResetCell(e,r,o,i,t,l){if(r>=0&&o>=0&&ip_GridProps[e].rowData.length>r&&ip_GridProps[e].rowData[r].cells.length>o){var n=ip_cellObject();1==i?n.merge=ip_GridProps[e].rowData[r].cells[o].merge:ip_ResetCellMerge(e,r,o),1==t&&(n.fxIndexLnk=ip_GridProps[e].rowData[r].cells[o].fxIndexLnk),l||ip_RemoveCellFormulaIndex(e,{row:r,col:o}),ip_GridProps[e].rowData[r].cells[o]=n}}function ip_GetColumnValues(e,r){for(var o={},i=[],t=0;t<ip_GridProps[e].rowData.length;t++){var l=ip_GridProps[e].rowData[t].cells[r].value;null==o[l]&&(o[l]=!0,i[i.length]={displayField:l})}return i}function ip_AppendCssStyle(e,r,o){if(null!=o&&""!=o)if(-1==o.indexOf(";",o.length-1)&&(o+=";"),""!=r&&null!=r)for(var i=o.split(";"),t=0;t<i.length;t++){var l=i[t].split(":");l.length<2||(r=ip_ReplaceCssProperty(e,r,l[0],l[1]))}else r=o;return r}function ip_GetCssProperty(e,r,o){var i="";if(""!=r&&""!=o){var t=r.indexOf(o+":");if(-1!=t){t+=o.length+1;var l=r.indexOf(";",t);-1==l&&(l=r.length),i=r.substring(t,l)}}return i}function ip_EnabledFormats(e,r){var r=$.extend({range:null,maxCells:1e3,getStyle:!0,getDataType:!1,getControlType:!1,getValidation:!1,getHashTags:!1,getMask:!1,getDecimals:!1,adviseDefault:null},r),o="",i=(ip_GenerateTransactionID(),ip_formatObject());if(null==r.range&&0==ip_GridProps[e].selectedRange.length&&0==ip_GridProps[e].selectedColumn.length&&0==ip_GridProps[e].selectedRow.length)o="Please specify a range";else if(null==r.range)if(r.range=[],ip_GridProps[e].selectedRange.length>0)for(var t=0;t<ip_GridProps[e].selectedRange.length;t++)r.range[t]=ip_rangeObject(ip_GridProps[e].selectedRange[t][0][0],ip_GridProps[e].selectedRange[t][0][1],ip_GridProps[e].selectedRange[t][1][0],ip_GridProps[e].selectedRange[t][1][1],null,r.col);else if(ip_GridProps[e].selectedColumn.length>0)for(var t=0;t<ip_GridProps[e].selectedColumn.length;t++)r.range[t]=ip_rangeObject(0,ip_GridProps[e].selectedColumn[t],ip_GridProps[e].rows-1,ip_GridProps[e].selectedColumn[t],null,null);else if(ip_GridProps[e].selectedRow.length>0)for(var t=0;t<ip_GridProps[e].selectedRow.length;t++)r.range[t]=ip_rangeObject(ip_GridProps[e].selectedRow[t],0,ip_GridProps[e].selectedRow[t],ip_GridProps[e].cols-1,null);if(""==o)for(var l=0,t=0;t<r.range.length;t++){null!=r.adviseDefault||r.range[t].startRow>0||r.range[t].endRow<ip_GridProps[e].rows-1||(r.adviseDefault=!0),r.range[t].startRow<-1&&(r.range[t].startRow=-1),r.range[t].startCol<0&&(r.range[t].startCol=0);for(var n=r.range[t].startRow;n<=r.range[t].endRow;n++)for(var a=r.range[t].startCol;a<=r.range[t].endCol;a++)l++,r.getStyle&&(i=ip_GetEnabledFormats(e,i,n,a),""==i.fontFamily&&(i.fontFamily="default"),""==i.fontSize&&(i.fontSize="default")),r.getDataType&&ip_GetEnabledDataType(e,i,n,a,r.adviseDefault),r.getControlType&&ip_GetEnabledControlType(e,i,n,a,r.adviseDefault),r.getValidation&&ip_GetEnabledValidation(e,i,n,a,r.adviseDefault),r.getHashTags&&ip_GetEnabledHashTags(e,i,n,a,r.adviseDefault),r.getMask&&ip_GetEnabledMask(e,i,n,a,r.adviseDefault),r.getDecimals&&ip_GetEnabledDecimals(e,i,n,a,r.adviseDefault),null==r.maxCells||l<r.maxCells||(n=r.range[t].endRow+1,a=r.range[t].endCol+1);null==r.maxCells||l<r.maxCells||(t=r.range.length)}return"default"==i.fontFamily&&(i.fontFamily=""),"default"==i.fontSize&&(i.fontSize=""),i.validation.validationAction||(i.validation.validationAction=""),i.validation.validationCriteria||(i.validation.validationCriteria=""),i.dataType.dataType||(i.dataType.dataType=""),i.dataType.dataTypeName||(i.dataType.dataTypeName=""),i}function ip_GetEnabledHashTags(e,r,o,i,t){return r?(null==r.hashTags&&(r.hashTags=0>o?ip_GridProps[e].colData[i].hashTags:null!=ip_GridProps[e].rowData[o].cells[i].hashTags||null!=ip_GridProps[e].colData[i].hashTags?ip_GridProps[e].rowData[o].cells[i].hashTags||!t?ip_GridProps[e].rowData[o].cells[i].hashTags:ip_GridProps[e].colData[i].hashTags:null),r):0>o?ip_GridProps[e].colData[i].hashTags:null!=ip_GridProps[e].rowData[o].cells[i].hashTags||null!=ip_GridProps[e].colData[i].hashTags?ip_GridProps[e].rowData[o].cells[i].hashTags||!t?ip_GridProps[e].rowData[o].cells[i].hashTags:ip_GridProps[e].colData[i].hashTags:""}function ip_GetEnabledDataType(e,r,o,i,t){return null==r.dataType.dataType&&null==r.dataType.dataTypeName&&(r.dataType=ip_CellDataType(e,o,i,t).expectedDataType,""==r.dataType.dataType&&""==r.dataType.dataTypeName&&(r.dataType.dataType=null,r.dataType.dataTypeName=null)),r}function ip_GetEnabledControlType(e,r,o,i,t){return r?(null==r.controlType&&(r.controlType=0>o?ip_GridProps[e].colData[i].controlType:null!=ip_GridProps[e].rowData[o].cells[i].controlType||null!=ip_GridProps[e].colData[i].controlType?ip_GridProps[e].rowData[o].cells[i].controlType||!t?ip_GridProps[e].rowData[o].cells[i].controlType:ip_GridProps[e].colData[i].controlType:null),r):null!=ip_GridProps[e].rowData[o].cells[i].controlType||null!=ip_GridProps[e].colData[i].controlType?ip_GridProps[e].rowData[o].cells[i].controlType||!t?ip_GridProps[e].rowData[o].cells[i].controlType:ip_GridProps[e].colData[i].controlType:""}function ip_GetEnabledValidation(e,r,o,i,t){if(r)return null==r.validation.validationCriteria&&null==r.validation.validationAction&&(0>o?r.validation=ip_GridProps[e].colData[i].validation:(r.validation.validationCriteria=null==ip_GridProps[e].rowData[o].cells[i].validation.validationCriteria&&t?ip_GridProps[e].colData[i].validation.validationCriteria:ip_GridProps[e].rowData[o].cells[i].validation.validationCriteria,r.validation.validationAction=null==ip_GridProps[e].rowData[o].cells[i].validation.validationAction&&t?ip_GridProps[e].colData[i].validation.validationAction:ip_GridProps[e].rowData[o].cells[i].validation.validationAction),r.validation.validationCriteria&&(r.validation.inputs=r.validation.validationCriteria.match(/[^()]+(?=\))/g))),r;var l=ip_validationObject();return 0>o?l=ip_GridProps[e].colData[i].validation:(l.validationCriteria=null==ip_GridProps[e].rowData[o].cells[i].validation.validationCriteria&&t?ip_GridProps[e].colData[i].validation.validationCriteria:ip_GridProps[e].rowData[o].cells[i].validation.validationCriteria,l.validationAction=null==ip_GridProps[e].rowData[o].cells[i].validation.validationAction&&t?ip_GridProps[e].colData[i].validation.validationAction:ip_GridProps[e].rowData[o].cells[i].validation.validationAction),l.validationCriteria&&(l.inputs=l.validationCriteria.match(/[^()]+(?=\))/g)),l}function ip_GetEnabledFormats(e,r,o,i){null==r&&(r=ip_formatObject());var t=-1==o?ip_GridProps[e].colData[i].style:ip_GridProps[e].rowData[o].cells[i].style,l=ip_GridProps[e].colData[i].style;return null!=t||null!=l?(ip_HasFormatting(e,t,l,"font-weight","bold")&&(r.bold=!0),ip_HasFormatting(e,t,l,"font-style","italic")&&(r.italic=!0),ip_HasFormatting(e,t,l,"text-decoration","line-through")&&(r.linethrough=!0),ip_HasFormatting(e,t,l,"text-decoration","underline")&&(r.underline=!0),ip_HasFormatting(e,t,l,"text-decoration","overline")&&(r.overline=!0),ip_HasFormatting(e,t,l,"text-align","left")&&(r.alignleft=!0),ip_HasFormatting(e,t,l,"text-align","center",!0)&&(r.aligncenter=!0),ip_HasFormatting(e,t,l,"text-align","right")&&(r.alignright=!0),ip_HasFormatting(e,t,l,"vertical-align","top")&&(r.aligntop=!0),ip_HasFormatting(e,t,l,"vertical-align","middle",!0)&&(r.alignmiddle=!0),ip_HasFormatting(e,t,l,"vertical-align","bottom")&&(r.alignbottom=!0),""==r.fontSize&&(r.fontSize=ip_GetCssProperty(e,t+l,"font-size")),""==r.fontFamily&&(r.fontFamily=ip_GetCssProperty(e,t+l,"font-family")),""==r.fill&&(r.fill=ip_GetCssProperty(e,t+l,"background-color")),""==r.color&&(r.color=ip_GetCssProperty(e,t+l,"/**/color"))):(r.alignmiddle=!0,r.aligncenter=!0),-1==o&&null!=ip_GridProps[e].colData[i].containsMerges?r.merge=!0:-1==o?r.hasUnmergedCells=!0:o>-1&&null!=ip_GridProps[e].rowData[o].cells[i].merge?r.merge=!0:o>-1&&(r.hasUnmergedCells=!0),r}function ip_GetEnabledDecimals(e,r,o,i,t){if(r&&null!=r.decimals)return r;var l=null;if(0>o)Mask=ip_GridProps[e].colData[i].decimals;else{var n=ip_GridProps[e].rowData[o].cells[i].decimals,a=ip_GridProps[e].colData[i].decimals,s=null!=n||null!=a?n||!t?n:a:null;l=null==n?s:n}return r&&null==r.decimals?(r.decimals=l,r):l}function ip_GetEnabledMask(e,r,o,i,t){if(r&&null!=r.mask)return r;var l=null;if(0>o)l=ip_GridProps[e].colData[i].mask;else{var n=ip_GridProps[e].rowData[o].cells[i].mask,a=ip_GridProps[e].colData[i].mask,s=null!=n||null!=a?n||!t?n:a:"";l=n?n:s}return r&&null==r.mask?(r.mask=l,r):l}function ip_GetMaskObj(e,r,o,i,t){var t=t?t:ip_GetEnabledMask(e,null,r,o,!0);return null!=t&&""!=t&null!=ip_GridProps[e].mask.input[t]?{mask:t,input:ip_GridProps[e].mask.input[t],output:ip_GridProps[e].mask.output[t]}:null}function ip_HasFormatting(e,r,o,i,t,l){var n=(null==r?"":r)+(null==o?"":o),a={};if(""!=n)for(var s=n.split(";"),p=0;p<s.length;p++){var d=s[p].split(":");if(null==a[d[0]]){if(a[d[0]]=d[1],d[0]==i)return d[1]==t?!0:!1}else if(d[0]==i)return!1}return l&&null==a[i]?!0:!1}function ip_ShowCellToolTips(e,r){null==r&&(r=ip_GridProps[e].selectedCell)}function ip_isCellEmpty(e,r,o){var i=ip_GridProps[e].rowData[r].cells[o];return null!=i.merge?!1:""!=i.value&&null!=i.value?!1:""!=i.style&&null!=i.style?!1:""!=i.dataType.dataType&&null!=i.dataType.dataType?!1:""!=i.dataType.dataTypeName&&null!=i.dataType.dataTypeName?!1:""!=i.validation.validationCriteria&&null!=i.validation.validationCriteria?!1:""!=i.validation.validationAction&&null!=i.validation.validationAction?!1:!0}function ip_cellBorder(e,r,o,i,t,l,n){if(n&&0!=n.length&&r>=0&&o>=0&&r<ip_GridProps[e].rows&&o<ip_GridProps[e].cols){var a=ip_GridProps[e].rowData[r].cells[o],s="",p="";if("none"==i&&4==n.length)return void(a.border="");"none"==i&&(i="solid",t=1,l="transparent");for(var d=0;d<n.length;d++){"top"==n[d]&&(s="top:"+(0-parseInt(t))+"px;"),"left"==n[d]&&(p="left:"+(0-parseInt(t))+"px;");var c=border="border-"+n[d]+":"+("none"==i?";":i+" "+t+"px "+l+";");a.border=ip_AppendCssStyle(e,a.border,c)}""!=s&&(a.border=ip_AppendCssStyle(e,a.border,s)),""!=p&&(a.border=ip_AppendCssStyle(e,a.border,p)),-1==a.border.indexOf("border-top")&&(a.border+="border-top:solid 1px transparent;"),-1==a.border.indexOf("border-left")&&(a.border+="border-left:solid 1px transparent;")}}function ip_TextEditbleBlur(e,r,o,i,t,l,n,a,s,p){if(ip_GridProps[e].editing.editing){ip_GridProps[e].editing.editing=!1,o=null==o?ip_GridProps[e].editing.editTool:o,i=null==i?$(o).children(".ip_grid_EditTool_Input")[0]:i,t=null==t?ip_GridProps[e].editing.element:t,l=null==l?ip_GridProps[e].editing.contentType:l,r=null==r?o.text():r,n=null==n?parseInt($(t).attr("row")):n,a=null==a?parseInt($(t).attr("col")):a;var d=$(o).children(".ip_grid_EditTool_DropDown"),c="";if(!p&&"true"==$(d).attr("validate")){var _=!1,u=ip_fxValue(e,ip_GridProps[e].editing.editTool.text().toLowerCase()).value,g=$(d).find(".ip_grid_EditTool_DropDownItem");if("false"==$(d).attr("allowEmpty")||""!=u)for(var w=0;w<g.length;w++)$(g[w]).attr("val").toLowerCase()==u&&(ip_EditToolDropDownSelect(e,g[w],!1,!0),w=g.length,_=!0);else _=!0;_||(c="Please make sure you choose one of the dropdown items.")}if(""==c){if(n=null==n?-1:n,a=null==a?-1:a,ip_GridProps[e].events.textEditTool_Blur=ip_UnBindEvent(o,"focusout",ip_GridProps[e].events.textEditTool_FocusOut),!p)if("ip_grid_CellEdit"!=l&&"ip_grid_fxBar"!=l||-1==n||-1==a){if("ip_grid_ColumnType"==l&&-1!=a){var f=$(i).attr("key"),h=ip_GridProps[e].editing.editTool.text();ip_SetCellFormat(e,{row:-1,col:a,dataType:{dataType:f,dataTypeName:h}}),$(t).find(".ip_grid_cell_innerContent").html(h)}}else{var m=ip_GridProps[e].editing.editTool.text();ip_CellInput(e,{row:n,col:a,valueRAW:m}),ip_SetFxBarValue(e,{row:n,col:a,cell:t})}return ip_DisableSelection(e,!0),ip_EditToolHelpClear(e,o,i),$(o).hide(),ip_GridProps[e].editing.row=-1,ip_GridProps[e].editing.col=-1,ip_GridProps[e].editing.element=null,ip_GridProps[e].editing.contentType="",s&&$("#"+e).ip_SelectCell({raiseEvent:!1,unselect:!1}),!0}return $(i).focus(),ip_RaiseEvent(e,"warning",null,c),!1}}function ip_TextEditbleCancel(e,r,o,i,t,l,n,a){i=null==i?ip_GridProps[e].editing.element:i,l=null==l?parseInt($(i).attr("row")):l,n=null==n?parseInt($(i).attr("col")):n,ip_TextEditbleBlur(e,null,r,o,i,t,l,n,!1,!0),ip_ReRenderCell(e,l,n,a)}function ip_EditToolShowDropDown(e,r,o){if(null!=r&&null!=o){var i=$(r).children(".ip_grid_EditTool_DropDown")[0];if("string"==typeof o.data){var t=ip_fxValue(e,o.data,null,null).data;null!=t?(o.displayField=t.displayField,o.data=t.data):o.data=[]}if(null!=o.data&&o.data.length>0){ip_GridProps[e].editing.editing=!0;var l='<table border="0" cellpadding="0" cellspacing="0" class="ip_grid_EditTool_DropDownTable">';if(null!=o.noMatchData){var n=!1,a="",s="",p="",d=o.noMatchData[o.keyField];if("string"==typeof o.displayField)n=null==o.noMatchData[o.displayField[c].displayField]?!0:!1,a=o.noMatchData[o.displayField],s=a,null==a&&(a=""),null==s&&(s=".."),p='<td replaceWithInput="'+n+'">'+a+"</td>";else if(o.displayField.length>0)for(var c=0;c<o.displayField.length;c++)s=o.noMatchData[o.displayField[c].displayField],n=null==o.noMatchData[o.displayField[c].displayField]?!0:!1,0==c&&(a=o.noMatchData[o.displayField[c].displayField]),null==s&&(s=".."),null==a&&(a=""),p+='<td replaceWithInput="'+n+'" style="'+o.displayField[c].style+';" >'+s+"</td>";l+='<tr key="'+d+'" val="'+a+'" class="ip_grid_EditTool_DropDownItem noMatch">'+p+"</tr>"}for(var _=0;_<o.data.length;_++){var a="",p="",d=o.data[_][o.keyField];if("string"==typeof o.displayField)a=o.data[_][o.displayField],p="<td>"+a+"</td>";else if(o.displayField.length>0)for(var c=0;c<o.displayField.length;c++)0==c&&(a=o.data[_][o.displayField[c].displayField]),p+='<td style="'+o.displayField[c].style+';" >'+o.data[_][o.displayField[c].displayField]+"</td>";l+='<tr key="'+d+'" val="'+a+'" class="ip_grid_EditTool_DropDownItem">'+p+"</tr>"}l+="</table>",$(i).html(l);var u=$(i).find(".ip_grid_EditTool_DropDownItem"),g=ip_GridProps[e].dimensions.gridHeight-ip_GridProps[e].dimensions.defaultBorderHeight-parseInt($("#"+e+"_q4_scrollbar_container_x").height())-ip_GridProps[e].dimensions.columnSelectorHeight,w=$(r).width();$(i).attr("validate",o.validate),$(i).attr("allowEmpty",o.allowEmpty),$(i).css("max-height",g+"px"),$(i).show();var f=$(i).children(".ip_grid_EditTool_DropDownTable").width()-8;w>f&&(f=w,$(i).children(".ip_grid_EditTool_DropDownTable").css("width","100%")),$(i).width(f),ip_UnBindEvent(i,"focusin",ip_GridProps[e].events.textEditToolDropdown_FocusIn),$(i).focusin(ip_GridProps[e].events.textEditToolDropdown_FocusIn=function(){clearTimeout(ip_GridProps[e].timeouts.textEditToolBlurTimeout)}),ip_UnBindEvent(u,"click",ip_GridProps[e].events.textEditToolDropdown_Click),$(u).click(ip_GridProps[e].events.textEditToolDropdown_Click=function(){ip_EditToolDropDownSelect(e,this,!0,!0)}),ip_UnBindEvent(u,"mouseenter",ip_GridProps[e].events.textEditToolDropdown_Mouseenter),$(u).mouseenter(ip_GridProps[e].events.textEditToolDropdown_Mouseenter=function(){ip_EditToolDropDownSelect(e,this,!1,!1)})}else $(i).attr("validate",!1),$(i).html(""),$(i).hide()}}function ip_EditToolDropDownHighlightNext(e,r){clearTimeout(ip_GridProps[e].textEditToolDropdownScrollTimeout);var o=ip_GridProps[e].editing.editTool,i=$(o).children(".ip_grid_EditTool_DropDown")[0],t=$(i).find(".ip_grid_EditTool_DropDownItem:not(.filtered)"),l=$(i).find(".Selected");if(0==l.length)ip_EditToolDropDownSelect(e,t[0],!1,!0);else{var n=$(t).index(l);if("down"==r&&n<t.length-1){ip_EditToolDropDownSelect(e,t[n+1],!1,!0);var a=$(i).height(),s=$(i).scrollTop(),p=$(t[n+1]).outerHeight(),d=$(t[n+1]).position().top+s-p,c=d-a/2;d>a+s&&$(i).animate({scrollTop:c},200)}else if("up"==r&&n>0){ip_EditToolDropDownSelect(e,t[n-1],!1,!0);var a=$(i).height(),s=$(i).scrollTop(),p=$(t[n-1]).outerHeight(),d=$(t[n-1]).position().top+s-p,c=d-a/2;s>d&&$(i).animate({scrollTop:c},200)}}}function ip_EditToolDropDownSelect(e,r,o,i){var t=ip_GridProps[e].editing.editTool,l=$(t).children(".ip_grid_EditTool_DropDown")[0];$(l).find(".ip_grid_EditTool_DropDownItem").removeClass("Selected"),$(r).addClass("Selected"),i&&ip_GridProps[e].editing.editTool.text($(r).attr("val"),$(r).attr("key")),o&&ip_TextEditbleBlur(e,"",t,null,ip_GridProps[e].editing.element,ip_GridProps[e].editing.contentType,ip_GridProps[e].editing.row,ip_GridProps[e].editing.col)}function ip_EditToolDropDownFilter(e,r){var o=ip_GridProps[e].editing.editTool,i=$(o).children(".ip_grid_EditTool_DropDown")[0],t=$(i).find(".ip_grid_EditTool_DropDownItem"),l=$(i).find(".ip_grid_EditTool_DropDownItem.noMatch"),n=!1,a=r.toLowerCase().trim(),s=0;if(""==a)$(t).removeClass("filtered");else for(var p=0;p<t.length;p++){var d=$(t[p]).attr("val").toLowerCase().trim();d.indexOf(a)>-1?($(t[p]).removeClass("filtered"),s++):$(t[p]).addClass("filtered"),a!=d||$(t[p]).hasClass("noMatch")||(n=!0)}l.length>0&&(n?$(l).addClass("filtered"):($(l).removeClass("filtered"),$(l).find("td").each(function(){if("true"==$(this).attr("replaceWithInput")){var e=r+"..";$(this).html(e),$(this).parent().attr("val",r)}})),$(i).animate({width:$(i).children(".ip_grid_EditTool_DropDownTable").width()},200))}function ip_EditToolHelp(e,r,o,i,t,l,n){if(null==r||""==r)return n&&ip_GridProps[e].editing.editTool.text(""),!1;editTool=ip_GridProps[e].editing.editTool,o=null==o?{x:r.lengh}:o;var a=!1,s=o.x+i,p=null==o.length||0==o.length?null:o.x+o.length;if("="==r[0]){o=null==o?o={x:r.length,length:0}:o,r=null==r?ip_GridProps[e].editing.editTool.text():r,a=ip_fxObject(e,r,null,null,s-i),$("#"+e).ip_RemoveRangeHighlight({highlightType:"ip_grid_cell_rangeHighlight_fx"});for(var d in a.ranges)$("#"+e).ip_RangeHighlight({highlightType:"ip_grid_cell_rangeHighlight_fx",multiselect:!0,opacity:.2,fillColor:a.ranges[d].color,borderColor:a.ranges[d].color,range:a.ranges[d].range});r=a.formatted}return t&&a&&ip_ShowEditToolHelpToolTip(e,ip_fxInfo(e,a.focused.value)),n&&ip_GridProps[e].editing.editTool.text(r,null,s,p),a}function ip_EditToolHelpClear(e,r,o){r=null==r?ip_GridProps[e].editing.editTool:r,o=null==o?$(r).children(".ip_grid_EditTool_Input")[0]:o,$("#"+e).ip_RemoveRangeHighlight({fadeOut:!0,highlightType:"ip_grid_cell_rangeHighlight_fx"}),$(o).removeClass("ip_grid_EditTool_Input_FX"),$().ip_Modal({show:!1})}function ip_ShowEditToolHelpToolTip(e,r){var o="";if(null!=r){var i=r.name,o='<div class="ip_grid_EditTool_HelpToolTipItem Title"><b>'+r.name.toUpperCase()+" "+r.inputs+"</b></div>";o+='<div class="ip_grid_EditTool_HelpToolTipItem Text">'+r.tip+"</div>",o+='<div class="ip_grid_EditTool_HelpToolTipItem Example"><span>Example: </span>'+r.example+"</div>"}return $().ip_Modal(""!=o?{modalSessionID:i,greyOut:!1,axisContainment:!0,cssClass:"ip_grid_EditTool_Help",animate:0,relativeTo:".ip_grid_EditTool_Input",message:o,position:null,positionNAN:["right","left"],fade:100,buttons:{hide:{text:"HIDE",style:"background-color:#9c3b3b;",onClick:function(){$().ip_Modal({show:!1})
}},ok:{},cancel:{}}}:{show:!1,fade:100}),o}function ip_SetFxBarValue(e,r){var r=$.extend({value:null,cell:ip_GridProps[e].selectedCell,row:null,col:null},r),o=r.value,i=r.cell,t=r.row,l=r.col;if(null==t&&null!=i&&(t=parseInt($(i).attr("row"))),null==l&&null!=i&&(l=parseInt($(i).attr("col"))),null!=t&&null!=l||null!=i){null==t&&(t=parseInt($(i).attr("row"))),null==l&&(l=parseInt($(i).attr("col")));var n=ip_CellData(e,t,l);if(null!=n){var a=ip_fxObject(e,n.formula,t,l,0),o=a?a.formatted:n.value;null==o&&(o="&nbsp;")}}if(null!=o){var s=ip_GridProps[e].fxBar;$(s).children(".ip_grid_fbar_text").html(o)}}function ip_DefaultMask(e,r,o){if(null==r)return null;var i=ip_GetMasksForDataType(e,r);if(null!=i&&i.length>0){if(o){var t=i.map(function(e){return e.mask}).indexOf(o);if(-1!=t)return i[t].mask}return i[0].mask}return null}function ip_GetMasksForDataType(e,r){if(!r)return null;var o=[],i=null==r.dataTypeName?"":r.dataTypeName.toLowerCase(),t=null==r.dataType?"":r.dataType.toLowerCase();return i&&t!=i&&null!=ip_GridProps[e].mask[i]&&(o=o.concat(ip_GridProps[e].mask[i])),null!=t&&null!=ip_GridProps[e].mask[t]&&(o=o.concat(ip_GridProps[e].mask[t])),o}function ip_fxInfo(e,r){return ip_GridProps[e].fxList[r]?ip_GridProps[e].fxList[r].fxInfo:null}function ip_fxValue(e,r,o,i){var t={data:null,value:null,error:null,formula:r};if(null==r||""==r||"="!=r[0]){var l=o&&i?ip_CellDataType(e,o,i,!0,r):{value:r};t.value=1==l.valid?l.value:r,t.formula=null}else{var n=ip_fxCalculate(e,r.substring(1,r.length),o,i);null==n||n.errorCode?null!=n&&(t.data=null,t.value="#ERROR",t.error=ip_errorObject(n.errorCode,n.errorDescription)):"object"==typeof n?(t.data=n,t.value=""+n):t.value=n}return t}function ip_fxObject(e,r,o,i,t){if(null==r||""==r||"="!=r[0])return!1;var l=r.match(ip_GridProps.index.regEx.range),n=r.match(ip_GridProps.index.regEx.fx),a=r.match(/[^()]+(?=\))/g),s={formatted:r,formula:r,inputs:a,ranges:{},functions:n,row:o,col:i,focused:{value:"",type:"",partIndex:0,cursorI:0},parts:[]};if(null!=t){var p=0;s.parts=r.match(RegExp(ip_GridProps.index.regEx.range.source+"|"+ip_GridProps.index.regEx.words.source+"|"+ip_GridProps.index.regEx.nonWords.source,"gi")),s.focused.partIndex=s.parts.length-1;for(var d=0;d<s.parts.length;d++)if(p+=s.parts[d].length,s.focused.value=s.parts[d],s.focused.partIndex=d,s.focused.cursorI=p-s.parts[d].length,p>t){s.focused.value=s.focused.value.trim();break}}if(null!=l)for(var c=255/l.length,_=0,u=0;u<l.length;u++)if(null==s.ranges[l[u]]){var g=ip_fxRangeObject(e,o,i,l[u]);if(null!=g&&(_+=c,s.ranges[l[u]]={color:ip_ChangeHue("#ff0000",_),range:g,rangeText:l[u]},t)){var w=l[u].replace(/\$/gi,"\\$"),f=RegExp(ip_GridProps.index.regEx.notInQuotes.source+"(?!<[^>]*?>)"+w+"(?![^<]*?</)(?![0-9:]+)","gi"),h=(s.formatted.match(f),l[u].replace(/\$/gi,"$$$"));s.formatted=s.formatted.replace(f,'<span style="color:'+s.ranges[l[u]].color+';">'+h+"</span>")}}return s}function ip_fxException(e,r,o,i,t){return{errorCode:e,errorDescription:r,fxName:o,row:i,col:t}}function ip_fxRangeObject(e,r,o,i){if(""!=i&&null!=i){var t=[];i=i.toUpperCase().trim(),i=i.split(",");for(var l=0;l<i.length;l++){for(var n=ip_rangeObject(null,null,null,null,null,null,i[l].match(ip_GridProps.index.regEx.hashtag)),a=i[l].replace(ip_GridProps.index.regEx.hashtag,"").split(":"),s=0;s<a.length;s++){for(var p=a[s].trim(),d="",c="",_=!1,u=!1,g=0;g<p.length;g++)"$"==p[g]?""==d?u=!0:_=!0:isNaN(parseInt(p[g]))?d+=p[g]:c+=p[g];if(""==d||""==c)return null;if(0==s){if(n.startRowLock=_,n.startColLock=u,n.endRowLock=_,n.endColLock=u,n.startRow=""==c?0:parseInt(c),n.startCol=ip_GridProps[e].indexedData.colSymbols.symbolCols[d],n.endRow=""==c?ip_GridProps[e].rows-1:n.startRow,n.endCol=n.startCol,null==n.startRow||null==n.startCol)return null;a.length>1&&(s=a.length-2)}else if(n.endRowLock=_,n.endColLock=u,n.endRow=""==c?ip_GridProps[e].rows-1:parseInt(c),n.endCol=ip_GridProps[e].indexedData.colSymbols.symbolCols[d],null==n.endRow||null==n.endCol)return null}n.startRow<0&&(n.startRow=0),n.startRow<ip_GridProps[e].rows||(n.startRow=ip_GridProps[e].rows-1),n.endRow<0&&(n.endRow=0),n.endRow<ip_GridProps[e].rows||(n.endRow=ip_GridProps[e].rows-1),n.startCol<0&&(n.startCol=0),n.startCol<ip_GridProps[e].cols||(n.startCol=ip_GridProps[e].cols-1),n.endCol<0&&(n.endCol=0),n.endCol<ip_GridProps[e].cols||(n.endCol=ip_GridProps[e].cols-1),t[t.length]=n}return t.length>1?t:t[0]}return null}function ip_fxRangeToString(e,r,o){if(null!=r){var i="";r.length||(r=[r]),o||(o=", ");for(var t=0;t<r.length;t++){var l=ip_ValidateRangeObject(e,r[t]);i+=(l.startColLock?"$":"")+ip_GridProps[e].indexedData.colSymbols.colSymbols[l.startCol]+(l.startRowLock?"$":"")+l.startRow+(l.startRow!=l.endRow||l.startCol!=l.endCol?":"+(l.endColLock?"$":"")+ip_GridProps[e].indexedData.colSymbols.colSymbols[l.endCol]+(l.endRowLock?"$":"")+l.endRow:"")+(t<r.length-1?o:""),l.hashtags&&(i+=l.hashtags.join())}return i}}function ip_fxCalculate(GridID,fxString,row,col){try{var rxRootRanges=RegExp(ip_GridProps.index.regEx.notInBrackets.source+ip_GridProps.index.regEx.range.source,"gi");ip_fxValidate(GridID,fxString,row,col),fxString=fxString.replace(rxRootRanges,function(e){return'ip_fxRange("'+GridID+'",'+row+","+col+',"'+e+'")'}),fxString=fxString.replace(ip_GridProps.index.regEx.range,function(e){return'ip_fxRangeObject("'+GridID+'",'+row+","+col+',"'+e+'")'});for(var key in ip_GridProps[GridID].fxList)fxString=fxString.replace(RegExp("\\b"+key+"\\(\\)","gi"),ip_GridProps[GridID].fxList[key].fxName+'("'+GridID+'",'+row+","+col+")"),fxString=fxString.replace(RegExp("\\b"+key+"\\(","gi"),ip_GridProps[GridID].fxList[key].fxName+'("'+GridID+'",'+row+","+col+",");return eval(fxString)}catch(ex){return ex.fxName?ex:ip_fxException(1,ex.message,"eval",row,col)}}function ip_fxValidate(e,r,o,i){if(""==r)return!0;for(var t=RegExp(ip_GridProps.index.regEx.range.source+"|"+ip_GridProps.index.regEx.words.source+"|"+ip_GridProps.index.regEx.nonWords.source,"gi"),l=r.match(t),n=0;n<l.length;n++){var a=l[n].toLowerCase().trim();if(ip_GridProps[e].fxList[a]);else if(""==a);else if(a.match(ip_GridProps.index.regEx.operator));else if('"'==a[0]&&'"'==a[a.length-1]);else if(ip_parseNumber(a));else if(!a.match(ip_GridProps.index.regEx.range))throw ip_fxException("1",'Cant calculate "'+a+'" in '+r+", please fix formula","formula",o,i)}return!0}function ip_fxValidateCellHashTags(e,r,o,i){if(!i)return!0;for(var t=0;t<i.length;t++){var l=ip_GetEnabledHashTags(e,null,r,o,!0);if(l.match(RegExp(i[t]+"\\b","gi")))return!0}return!1}function ip_fxRange(e,r,o,i){if(arguments.length<4)throw ip_fxException("1","Missing input paramiters","range",r,o);var t="";e=arguments[0],r=arguments[1],o=arguments[2],i=Array.prototype.slice.call(arguments).splice(3);for(var l=0;l<i.length;l++){var n=i[l];if("string"==typeof n&&(n=ip_fxRangeObject(e,r,o,n)),ip_GridProps[e].rowData[n.startRow].loading)throw ip_fxException("1","Row data not loaded","range",r,o);if(ip_fxValidateCellHashTags(e,n.startRow,n.startCol,n.hashtags))return ip_CellDataType(e,n.startRow,n.startCol,!0).value}return t}function ip_fxCount(e,r,o,i){if(arguments.length<4)throw ip_fxException("1","Missing input paramiters","count",r,o);var t=0;e=arguments[0],r=arguments[1],o=arguments[2],i=Array.prototype.slice.call(arguments).splice(3);for(var l=0;l<i.length;l++)if("object"==typeof i[l]){var n=i[l];"string"==typeof n&&(n=ip_fxRangeObject(e,r,o,n));for(var a=n.startRow;a<=n.endRow;a++){if(ip_GridProps[e].rowData[a].loading)throw ip_fxException("1","Row data not loaded","range",r,o);for(var s=n.startCol;s<=n.endCol;s++){if(a==r&&s==o)throw ip_fxException("1","Circular dependency detected, your formula range may not include the cell that contains the formula","count",r,o);var p=ip_CellDataType(e,a,s,!0);null!=p.value&&ip_fxValidateCellHashTags(e,a,s,n.hashtags)&&"number"==typeof p.value&&t++}}}else{if(isNaN(parseFloat(i[l])))throw ip_fxException("1","Inputs are incorrect, they must be numbers or ranges","count",r,o);t+=parseFloat(i[l])}return t}function ip_fxSum(e,r,o,i){if(arguments.length<4)throw ip_fxException("1","Missing input paramiters","sum",r,o);var t=null,l=0;e=arguments[0],r=arguments[1],o=arguments[2],i=Array.prototype.slice.call(arguments).splice(3);for(var n=0;n<i.length;n++)if("object"==typeof i[n]){var a=i[n];"string"==typeof a&&(a=ip_fxRangeObject(e,r,o,a));for(var s=a.startRow;s<=a.endRow;s++){if(ip_GridProps[e].rowData[s].loading)throw ip_fxException("1","Row data not loaded","sum",r,o);for(var p=a.startCol;p<=a.endCol;p++){if(s==r&&p==o)throw ip_fxException("1","Circular dependency detected, your formula range may not include the cell that contains the formula","sum",r,o);var d=ip_CellDataType(e,s,p,!0);null!=d.value&&ip_fxValidateCellHashTags(e,s,p,a.hashtags)&&(isNaN(parseFloat(d.value))||(l+=parseFloat(d.value)))}}}else if("number"==typeof(t=ip_fxCalculate(e,i[n])))l+=t;else{if(isNaN(parseFloat(i[n])))throw ip_fxException("1","Inputs are incorrect, they must be numbers or ranges","sum",r,o);l+=parseFloat(i[n])}return l}function ip_fxConcat(e,r,o,i){if(arguments.length<4)throw ip_fxException("1","Missing input paramiters","concat",r,o);var t="";e=arguments[0],r=arguments[1],o=arguments[2],i=Array.prototype.slice.call(arguments).splice(3);for(var l=0;l<i.length;l++)if("object"==typeof i[l]){var n=i[l];"string"==typeof n&&(n=ip_fxRangeObject(e,r,o,n));for(var a=n.startRow;a<=n.endRow;a++){if(ip_GridProps[e].rowData[a].loading)throw ip_fxException("1","Row data not loaded","range",r,o);for(var s=n.startCol;s<=n.endCol;s++){if(a==r&&s==o)throw ip_fxException("1","Circular dependency detected, your formula range may not include the cell that contains the formula","concat",r,o);var p=ip_CellDataType(e,a,s,!0);if(null!=p.display&&ip_fxValidateCellHashTags(e,a,s,n.hashtags)&&(null!=p.display&&(t+=p.display+""),500==t.length))break}}}else null!=i[l]&&(t+=i[l]);return t.length>500&&(t=t.substr(0,500)),t}function ip_fxDropDown(e,r,o,i){if(arguments.length<4)throw ip_fxException("1","Missing input paramiters","dropdown",r,o);var t={displayField:"displayField",data:[],toString:function(){return null}},l={};e=arguments[0],r=arguments[1],o=arguments[2],i=Array.prototype.slice.call(arguments).splice(3);for(var n=0;n<i.length;n++){var a=i[n];if("object"==typeof a)for(var s=a.startRow;s<=a.endRow;s++){if(ip_GridProps[e].rowData[s].loading)throw ip_fxException("1","Row data not loaded","range",r,o);for(var p=a.startCol;p<=a.endCol;p++){var d=ip_GridProps[e].rowData[s].cells[p].value,c=ip_GridProps[e].rowData[s].cells[p].display;null!=c&&""!=c&&null==l[c]&&ip_fxValidateCellHashTags(e,s,p,a.hashtags)&&(l[c]=!0,t.data[t.data.length]={displayField:c,valueField:d})}}else{var d=a;null!=d&&""!=d&&null==l[d]&&(l[d]=!0,t.data[t.data.length]={displayField:d,valueField:d})}}return t}function ip_fxGantt(e,r,o,i){if(arguments.length<6)throw ip_fxException("1","Missing input paramiters","gantt",r,o);var t=!1;if(e=arguments[0],r=arguments[1],o=arguments[2],i=Array.prototype.slice.call(arguments).splice(3),i.length<3)throw ip_fxException("1","Missing inputs, must have the following: BaseDate, StartDate, EndDate, TaskName","gantt",r,o);{var l=!1,n=!1,a=!1,s=i[0],p=i[1],d=i[2];i.length<3?"":i[3],i.length<4?"":i[4]}if(ip_parseDate(s)||"object"!=typeof s||(s=ip_GridProps[e].rowData[s.startRow].cells[s.startCol].value),ip_parseDate(p)||"object"!=typeof p||(p=ip_GridProps[e].rowData[p.startRow].cells[p.startCol].value),ip_parseDate(d)||"object"!=typeof d||(d=ip_GridProps[e].rowData[d.startRow].cells[d.startCol].value),Date.parse(l=new Date(s)))s=l;else{if(!(l=ip_fxCalculate(e,s)))throw ip_fxException("1","The BaseDate must be a valid date format","gantt",r,o);if(l.error)return l;s=l}if(Date.parse(n=new Date(p)))p=n;else{if(!(n=ip_fxCalculate(e,p)))throw ip_fxException("1","The StartDate must be a valid date format","gantt",r,o);if(n.error)return n;p=n}if(Date.parse(a=new Date(d)))d=a;else{if(!(a=ip_fxCalculate(e,d)))throw ip_fxException("1","The EndDate must be a valid date format","gantt",r,o);if(a.error)return a;d=a}return p.setHours(0,0,0,0),d.setHours(23,59,59,999),p>s||s>d||(t=!0),t}function ip_fxMax(e,r,o,i){if(arguments.length<4)throw ip_fxException("1","Missing input paramiters","max",r,o);var t=null;e=arguments[0],r=arguments[1],o=arguments[2],increment=arguments[3],"string"==typeof i&&(i=[ip_fxRangeObject(e,r,o,i)]),void 0==i.length&&(i=[i]);for(var l=0;l<i.length;l++)if("object"==typeof i[l])for(var n=i[l],a=n.startRow;a<=n.endRow;a++){if(ip_GridProps[e].rowData[a].loading)throw ip_fxException("1","Row data not loaded","range",r,o);for(var s=n.startCol;s<=n.endCol;s++){if(a==r&&s==o)throw ip_fxException("1","Circular dependency detected, your formula range may not include the cell that contains the formula","max",r,o);var p=ip_CellDataType(e,a,s,!0);null!=p.value&&ip_fxValidateCellHashTags(e,a,s,n.hashtags)&&(null==t||p.value>t)&&(t=p.value)}}else{if(null!=tmp&&i[l]<=tmp)throw ip_fxException("1","Inputs are incorrect, they must be numbers or ranges","max",r,o);tmp=i[l]}return t}function ip_fxToday(e,r,o,i){if(arguments.length<4)throw ip_fxException("1","Missing input paramiters","today",r,o);return e=arguments[0],r=arguments[1],o=arguments[2],i=arguments[3],null==i?i=0:("object"==typeof i&&i.length>0&&!isNaN(parseInt(i[0]))?i=parseInt(i[0]):"object"==typeof i&&i.length>0&&(i=i[0]),"string"==typeof i&&(i=ip_fxRangeObject(e,r,o,i)),"object"==typeof i&&(i=ip_fxRange(e,r,o,i))),new Date((new Date).valueOf()+864e5*i)}function ip_fxDate(e,r,o,i){if(arguments.length<4)throw ip_fxException("1","Missing input paramiters","date",r,o);return e=arguments[0],r=arguments[1],o=arguments[2],i=arguments[3],null==i?i=0:("object"==typeof i&&i.length>0&&!isNaN(parseInt(i[0]))?i=parseInt(i[0]):"object"==typeof i&&i.length>0&&(i=i[0]),"string"==typeof i&&(i=ip_fxRangeObject(e,r,o,i)),"object"==typeof i&&(i=ip_fxRange(e,r,o,i))),new Date((new Date).valueOf()+864e5*i)}function ip_fxDay(e,r,o,i){if(arguments.length<4)throw ip_fxException("1","Missing input paramiters","day",r,o);return e=arguments[0],r=arguments[1],o=arguments[2],i=arguments[3],null==i?i=0:("object"==typeof i&&i.length>0&&!isNaN(parseInt(i[0]))?i=parseInt(i[0]):"object"==typeof i&&i.length>0&&(i=i[0]),"string"==typeof i&&(i=ip_fxRangeObject(e,r,o,i)),"object"==typeof i&&(i=ip_fxRange(e,r,o,i))),new Date((new Date).valueOf()+864e5*i).getUTCDate()}function ip_TableWidth(e){for(var r=0,o=0,i=$("#"+e).outerWidth(),t=document.getElementById(e),l=t.querySelectorAll("thead th"),n=0;n<l.length;n++)o+=$(l[n]).outerWidth();return r=i>o?i:o+i}function ip_SetQuadContainerWidth(e,r){var o=$("#"+e+"_q4_scrollbar_container_y").outerWidth();1!=r&&r||$("#"+e+"_q1_container").width(ip_TableWidth(e+"_q1_table")),2!=r&&r||$("#"+e+"_q2_container").width(ip_TableWidth(e+"_q2_table")+o),3!=r&&r||$("#"+e+"_q3_container").width(ip_TableWidth(e+"_q3_table")),4!=r&&r||$("#"+e+"_q4_container").width(ip_TableWidth(e+"_q4_table")+o)}function ip_GetQuad(e,r,o){var i=1;return-1!=r&&-1!=o?(i=o<ip_GridProps[e].frozenCols?1:2,i=1==i?r<ip_GridProps[e].frozenRows?1:3:r<ip_GridProps[e].frozenRows?2:4):-1==r?i=o<ip_GridProps[e].frozenCols?1:2:-1==o&&(i=r<ip_GridProps[e].frozenRows?1:3),i}function ip_CellRelativePosition(e,r,o,i){var t={relativeTop:0,relativeLeft:0,localTop:0,localLeft:0,localBottom:0,localRight:0,width:0,height:0};if(null==r||isNaN(parseFloat(r))||null==o||isNaN(parseFloat(o)))return t;var l=1,n=1;if(-1!=r&&-1!=o){var a=ip_CellData(e,r,o).merge;null!=a&&(l=a.rowSpan,n=a.colSpan)}var s=ip_GetQuad(e,r,o),p=$("#"+e+"_q"+s+"_table");if(i){var d=ip_GridProps[e].scrollY,c=ip_GridProps[e].scrollX,_=ip_GridProps[e].frozenRows,u=ip_GridProps[e].frozenCols,g=d+ip_GridProps[e].loadedRows-_-1,w=c+ip_GridProps[e].loadedCols-u-1;-1!=r&&d>r&&r>=_?r=d:-1!=r&&r>g&&(r=g),-1!=o&&c>o&&o>=u?o=c:-1!=o&&o>w&&(o=w),-1!=r&&0>r?r=0:r<ip_GridProps[e].rows||(r=ip_GridProps[e].rows-1),-1!=o&&0>o?o=0:o<ip_GridProps[e].cols||(o=ip_GridProps[e].cols-1)}if(-1==r){var f=$("#"+e+"_q"+s+"_columnSelectorCell_"+o);if(f.length>0){t.localTop=$(f).offset().top-$(p).offset().top,t.localLeft=$(f).offset().left-$(p).offset().left,t.localBottom=t.localTop;for(var h=0;l>h;h++)t.localBottom+=ip_RowHeight(e,r+h,!0);t.localRight=t.localLeft;for(var m=0;n>m;m++)t.localRight+=ip_ColWidth(e,o+m,!0)}}else if(-1==o){var f=$("#"+e+"_q"+s+"_rowSelecterCell_"+r);if(f.length>0){t.localTop=$(f).offset().top-$(p).offset().top,t.localLeft=$(f).offset().left-$(p).offset().left,t.localBottom=t.localTop;for(var h=0;l>h;h++)t.localBottom+=ip_RowHeight(e,r+h,!0);t.localRight=t.localLeft;for(var m=0;n>m;m++)t.localRight+=ip_ColWidth(e,o+m,!0)}}else{var f=$("#"+e+"_cell_"+r+"_"+o);if(f.length>0){t.localTop=$(f).offset().top-$(p).offset().top,t.localLeft=$(f).offset().left-$(p).offset().left,t.localBottom=t.localTop;for(var h=0;l>h;h++)t.localBottom+=ip_RowHeight(e,r+h,!0);t.localRight=t.localLeft;for(var m=0;n>m;m++)t.localRight+=ip_ColWidth(e,o+m,!0)}}return t}function ip_LoadedRowsCols(e,r,o,i){var t={rowFrom_scroll:0,rowTo_scroll:0,rowCount_scroll:0,rowLoaded_scroll:0,colFrom_scroll:0,colTo_scroll:0,colCount_scroll:0,colLoaded_scroll:0,rowFrom_frozen:0,rowTo_frozen:0,rowCount_frozen:0,rowLoaded_frozen:0,colFrom_frozen:0,colTo_frozen:0,colCount_frozen:0,colLoaded_frozen:0},l=null,n=null,a=null,s=null;if(null==o&&(o=!0),null==i&&(i=!0),o&&(t.rowFrom_frozen=0,t.rowCount_frozen=ip_GridProps[e].frozenRows,t.rowCount_frozen<ip_GridProps[e].rows||(t.rowCount_frozen=ip_GridProps[e].rows),t.rowTo_frozen=t.rowFrom_frozen+t.rowCount_frozen-1),i&&(t.colFrom_frozen=0,t.colCount_frozen=ip_GridProps[e].frozenCols,t.colCount_frozen<ip_GridProps[e].cols||(t.colCount_frozen=ip_GridProps[e].cols),t.colTo_frozen=t.colFrom_frozen+t.colCount_frozen-1),o&&(t.rowFrom_scroll=-1==ip_GridProps[e].scrollY?ip_GridProps[e].frozenRows:ip_GridProps[e].scrollY,t.rowCount_scroll=ip_GridProps[e].loadedRows-ip_GridProps[e].frozenRows,t.rowFrom_scroll+t.rowCount_scroll<ip_GridProps[e].rows||(t.rowCount_scroll=ip_GridProps[e].rows-t.rowFrom_scroll),t.rowTo_scroll=t.rowFrom_scroll+t.rowCount_scroll-1),i&&(t.colFrom_scroll=-1==ip_GridProps[e].scrollX?ip_GridProps[e].frozenCols:ip_GridProps[e].scrollX,t.colCount_scroll=ip_GridProps[e].loadedCols-ip_GridProps[e].frozenCols,t.colFrom_scroll+t.colCount_scroll<ip_GridProps[e].cols||(t.colCount_scroll=ip_GridProps[e].cols-t.colFrom_scroll),t.colTo_scroll=t.colFrom_scroll+t.colCount_scroll-1),r){var p=null;p=document.getElementById(e+"_q1_table"),l=null==p?null:p.querySelectorAll("tbody tr.ip_grid_row"),n=null==p?null:p.querySelectorAll("thead th.ip_grid_columnSelectorCell"),p=document.getElementById(e+"_q3_table"),a=null==p?null:p.querySelectorAll("tbody tr.ip_grid_row"),p=document.getElementById(e+"_q2_table"),s=null==p?null:p.querySelectorAll("thead th.ip_grid_columnSelectorCell")}return o&&(t.rowLoaded_frozen=null!=l?l.length:t.rowCount_frozen,t.rowLoaded_scroll=null!=a?a.length:t.rowCount_scroll),i&&(t.colLoaded_frozen=null!=n?n.length:t.colCount_frozen,t.colLoaded_scroll=null!=s?s.length:t.colCount_scroll),t}function ip_IsCellLoaded(e,r,o,i){return null==i&&(i=ip_LoadedRowsCols(e,!1,!0,!1)),(r<i.rowFrom_frozen||r>i.rowTo_frozen)&&(r<i.rowFrom_scroll||r>i.rowTo_scroll)||(o<i.colFrom_frozen||o>i.colTo_frozen)&&(o<i.colFrom_frozen||o>i.colTo_scroll)?void 0:!0}function ip_IsRowLoaded(e,r,o,i){return null==o&&(o=ip_LoadedRowsCols(e,!1,!0,!1)),null==i&&(i=!1),(i||r<o.rowFrom_frozen||r>o.rowTo_frozen)&&(r<o.rowFrom_scroll||r>o.rowTo_scroll)?!1:!0}function ip_IsColLoaded(e,r,o,i){return null==o&&(o=ip_LoadedRowsCols(e,!1,!1,!0)),null==i&&(i=!1),(i||r<o.colFrom_frozen||r>o.colTo_frozen)&&(r<o.colFrom_scroll||r>o.colTo_scroll)?!1:!0}function ip_RecalculateLoadedRowsCols(e,r,o,i){ip_LoadedRowsCols(e);if(o)if(r)r&&ip_ReRenderRows(e);else{for(var t=10,l=ip_GridProps[e].dimensions.gridHeight-ip_GridProps[e].dimensions.columnSelectorHeight-ip_GridProps[e].dimensions.defaultBorderHeight-t,n=0,a=0,s=0;s<ip_GridProps[e].frozenRows;s++)a++,n+=ip_RowHeight(e,s,!0),n>l&&(a--,s=ip_GridProps[e].rows);for(var s=ip_GridProps[e].scrollY;s<ip_GridProps[e].rows;s++)a++,n+=ip_RowHeight(e,s,!0),l>n||(s=ip_GridProps[e].rows);ip_GridProps[e].loadedRows=a}if(i){for(var p=10,d=ip_GridProps[e].dimensions.gridWidth-ip_GridProps[e].dimensions.rowSelectorWidth-ip_GridProps[e].dimensions.defaultBorderHeight-p,c=0,_=0,u=0;u<ip_GridProps[e].frozenCols;u++)_++,c+=ip_ColWidth(e,u,!0),c>d&&(_--,u=ip_GridProps[e].cols);for(var u=ip_GridProps[e].scrollX;u<ip_GridProps[e].cols;u++)_++,c+=ip_ColWidth(e,u,!0),d>c||(u=ip_GridProps[e].cols);ip_GridProps[e].loadedCols=_}}function ip_BorderSize(e,r){$("#"+e+" .ip_grid").css("border-right",r),$("#"+e+" .ip_grid_columnSelectorCell").css("border-bottom",r),$("#"+e+" .ip_grid_columnSelectorCell").css("border-left",r),$("#"+e+" .ip_grid_columnSelectorCell").css("border-top",r),$("#"+e+" .ip_grid_columnSelectorCellCorner").css("border-bottom",r),$("#"+e+" .ip_grid_columnSelectorCellCorner").css("border-left",r),$("#"+e+" .ip_grid_columnSelectorCellCorner").css("border-top",r),$("#"+e+" .ip_grid_rowSelecterCell").css("border-bottom",r),$("#"+e+" .ip_grid_rowSelecterCell").css("border-left",r),$("#"+e+" .ip_grid_cell").css("border-bottom",r),$("#"+e+" .ip_grid_cell").css("border-left",r),$("#"+e).ip_Scrollable()}function ip_RowHeight(e,r,o){if(0>r)return 0;var i=ip_GridProps[e].rowData[r],t=""==i.height||null==i.height?ip_GridProps[options.GridID].dimensions.defaultRowHeight:i.height;return i.hide&&(t=0,o=!1),r>=0&&r<ip_GridProps[e].rows&&o&&(t+=ip_GridProps[e].dimensions.defaultBorderHeight),t}function ip_ColWidth(e,r,o){if(0>r)return 0;var i=ip_GridProps[e].colData[r],t=""==i.width||null==i.width?ip_GridProps[e].dimensions.defaultColWidth:i.width;return i.hide&&(t=0,o=!1),r>=0&&r<ip_GridProps[e].cols&&o&&(t+=ip_GridProps[e].dimensions.defaultBorderHeight),t}function ip_CompareRow(e,r,o,i){return null==r&&(r=0),null==o&&(o="az"),"az"==o?function(o,t){var l=i?o.cells[r].groupValue:o.cells[r].value,n=i?t.cells[r].groupValue:t.cells[r].value,a=o.cells[r].row,s=t.cells[r].row;if(null==o.cells[r].merge||i||(l=ip_GridProps[e].rowData[o.cells[r].merge.mergedWithRow].cells[o.cells[r].merge.mergedWithCol].value),null==t.cells[r].merge||i||(n=ip_GridProps[e].rowData[t.cells[r].merge.mergedWithRow].cells[t.cells[r].merge.mergedWithCol].value),null==l||""==l)return 1;if(null==n||""==n)return-1;isNaN(parseFloat(l))||(l=parseFloat(l)),isNaN(parseFloat(n))||(n=parseFloat(n));var p=typeof l,d=typeof n;return"object"==p&&(p="date"),"object"==d&&(d="date"),"string"==p&&(l=l.toLowerCase()),"string"==d&&(n=n.toLowerCase()),"string"==p&&"date"==d?-1:"date"==p&&"string"==d?1:("number"==p&&"date"==d&&(n=n.getFullYear()),"date"==p&&"number"==d&&(l=l.getFullYear()),"number"==typeof l&&"object"==typeof n?1:"object"==typeof l&&"number"==typeof n?-1:"string"==p&&"number"==d?-1:"number"==p&&"string"==d?1:n>l?-1:l>n?1:s>a?-1:a>s?1:0)}:function(o,t){var l=i?o.cells[r].groupValue:o.cells[r].value,n=i?t.cells[r].groupValue:t.cells[r].value,a=o.cells[r].row,s=t.cells[r].row;if(null==o.cells[r].merge||i||(l=ip_GridProps[e].rowData[o.cells[r].merge.mergedWithRow].cells[o.cells[r].merge.mergedWithCol].value),null==t.cells[r].merge||i||(n=ip_GridProps[e].rowData[t.cells[r].merge.mergedWithRow].cells[t.cells[r].merge.mergedWithCol].value),null==l||""==l)return 1;if(null==n||""==n)return-1;isNaN(parseFloat(l))||(l=parseFloat(l)),isNaN(parseFloat(n))||(n=parseFloat(n));var p=typeof l,d=typeof n;return"object"==p&&(p="date"),"object"==d&&(d="date"),"string"==p&&(l=l.toLowerCase()),"string"==d&&(n=n.toLowerCase()),"string"==p&&"date"==d?1:"date"==p&&"string"==d?-1:("number"==p&&"date"==d&&(n=n.getFullYear()),"date"==p&&"number"==d&&(l=l.getFullYear()),"string"==p&&"number"==d?1:"number"==p&&"string"==d?-1:l>n?-1:n>l?1:s>a?-1:a>s?1:0)}}function ip_ValidateUndo(e,r,o,i){var t=0;if(null!=o)for(var l=0;l<o.length;l++)t+=(o[l].endRow-o[l].startRow+1)*(o[l].endCol-o[l].startCol+1);return ip_GridProps[e].undo.maxUndoRangeSize>t?(i&&ip_ClearUndoStack(e),!1):!0}function ip_AddUndo(e,r,o,i,t,l,n,a,s){if(null==t&&(t=ip_rangeObject()),null==t.endRow&&(t.endRow=t.startRow),null==t.endCol&&(t.endCol=t.startCol),null==ip_GridProps[e].undo.undoStack[o]){var p=Object.keys(ip_GridProps[e].undo.undoStack).length,d=p;p<ip_GridProps[e].undo.maxTransactions||(d=ip_TrimUndoStack(e)+1),ip_GridProps[e].undo.undoStack[o]={transactionID:o,transactionSeq:d,method:r,transactions:[]}}return a=null==a?ip_GridProps[e].undo.undoStack[o].transactions.length:a,ip_GridProps[e].undo.undoStack[o].transactions[a]={},null!=i&&(ip_GridProps[e].undo.undoStack[o].transactions[a].transactionType=i),null!=t.startRow&&(ip_GridProps[e].undo.undoStack[o].transactions[a].startRow=t.startRow),null!=t.startCol&&(ip_GridProps[e].undo.undoStack[o].transactions[a].startCol=t.startCol),null!=t.endRow&&(ip_GridProps[e].undo.undoStack[o].transactions[a].endRow=t.endRow),null!=t.endCol&&(ip_GridProps[e].undo.undoStack[o].transactions[a].endCol=t.endCol),null!=l&&(ip_GridProps[e].undo.undoStack[o].transactions[a].RevertSelectRange=l),null!=n&&(ip_GridProps[e].undo.undoStack[o].transactions[a].RevertSelectCell=n),ip_GridProps[e].undo.undoStack[o].transactions[a].dataIndex={},ip_GridProps[e].undo.undoStack[o].transactions[a].data=[],ip_GridProps[e].undo.undoStack[o].transactions[a].index=a,null!=s&&ip_AddUndoTransactionData(e,ip_GridProps[e].undo.undoStack[o].transactions[a],s),ip_GridProps[e].undo.undoStack[o].transactions[a]}function ip_AddUndoTransactionData(e,r,o){if(null!=r){if("CellData"==r.transactionType&&null!=o.row&&null!=o.col){if(null!=r.dataIndex[o.row+"-"+o.col])return;r.dataIndex[o.row+"-"+o.col]=r.data.length}"function"==typeof o?r.data=o:r.data[r.data.length]=o}}function ip_UndoTransaction(e,r,o,i){var t={success:!1,rowDataLoading:!1,method:""};if(null!=ip_GridProps[e].undo.undoStack[r]){var o=[],l=null,n="rows";switch(t.method=ip_GridProps[e].undo.undoStack[r].method,ip_GridProps[e].undo.undoStack[r].method){case"ip_InsertCol":n="cols";break;case"ip_AddCol":n="cols";break;case"ip_RemoveCol":n="cols";break;case"ip_MoveCol":n="cols";break;case"ip_ResizeColumn":n="cols";break;case"ip_HideShowColumns":n="cols";break;case"ip_SetColDataType":n="cols"}for(var a=ip_GridProps[e].undo.undoStack[r].transactions.length-1;a>=0;a--){var s=ip_GridProps[e].undo.undoStack[r].transactions[a];if("undoServer"==s.transactionType)t.rowDataLoading=!0;else if("function"==s.transactionType)"function"==typeof s.data&&s.data();else if("CellData"==s.transactionType){for(var p=s.startRow;p<=s.endRow;p++)for(var d=s.startCol;d<=s.endCol;d++)ip_ResetCell(e,p,d,!0,!0,!1);for(var d=0;d<s.data.length;d++){var c=s.data[d].row,_=s.data[d].col,u=ip_GridProps[e].rowData[c].cells[_].merge;ip_ResetCell(e,c,_,!0,!0,!1),ip_GridProps[e].rowData[c].cells[_]=s.data[d],ip_GridProps[e].rowData[c].cells[_].merge=u,ip_SetCellFormula(e,{row:c,col:_,formula:ip_GridProps[e].rowData[c].cells[_].formula})}}else if("MergeData"==s.transactionType){for(var g=ip_ValidateRangeMergedCells(e,s.startRow,s.startCol,s.endRow,s.endCol),w=0;w<g.merges.length;w++)g.merges[w].containsOverlap||ip_ResetCellMerge(e,g.merges[w].mergedWithRow,g.merges[w].mergedWithCol);for(var w=0;w<s.data.length;w++){var f=s.data[w].mergedWithRow,h=s.data[w].mergedWithCol,m=f+s.data[w].rowSpan-1,v=h+s.data[w].colSpan-1;ip_ResetCellMerge(e,f,h),ip_SetCellMerge(e,f,h,m,v)}}else if("ColData"==s.transactionType)for(var d=0;d<s.data.length;d++){var _=s.data[d].col,C=ip_GridProps[e].colData[_].containsMerges;ip_GridProps[e].colData[_]=s.data[d],ip_GridProps[e].colData[_].containsMerges=C}else if("RowData"==s.transactionType)for(var p=0;p<s.data.length;p++){var c=s.data[p].row,C=ip_GridProps[e].rowData[c].containsMerges,R=ip_GridProps[e].rowData[c].cells;ip_GridProps[e].rowData[c]=s.data[p],ip_GridProps[e].rowData[c].cells=R,ip_GridProps[e].rowData[c].containsMerges=C}o&&null!=s.RevertSelectCell&&(l={row:s.RevertSelectCell.row,col:s.RevertSelectCell.col}),o&&null!=s.RevertSelectRange&&(o[o.length]=s.RevertSelectRange)}delete ip_GridProps[e].undo.undoStack[r],i&&("cols"==n?ip_ReRenderCols(e):ip_ReRenderRows(e),$("#"+e).ip_Scrollable(),ip_RePoistionRanges(e,"all",!1,!0)),null!=l&&$("#"+e).ip_SelectCell({row:l.row,col:l.col,multiselect:!1,scrollTo:!0,selectAsRange:!1});for(var p=0;p<o.length;p++)if(-1==o[p].startRow&&-1==o[p].startCol)$("#"+e).ip_SelectColumn({multiselect:!1,col:-1}),$("#"+e).ip_SelectRow({multiselect:!0,row:-1,fetchRange:!1});else if(-1==o[p].startRow)for(var _=o[p].startCol;_<=o[p].endCol;_++)$("#"+e).ip_SelectColumn({col:_,multiselect:!0});else if(-1==o[p].startCol)for(var c=o[p].startRow;c<=o[p].endRow;c++)$("#"+e).ip_SelectRow({row:c,multiselect:!0});else $("#"+e).ip_SelectRange({range:o[p],multiselect:!0});t.success=!0}return t}function ip_TrimUndoStack(e){var r=-1,o=-1,i="",t="";for(var l in ip_GridProps[e].undo.undoStack){var n=ip_GridProps[e].undo.undoStack[l].transactionSeq;(-1==r||r>n)&&(r=n,i=l),(-1==o||n>o)&&(o=n,t=l)}return delete ip_GridProps[e].undo.undoStack[i],o}function ip_ClearUndoStack(e){if(null!=ip_GridProps[e])for(var r in ip_GridProps[e].undo.undoStack)delete ip_GridProps[e].undo.undoStack[r]}function ip_GetGroupedRows(e){for(var r={rowData:{}},o=[],i=0;i<ip_GridProps[e].rows;i++)o.length>0&&(r.rowData[i]=ip_CloneRow(e,i),r.rowData[i].groupedWithRow=o[o.length-1].row,r.rowData[i].groupCountDown=o[o.length-1].groupCountDown,r.rowData[i].groupCount=o[o.length-1].groupCount,r.rowData[i].groupHeader=!1,o[o.length-1].groupCountDown--,0==o[o.length-1].groupCountDown&&o.splice(o.length-1,1)),null!=ip_GridProps[e].rowData[i].groupCount&&ip_GridProps[e].rowData[i].groupCount>0&&(o[o.length]={row:i,groupCountDown:ip_GridProps[e].rowData[i].groupCount,groupCount:ip_GridProps[e].rowData[i].groupCount},r.rowData[i]=ip_CloneRow(e,i),r.rowData[i].groupedWithRow=i,r.rowData[i].groupCountDown=ip_GridProps[e].rowData[i].groupCount+1,r.rowData[i].groupCount=ip_GridProps[e].rowData[i].groupCount+1,r.rowData[i].groupHeader=!0);return r}function ip_ChangeHue(e,r,o,i){if(""==e)return"";var t=ip_rgbToHSL(e);return null!=r&&(t.h+=r),null!=o&&(t.l=o),null!=i&&(t.l-i>0?t.l-=i:t.l+=i,t.l<0&&(t.l=0),t.l>1&&(t.l=1)),t.h>360?t.h-=360:t.h<0&&(t.h+=360),t.l>1?t.l-=1:t.l<0&&(t.l+=1),ip_hslToRGB(t)}function ip_rgbToHSL(e){e=e.replace(/^\s*#|\s*$/g,""),3==e.length&&(e=e.replace(/(.)/g,"$1$1"));var r=parseInt(e.substr(0,2),16)/255,o=parseInt(e.substr(2,2),16)/255,i=parseInt(e.substr(4,2),16)/255,t=Math.max(r,o,i),l=Math.min(r,o,i),n=t-l,a=(t+l)/2,s=0,p=0;return s=0==n?0:t==r?60*((o-i)/n%6):t==o?60*((i-r)/n+2):60*((r-o)/n+4),p=0==n?0:n/(1-Math.abs(2*a-1)),{h:s,s:p,l:a}}function ip_hslToRGB(e){var r,o,i,t=e.h,l=e.s,n=e.l,a=(1-Math.abs(2*n-1))*l,s=a*(1-Math.abs(t/60%2-1)),p=n-a/2;return 60>t?(r=a,o=s,i=0):120>t?(r=s,o=a,i=0):180>t?(r=0,o=a,i=s):240>t?(r=0,o=s,i=a):300>t?(r=s,o=0,i=a):(r=a,o=0,i=s),r=ip_Normalize_rgb_value(r,p),o=ip_Normalize_rgb_value(o,p),i=ip_Normalize_rgb_value(i,p),ip_rgbToHex(r,o,i)}function ip_rgbToHex(e,r,o){return"#"+((1<<24)+(e<<16)+(r<<8)+o).toString(16).slice(1)}function ip_Normalize_rgb_value(e,r){return e=Math.floor(255*(e+r)),0>e&&(e=0),e}function ip_parseBool(e){return null==e?!1:1==e?!0:("string"==typeof e&&(e=e.toLowerCase()),"true"==e?!0:"1"==e?!0:1==e?!0:!1)}function ip_parseDate(e,r){if("[object Date]"===Object.prototype.toString.call(e))return isNaN(e.getTime())?Number.NaN:new Date(e);if(null==e)return new Date(e);if("string"==typeof e){if(null!=r&&(r=r.trim().toLowerCase()),e=e.replace(/\//gi,"-"),e=e.toLowerCase().trim(),(null==r||"full"==r)&&!(""+e).match(/^\d+(\.\d{1,2})?$/)){var o=new Date(e);if("Invalid Date"!=o)return o}var i,t=[],l={jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11,ocx:9,january:0,february:1,march:2,april:3,may:4,june:5,july:6,august:7,september:8,october:9,november:10,december:11},n="z"==e[e.length-1]?!0:!1,a=n?-(new Date).getTimezoneOffset()/60:0;if((null==r||"yyyy-mm-dd"==r)&&(i=/20\d{2}(-|\/)((0[1-9])|(1[0-2]))(-|\/)((0[1-9])|([1-2][0-9])|(3[0-1]))((T|\s)(([0-1][0-9])|(2[0-3])):([0-5][0-9])(:([0-5][0-9]))?)?/gi,e.match(i))){if(t=e.split(/[-t\s:.z]/),t.length<=3)return new Date(parseInt(t[0]),parseInt(t[1])-1,parseInt(t[2]));
    if(t.length<=5)return new Date(parseInt(t[0]),parseInt(t[1])-1,parseInt(t[2]),parseInt(t[3])+a,parseInt(t[4]));if(t.length>=6)return new Date(parseInt(t[0]),parseInt(t[1])-1,parseInt(t[2]),parseInt(t[3])+a,parseInt(t[4]),parseInt(t[5]))}if((null==r||"mm-dd-yyyy"==r)&&(i=/^(((((((0?[13578])|(1[02]))[\.\-/]?((0?[1-9])|([12]\d)|(3[01])))|(((0?[469])|(11))[\.\-/]?((0?[1-9])|([12]\d)|(30)))|((0?2)[\.\-/]?((0?[1-9])|(1\d)|(2[0-8]))))[\.\-/]?(((19)|(20))?([\d][\d]))))|((0?2)[\.\-/]?(29)[\.\-/]?(((19)|(20))?(([02468][048])|([13579][26])))))((T|\s)(([0-1][0-9])|(2[0-3])):([0-5][0-9])(:([0-5][0-9]))?)?$/gi,e.match(i))){if(t=e.split(/[-t\s:.z]/),t.length<=3)return new Date(parseInt(t[2]),parseInt(t[0])-1,parseInt(t[1]));if(t.length<=5)return new Date(parseInt(t[2]),parseInt(t[0])-1,parseInt(t[1]),parseInt(t[3])+a,parseInt(t[4]));if(t.length>=6)return new Date(parseInt(t[2]),parseInt(t[0])-1,parseInt(t[1]),parseInt(t[3])+a,parseInt(t[4]),parseInt(t[5]))}if((null==r||"dd-mon-yyyy"==r)&&(i=/^((31(?! (FEB|APR|JUN|SEP|NOV)))|((30|29)(?! FEB))|(29(?= FEB (((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00)))))|(0?[1-9])|1\d|2[0-8])[-\s](JAN|FEB|MAR|MAY|APR|JUL|JUN|AUG|OCT|SEP|NOV|DEC)[-\s]((1[6-9]|[2-9]\d)\d{2})((T|\s)(([0-1][0-9])|(2[0-3])):([0-5][0-9])(:([0-5][0-9]))?)?$/gi,e.match(i))){if(e=e.replace(/oct/,"ocx"),t=e.split(/[-t\s:]/),t.length<=3)return new Date(parseInt(t[2]),l[t[1]],parseInt(t[0]));if(t.length<=5)return new Date(parseInt(t[2]),l[t[1]],parseInt(t[0]),parseInt(t[3])+a,parseInt(t[4]));if(t.length>=6)return new Date(parseInt(t[2]),l[t[1]],parseInt(t[0]),parseInt(t[3])+a,parseInt(t[4]),parseInt(t[5]))}}return Number.NaN}function ip_parseNumber(e,r){return null==e?0/0:"string"==typeof e&&e.match(/[^.0-9%]/)?0/0:(e=parseFloat(e),null!=r?e.toFixed(r):e)}function ip_parseCurrency(e,r){if(null==e)return null;var o=e;if("string"==typeof e){var o=e.replace(/[$R]/gi,"");if(o.match(/[^.0-9]/))return 0/0}var i=ip_parseNumber(o,r);return i}function ip_parseString(e){return null==e?"":""+e}function ip_parseRange(e,r){return null==r||""==r||isNaN(r)?null:ip_fxRangeObject(e,null,null,r.trim())}function ip_parseAny(e,r){var o=null;return null==r?r:(o=ip_parseDate(r))?o:(o=ip_parseBool(r))?o:(o=ip_parseNumber(r))?o:(o=ip_parseRange(e,r))?o:ip_parseString(r)}function ip_formatDate(e,r,o,i){var t=ip_parseDate(r,o);if(!t&&o&&e&&(t=ip_GridProps[e].mask.input[o](r)),t||(t=ip_parseDate(r)),!t)return!1;try{var l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=t.getDate(),a=t.getMonth()+1,s=t.getFullYear(),p=t.getHours(),d=t.getMinutes(),c=t.getSeconds(),_=""+n,u=""+a,g=l[a-1],w=""+s,f=""+p,h=""+d,m=""+c;if(10>n&&(_="0"+n),10>a&&(u="0"+a),10>p&&(f="0"+p),10>d&&(h="0"+d),10>c&&(m="0"+c),null==i&&(mask="yyyy-mm-dd"),"yyyy-mm-dd"==i)return w+"-"+u+"-"+_;if("yyyy-mm-dd hh:mm"==i)return w+"-"+u+"-"+_+" "+f+":"+h;if("yyyy-mm-dd hh:mm:ss"==i)return w+"-"+u+"-"+_+" "+f+":"+h+":"+m;if("dd-mon-yyyy"==i)return _+"-"+g+"-"+w;if("full"==i)return""+t}catch(v){return!1}return r}function ip_formatNumber(e,r,o,i,t){if(null==r||""==r)return r;var l=(""+r).replace(/[\s,R$]/gi,"");if(o&&e){if(l=ip_GridProps[e].mask.input[o](l),isNaN(l))return!1;l=null==l?"":""+l}l=l.split(".");var n=l.length>1?"."+l[1]:void 0!=t?".":"";if(void 0==t||0<t){if(void 0!=t&&n.length-1>t)n=n.substring(0,t+1);else if(void 0!=t&&n.length-1<t)for(var a=n.length-1;t>a;a++)n+="0"}else n="";return"123"==i?l[0]+n:"1 000 000.00"==i?l[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1 ")+n:"1,000,000.00"==i?l[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+n:r}function ip_formatCurrency(e,r,o,i,t){var l=r;if("$1,000,000.00"==i){if(l=ip_formatNumber(e,r,o,"1,000,000.00",t),0==l)return!1;l="$"+l}if("R1,000,000.00"==i){if(l=ip_formatNumber(e,r,o,"1,000,000.00",t),0==l)return!1;l="R"+l}return l}function ip_FocusGrid(e,r){var o=ip_GenerateTransactionID(),i=ip_GridProps.index.focusedGrid;(i!=e||r)&&(ip_GridProps.index.focusedGrid=e,ip_RaiseEvent(e,"ip_FocusGrid",o,{FocusGrid:{Inputs:null,Effected:{GridID:e}}}))}function ip_GetCursorPos(e,r){var o=0,i=0,t="";if(null!=r)if(ip_GridProps[e].editing.selectionState||ip_EnableSelection(e),void 0!==window.getSelection)try{var l=window.getSelection&&window.getSelection(),n=l.getRangeAt(0);t=""+n,i=t.length;var a=n.cloneRange();a.selectNodeContents(r),a.setEnd(n.endContainer,n.endOffset),o=(""+a).length}catch(s){}else if(void 0!==document.selection&&"Control"!=document.selection.type){var p=document.selection.createRange();t=""+p,i=t.length;var d=document.body.createTextRange();d.moveToElementText(r),d.setEndPoint("EndToEnd",p),o=d.text.length}return{x:o-i,length:i,text:t}}function ip_SetCursorPos(e,r,o,i){var t={x:o,length:0,text:""};if(null!=r){if(void 0==ip_GridProps[e]||ip_GridProps[e].editing.selectionState||ip_EnableSelection(e),t.text=r.innerText||r.textContent,t.text.length<=o||null==o&&null==i){var l=document.createRange();l.selectNodeContents(r),l.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(l),t.x=t.text.length}else{for(var a,s=document.createRange(),p=getSelection(),d=0,c=0,_=document.createTreeWalker(r,NodeFilter.SHOW_TEXT,null,null);a=_.nextNode();)if(d+=a.nodeValue.length,d>o&&(t.x=a.nodeValue.length+o-d,s.setStart(a,t.x),o=1/0),null!=i&&d>=i){c=a.nodeValue.length+i-d,s.setEnd(a,c);break}p.removeAllRanges(),p.addRange(s)}return t.length=c-t.x,t.length<0&&(t.length=0),t}return null}function ip_EnableSelection(e,r){$(document).enableSelection(),r&&document.getSelection().removeAllRanges(),ip_GridProps[e].editing.selectionState=!0}function ip_DisableSelection(e,r){try{r&&document.getSelection().removeAllRanges(),$(document).disableSelection(),ip_GridProps[e].editing.selectionState=!1}catch(o){console.warn(o)}}function ip_AppendEffectedRowData(e,r,o){var i=0;return null==r.rowData?(r.rowData=[],i=0):r.rowData.length>0&&null!=r.rowData[i].cells&&r.rowData[i].cells.length==ip_GridProps[e].cols?i++:r.rowData.length>0&&null!=r.rowData[i].cells&&(i=r.rowData.length-1),null==r.rowData[i]&&(r.rowData[i]={cells:[]}),r.rowData[i].cells[r.rowData[i].cells.length]=o,r}function ip_PurgeEffectedRowData(e,r){if(null==r.rowData)return r;for(var o={},i=r.rowData.length-1;i>=0;i--){for(var t=r.rowData[i],l=t.cells.length-1;l>=0;l--){var n=t.cells[l].row+"-"+t.cells[l].col;null==o[n]?o[n]=!0:t.cells.splice(l,1)}0==t.cells.length&&r.rowData.splice(i,1)}return r}function replaceAt(e,r,o,i,t){return r.substr(0,o)+t+r.substr(o+i.length)}function ip_Browser(){var e={name:"",version:""};return e.name="Microsoft Internet Explorer"==navigator.appName||window.MSStream?"ie":navigator.appName,e.version=-1!=navigator.appVersion.indexOf("MSIE 10")?10:-1!=navigator.appVersion.indexOf("MSIE 9")?9:-1!=navigator.appVersion.indexOf("MSIE 8")?8:-1!=navigator.appVersion.indexOf("MSIE 7")?7:-1!=navigator.appVersion.indexOf("MSIE 6")?6:navigator.appVersion,e}function ip_RaiseEvent(e,r,o,i){switch(r){case"warning":ip_ShowFooterAlert("hmmm",i,"","red",3e3);break;case"message":ip_ShowFooterAlert("hmmm",i,"","lightblue",3e3);break;case"error":ip_ShowFooterAlert("hmmm",i,"","red",3e3);break;case"ip_CellInput":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_SetCellValues":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_ResizeColumn":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_ResizeRow":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_ColumnSelector":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_RowSelector":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_RemoveRow":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_AddRow":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_InsertRow":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_RemoveCol":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_AddCol":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_InsertCol":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_FrozenRowsCols":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_MoveCol":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_MoveRow":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_MergeRange":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_UnMergeRange":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_Paste":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_ResetRange":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_ScrollComplete":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_Sort":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_Undo":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_HideShowRows":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_HideShowColumns":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_GroupRows":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_UngroupRows":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_FormatColumn":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_FormatCell":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_DragRange":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_SelectCell":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_SelectColumn":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_SelectRow":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_SelectRange":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_ResizeGrid":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_DisposeGrid":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_Border":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_GridMeta":$("#"+e).trigger(r,ip_eventObject(e,r,o,i));break;case"ip_FocusGrid":$("#"+e).trigger(r,ip_eventObject(e,r,o,i))}}function ip_UnbindAllEvents(e){$("#"+e).find("*").andSelf().unbind(),null!=ip_GridProps[e]&&(ip_GridProps[e].events.SetupEvents_document_mouseup=ip_UnBindEvent(document,"mouseup",ip_GridProps[e].events.SetupEvents_document_mouseup),ip_GridProps[e].events.SetupEvents_document_keydown=ip_UnBindEvent(document,"keydown",ip_GridProps[e].events.SetupEvents_document_keydown),ip_GridProps[e].events.SetupEvents_document_keyup=ip_UnBindEvent(document,"keyup",ip_GridProps[e].events.SetupEvents_document_keyup))}function ip_UnBindEvent(e,r,o){return null!=o&&($(e).unbind(r,o),o=null),null}function ip_SetHoverCell(e,r,o,i){if(i=null==i?!1:i,"ie"==ip_GridProps.index.browser.name||i)for(var t=0,l=[],n=o.clientX,a=o.clientY,s=null;50>t;){l[t]=r,$(r).hide();var o=document.elementFromPoint(n,a);if(s=""==o.id?o.parentNode:o,s.id.indexOf("_columnSelectorCell")>-1||s.id.indexOf("_rowSelecterCell")>-1||s.id.indexOf("_cell")>-1){for(var p=0;p<l.length;p++)$(l[p]).show();return ip_GridProps[e].hoverCell=s,s}r=s,t++}return $(l).show(),null}function ip_ReplaceInTags(e,r,o,i,t,l){var n=r,a=r.indexOf(o);return 0>a?""!=t&&(n+=o+t+i):(EndI=r.indexOf(i,a),-1==EndI&&(EndI=r.length),l&&""==t?(n=r.substring(a,EndI+1),n=r.replace(n,"")):(n=r.substring(a,EndI),n=r.replace(n,o+t))),n}function ip_ReplaceCssProperty(e,r,o,i){var t=!1,l="";null==r&&(r="");for(var n=r.split(";"),a=0;a<n.length;a++){var s=n[a].split(":");s.length>1&&(s[0]==o?(l+=o+":"+i+";",t=!0):l+=s[0]+":"+s[1]+";")}return t||(l+=o+":"+i+";"),l}function debugtext(e,r){r&&(e=e+"<br />"+$("#output").html()),$("#output").html(e)}function ouputmerges(e,r){if(debugtext(""),null==r||"col"==r){debugtext("COL-INDEX ",!0),debugtext("",!0);for(var o=0;o<ip_GridProps[e].cols;o++)if(null!=ip_GridProps[e].colData[o].containsMerges)for(var i=0;i<ip_GridProps[e].colData[o].containsMerges.length;i++){var t=ip_GridProps[e].colData[o].containsMerges[i];debugtext("COLUMN "+o,!0),debugtext("merge : "+t.mergedWithRow+" x "+t.mergedWithCol,!0),debugtext("rspan : "+t.rowSpan,!0),debugtext("cspan : "+t.colSpan,!0),debugtext("--------------------------------",!0)}}if(null==r||"row"==r){debugtext("",!0),debugtext("",!0),debugtext("ROW-INDEX ",!0),debugtext("",!0);for(var l=0;l<ip_GridProps[e].rows;l++)if(null!=ip_GridProps[e].rowData[l].containsMerges)for(var i=0;i<ip_GridProps[e].rowData[l].containsMerges.length;i++){var t=ip_GridProps[e].rowData[l].containsMerges[i];debugtext("ROW "+l,!0),debugtext("merge : "+t.mergedWithRow+" x "+t.mergedWithCol,!0),debugtext("rspan : "+t.rowSpan,!0),debugtext("cspan : "+t.colSpan,!0),debugtext("--------------------------------",!0)}}if(null==r||"cell"==r){debugtext("",!0),debugtext("",!0),debugtext("CELL-INDEX ",!0),debugtext("",!0);for(var l=0;l<ip_GridProps[e].rows;l++)for(var o=0;o<ip_GridProps[e].cols;o++)if(null!=ip_GridProps[e].rowData[l].cells[o].merge){var t=ip_GridProps[e].rowData[l].cells[o].merge;debugtext("CELL "+l+"x"+o,!0),debugtext("merge : "+t.mergedWithRow+" x "+t.mergedWithCol,!0),debugtext("rspan : "+t.rowSpan,!0),debugtext("cspan : "+t.colSpan,!0),debugtext("--------------------------------",!0)}}}function ip_GeneratePublicKey(){"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=16*Math.random()|0,o="x"==e?r:3&r|8;return o.toString(16)});var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=16*Math.random()|0,o="x"==e?r:3&r|8;return o.toString(16)});return e}function ip_GenerateTransactionID(){return ip_GeneratePublicKey()}function ip_ShowFooterAlert(e,r,o,i,t){null==i&&(i=""),null==t&&(t=5e3),$(document.body).ip_FooterDialog({Message:r,BackColor:i,Duration:t})}var ip_GridProps={},defaultRowHeight=25,defaultColWidth=100,loadedRowsThreshold={min:40,max:110},loadedColsThreshold={min:15,max:40},thisBrowser=ip_Browser();!function(e){ip_GridProps.index={browser:"",focusedGrid:"",regEx:{range:/(?=[^"]*(?:"[^"]*"[^"]*)*$)(([$a-z]+[$0-9]+:[$a-z]+[$0-9]+)|([$a-z]+[$0-9]+))(\#\w*)?/gi,notInBrackets:/(?![^(]*[,)])/gi,notInTags:/(?![^<]*[>])/gi,notInQuotes:/(?=[^"]*(?:"[^"]*"[^"]*)*$)/gi,inQuotes:/("(.*?)")/gi,words:/[\w\s"']+/gi,nonWords:/[^\w\s]/gi,fx:/(\w+)(?=\()/gi,operator:/\+|,|.|-|\*|\/|=|>|<|>=|<=|&|\||%|!|\^|\(|\)/,hashtag:/(\#\w*)/gi}},e.fn.ip_Grid=function(r){var r=e.extend({id:e(this).attr("id"),publicKey:null,rows:10,cols:10,frozenRows:0,frozenCols:0,showRowSelector:!0,showColSelector:!0,showGridResizerX:!0,rowData:[],colData:[],mergeData:[],dataTypes:[],ip_Grid:null,defaultColWidth:defaultColWidth,defaultRowHeight:defaultRowHeight,loading:!1,refresh:!1,scrollX:null,scrollY:null,hashTags:[],sheetName:"",onLoad:null},r);return r.refresh||ip_UnbindAllEvents(r.id),null!=ip_GridProps[r.id]&&(r.refresh&&(null==r.callbacks&&(r.callbacks=ip_GridProps[r.id].callbacks),null==r.scrollX&&(r.scrollX=ip_GridProps[r.id].scrollX),null==r.scrollY&&(r.scrollY=ip_GridProps[r.id].scrollY),null==r.showGridResizerX&&(r.showGridResizerX=ip_GridProps[r.id].showGridResizerX),r.frozenRows!=ip_GridProps[r.id].frozenRows&&(r.scrollY=r.scrollY>r.frozenRows?r.scrollY:r.frozenRows),r.frozenCols!=ip_GridProps[r.id].frozenCols&&(r.scrollX=r.scrollX>r.frozenCols?r.scrollX:r.frozenCols)),delete ip_GridProps[r.id]),ip_GridProps.index.browser=ip_Browser(),ip_GridProps[r.id]=e().ip_gridProperties({id:r.id,publicKey:r.publicKey,index:Object.keys(ip_GridProps).length,rows:r.rows,cols:r.cols,scrollX:r.scrollX,scrollY:r.scrollY,frozenRows:r.frozenRows,frozenCols:r.frozenCols,showRowSelector:r.showRowSelector,showColSelector:r.showColSelector,showGridResizerX:r.showGridResizerX,rowData:r.rowData,colData:r.colData,dataTypes:r.dataTypes,hashTags:r.hashTags,sheetName:r.sheetName,undo:{maxTransactions:r.maxUndoTransactions,maxUndoRangeSize:r.maxUndoRangeSize},dimensions:{defaultColWidth:r.defaultColWidth,defaultRowHeight:r.defaultRowHeight},callbacks:r.callbacks}),ip_ValidateData(r.id,r.rows,r.cols,r.loading),ip_CreateGrid(r),null!=r.onLoad&&(ip_GridProps[r.id].callbacks.onLoad=r.onLoad),"function"==typeof ip_GridProps[r.id].callbacks.onLoad&&ip_GridProps[r.id].callbacks.onLoad(),r.refresh||(e("#"+r.id).ip_ReCalculate(),ip_FocusGrid(r.id,!0)),e(this)},e.fn.ip_GridMeta=function(r){var r=e.extend({hashTags:null,parentKeys:null},r),o=e(this).attr("id"),i=ip_GenerateTransactionID(),t={gridData:{hashTags:r.hashTags,parentKeys:r.parentKeys}};null!=r.hashTags&&(ip_GridProps[o].hashTags=r.hashTags),null!=r.parentKeys&&(ip_GridProps[o].parentKeys=r.parentKeys),ip_RaiseEvent(o,"ip_GridMeta",i,{GridMeta:{Inputs:r,Effected:t}})},e.fn.ip_ResizeColumn=function(r){var r=e.extend({columns:[-1],size:ip_GridProps[e(this).attr("id")].dimensions.defaultColWidth},r),o=e(this).attr("id"),i=parseInt(r.size),t={colData:[]},l=ip_GenerateTransactionID();if(jQuery.inArray(-1,r.columns)>-1){{var n=ip_GridProps[o].dimensions.defaultColWidth,a={startRow:-1,startCol:-1,endRow:ip_GridProps[o].rows-1,endCol:ip_GridProps[o].cols-1},s=ip_AddUndo(o,"ip_ResizeColumn",l,"ColData",a,a,{row:a.startRow,col:a.startCol});ip_AddUndo(o,"ip_ResizeColumn",l,"function",a,null,null,null,function(){ip_GridProps[o].dimensions.defaultColWidth=n})}""!=r.size&&(ip_GridProps[o].dimensions.defaultColWidth=i,t.colData[t.colData.length]={col:-1,width:i});for(var p=0;p<ip_GridProps[o].cols;p++)if(ip_AddUndoTransactionData(o,s,ip_CloneCol(o,p)),""!=i&&i&&0/0!=i)ip_GridProps[o].colData[p].width=i;else{var d=parseInt(e("#"+o).ip_MinWidth(p));ip_GridProps[o].colData[p].width=d,t.colData[t.colData.length]={col:p,width:d}}ip_ReRenderCols(o,"frozen"),e(this).ip_Scrollable(),ip_ReRenderCols(o,"scroll")}else{for(var c=r.columns.length,_=0;c>_;_++){var u=parseInt(r.columns[_]),g=null==ip_GridProps[o].colData[u].hide?!1:ip_GridProps[o].colData[u].hide,w=u<ip_GridProps[o].frozenCols?1:2,f=o+"_q"+w+"_columnSelectorCell_"+u,h=o+"_q"+(1==w?"3":"4")+"_columnSelectorCell_"+u,m=e("#"+f),v=e("#"+h),a={startRow:-1,startCol:u,endRow:ip_GridProps[o].rows-1,endCol:u},s=ip_AddUndo(o,"ip_ResizeColumn",l,"ColData",a,a,{row:a.startRow,col:a.startCol},null,ip_CloneCol(o,u));""==r.size&&(i=e("#"+o).ip_MinWidth(u));var C=g?0:i-ip_GridProps[o].colData[u].width;ip_GridProps[o].colData[u].width=i,t.colData[t.colData.length]={col:u,width:i},m.length>0&&(u<ip_GridProps[o].frozenCols||(ip_GridProps[o].dimensions.accumulativeScrollWidth+=C),e(m).css("width",ip_ColWidth(o,u,!1)),e(v).css("width",ip_ColWidth(o,u,!1)))}e(this).ip_Scrollable(),ip_OptimizeLoadedCols(o)}ip_ShowColumnFrozenHandle(o,!0),ip_RePoistionRanges(o,"all",!0,!1),ip_RaiseEvent(o,"ip_ResizeColumn",l,{ResizeColumn:{Inputs:r,Effected:t}})},e.fn.ip_ResizeRow=function(r){var r=e.extend({rows:[-1],size:ip_GridProps[e(this).attr("id")].dimensions.defaultRowHeight},r),o=e(this).attr("id"),i={rowData:[]},t=""==r.size?ip_GridProps[o].dimensions.defaultRowHeight:parseInt(r.size),l=ip_GeneratePublicKey();if(jQuery.inArray(-1,r.rows)>-1){{var n=ip_GridProps[o].dimensions.defaultRowHeight,a={startRow:-1,startCol:-1,endRow:ip_GridProps[o].rows-1,endCol:ip_GridProps[o].cols-1},s=ip_AddUndo(o,"ip_ResizeRow",l,"RowData",a,a,{row:a.startRow,col:a.startCol});ip_AddUndo(o,"ip_ResizeRow",l,"function",a,null,null,null,function(){ip_GridProps[o].dimensions.defaultRowHeight=n})}""!=r.size&&(ip_GridProps[o].dimensions.defaultRowHeight=t),i.rowData[i.rowData.length]={row:-1,height:t};for(var p=0;p<ip_GridProps[o].rows;p++)ip_AddUndoTransactionData(o,s,ip_CloneRow(o,p)),ip_GridProps[o].rowData[p].height=""==r.size?t:t;ip_ReRenderRows(o,"frozen"),e(this).ip_Scrollable(),ip_ReRenderRows(o,"scroll")}else{for(var d=r.rows.length,p=0;d>p;p++){var c=parseInt(r.rows[p]),_=null==ip_GridProps[o].rowData[c].hide?!1:ip_GridProps[o].rowData[c].hide,u=_?0:t-ip_GridProps[o].rowData[c].height,g=c<ip_GridProps[o].frozenRows?1:3,w=o+"_q"+g+"_gridRow_"+c,f=o+"_q"+(1==g?"2":"4")+"_gridRow_"+c,h=e("#"+w),m=e("#"+f),a={startRow:c,startCol:-1,endRow:c,endCol:ip_GridProps[o].cols-1},s=ip_AddUndo(o,"ip_ResizeRow",l,"RowData",a,a,{row:a.startRow,col:a.startCol},null,ip_CloneRow(o,c));ip_GridProps[o].rowData[c].height=t,i.rowData[i.rowData.length]={row:c,height:t},h.length>0&&m.length>0&&(c<ip_GridProps[o].frozenRows||(ip_GridProps[o].dimensions.accumulativeScrollHeight+=u),e(h).css("max-height",ip_RowHeight(o,c,!1)),e(h).css("height",ip_RowHeight(o,c,!1)),e(m).css("max-height",ip_RowHeight(o,c,!1)),e(m).css("height",ip_RowHeight(o,c,!1)))}e(this).ip_Scrollable(),ip_OptimzeLoadedRows(o)}ip_ShowRowFrozenHandle(o,!0),ip_RePoistionRanges(o,"all",!1,!0),ip_RaiseEvent(o,"ip_ResizeRow",l,{ResizeRow:{Inputs:r,Effected:i}})},e.fn.ip_ColumnSelector=function(r){var r=e.extend({show:!1},r),o=e(this).attr("id"),i={gridData:{showColSelector:ip_GridProps[o].showColSelector}};r.show?(ip_GridProps[o].showColSelector=!0,i.gridData.showColSelector=ip_GridProps[o].showColSelector,e("#"+o+"_q1_container th.ip_grid_columnSelectorCellCorner div.ip_grid_cell_outerContent").css("display",""),e("#"+o+"_q1_container th.ip_grid_columnSelectorCellCorner").css("border-top",""),e("#"+o+"_q1_container th.ip_grid_columnSelectorCell div.ip_grid_cell_outerContent").css("display",""),e("#"+o+"_q1_container th.ip_grid_columnSelectorCell").css("border-top",""),e("#"+o+"_q2_container th.ip_grid_columnSelectorCellCorner div.ip_grid_cell_outerContent").css("display",""),e("#"+o+"_q2_container th.ip_grid_columnSelectorCellCorner").css("border-top",""),e("#"+o+"_q2_container th.ip_grid_columnSelectorCell div.ip_grid_cell_outerContent").css("display",""),e("#"+o+"_q2_container th.ip_grid_columnSelectorCell").css("border-top",""),e("#"+o+"_q1_gridRow_-1").css("height",ip_GridProps[o].dimensions.columnSelectorHeight+"px"),e("#"+o+"_q2_gridRow_-1").css("height",ip_GridProps[o].dimensions.columnSelectorHeight+"px"),ip_ShowRowFrozenHandle(o),ip_ShowColumnFrozenHandle(o)):(ip_GridProps[o].showColSelector=!1,i.gridData.showColSelector=ip_GridProps[o].showColSelector,e("#"+o+"_q1_container th.ip_grid_columnSelectorCellCorner div.ip_grid_cell_outerContent").css("display","none"),e("#"+o+"_q1_container th.ip_grid_columnSelectorCellCorner").css("border-top","none"),e("#"+o+"_q1_container th.ip_grid_columnSelectorCell div.ip_grid_cell_outerContent").css("display","none"),e("#"+o+"_q1_container th.ip_grid_columnSelectorCell").css("border-top","none"),e("#"+o+"_q2_container th.ip_grid_columnSelectorCellCorner div.ip_grid_cell_outerContent").css("display","none"),e("#"+o+"_q2_container th.ip_grid_columnSelectorCellCorner").css("border-top","none"),e("#"+o+"_q2_container th.ip_grid_columnSelectorCell div.ip_grid_cell_outerContent").css("display","none"),e("#"+o+"_q2_container th.ip_grid_columnSelectorCell").css("border-top","none"),e("#"+o+"_q1_gridRow_-1").css("height",""),e("#"+o+"_q2_gridRow_-1").css("height",""),0==ip_GridProps[o].frozenRows?e("#"+o+"_rowFrozenHandle").hide():ip_ShowRowFrozenHandle(o),e("#"+o+"_columnFrozenHandle").hide()),e(this).ip_Scrollable(),ip_OptimzeLoadedRows(o),ip_RePoistionRanges(o,"all",!1,!0),ip_RaiseEvent(o,"ip_ColumnSelector",null,{ColumnSelector:{Inputs:r,Effected:i}})},e.fn.ip_RowSelector=function(r){var r=e.extend({show:!1},r),o=e(this).attr("id"),i={gridData:{showRowSelector:ip_GridProps[o].showRowSelector}};r.show?(ip_GridProps[o].showRowSelector=!0,i.gridData.showRowSelector=ip_GridProps[o].showRowSelector,e("#"+o+"_q1_columnSelectorCell_-1").css("width",""),e("#"+o+"_q1_columnSelectorCell_-1").css("border-left",""),e("#"+o+"_q3_columnSelectorCell_-1").css("width",""),e("#"+o+"_q3_columnSelectorCell_-1").css("border-left",""),ip_ShowRowFrozenHandle(o),ip_ShowColumnFrozenHandle(o)):(ip_GridProps[o].showRowSelector=!1,i.gridData.showRowSelector=ip_GridProps[o].showRowSelector,e("#"+o+"_q1_columnSelectorCell_-1").css("width","0px"),e("#"+o+"_q1_columnSelectorCell_-1").css("border-left","none"),e("#"+o+"_q3_columnSelectorCell_-1").css("width","0px"),e("#"+o+"_q3_columnSelectorCell_-1").css("border-left","none"),e("#"+o+"_rowFrozenHandle").hide(),0==ip_GridProps[o].frozenCols?e("#"+o+"_columnFrozenHandle").hide():ip_ShowColumnFrozenHandle(o)),e(this).ip_Scrollable(),ip_RePoistionRanges(o,"all",!0,!1),ip_RaiseEvent(o,"ip_RowSelector",null,{RowSelector:{Inputs:r,Effected:i}})},e.fn.ip_CellHtml=function(r,o,i){var t=e(this).attr("id");return ip_CellHtml(t,r,o,i)},e.fn.ip_CellData=function(r,o){var i=e(this).attr("id");return ip_CellData(i,r,o)},e.fn.ip_MinWidth=function(r){for(var o=0,i=e(this).attr("id"),t="",l="",n=0;n<ip_GridProps[i].rows;n++){var a=null==ip_GridProps[i].rowData[n].cells[r].display?"":ip_GridProps[i].rowData[n].cells[r].display;a.length>o&&(t=a,o=t.length,l=null==ip_GridProps[i].rowData[n].cells[r].style?"":ip_GridProps[i].rowData[n].cells[r].style)}return""!=t?(e("#"+i+"_cellContentWidthTool").html(t),""!=l&&e("#"+i+"_cellContentWidthTool").attr("style","display:none;"+l),o=e("#"+i+"_cellContentWidthTool").width()):o=ip_GridProps[i].dimensions.defaultColWidth,parseInt(o)},e.fn.ip_Scrollable=function(r){var r=e.extend({scrollbarX:!0,scrollbarY:!0,scrollSpeed:.01,placementX:"container",placementY:"container",initX:!0,initY:!0},r),o=e(this).attr("id"),i=!0;return ip_SetQuadContainerWidth(o),i&&r.initX&&(i=ip_InitScrollX_Large(o,r.scrollSpeed,r.scrollbarX,r.scrollbarY,r.placementX,r.placementY)),i&&r.initY&&(i=ip_InitScrollY_Large(o,r.scrollSpeed,r.scrollbarY)),i},e.fn.ip_ScrollTo=function(r){var r=e.extend({row:null,col:null},r),o=e(this).attr("id");if(null!=r.col){var i=r.col;i<ip_GridProps[o].frozenCols?i=ip_GridProps[o].frozenCols:i>ip_GridProps[o].cols&&(i=ip_GridProps[o].cols-1),ip_ScrollToX(o,i,!0,"all","none")}if(null!=r.row){var t=r.row;t<ip_GridProps[o].frozenRows?t=ip_GridProps[o].frozenRows:t>ip_GridProps[o].rows&&(t=ip_GridProps[o].rows-1),ip_ScrollToY(o,t,!0,"all","none")}},e.fn.ip_SelectCell=function(r){var r=e.extend({row:null,col:null,cell:null,multiselect:!1,scrollIncrement:0,scrollTo:!1,direction:"",selectAsRange:!0,raiseEvent:!0,debug:!1},r),o=e(this).attr("id"),i=null,t=ip_GenerateTransactionID();if(null!=ip_GridProps[o].selectedCell||null!=r.cell||null!=r.row&&null!=r.col&&-1!=r.row&&-1!=r.col){r.multiselect||(e(this).ip_UnselectColumn(),e(this).ip_UnselectRow(),e(this).ip_RemoveRange()),null==r.row&&(r.row=null==ip_GridProps[o].selectedCell?0:ip_GridProps[o].selectedCell.row),null==r.col&&(r.col=null==ip_GridProps[o].selectedCell?0:ip_GridProps[o].selectedCell.col),r.row<0&&(r.row=0),r.row<ip_GridProps[o].rows||(r.row=ip_GridProps[o].rows-1),r.col<0&&(r.col=0),r.col<ip_GridProps[o].cols||(r.col=ip_GridProps[o].cols-1);var l=ip_GetNextMergedCell(o,r.row,r.col,r.direction);if(r.row=l.row,r.col=l.col,0!=r.scrollIncrement&&(r.row=ip_NextNonHiddenRow(o,r.row,null,r.row,r.scrollIncrement>0?"down":"up"),r.col=ip_NextNonHiddenCol(o,r.col,null,r.col,r.scrollIncrement>0?"right":"left")),1==r.scrollTo&&(ip_IsRowLoaded(o,r.row)||ip_ScrollToY(o,r.row-Math.ceil(ip_GridProps[o].loadedRows/2),!0),ip_IsColLoaded(o,r.col)||ip_ScrollToX(o,r.col-Math.ceil(ip_GridProps[o].loadedCols/2),!0)),r.scrollIncrement>0?ip_ScrollCell(o,r.direction,r.row-1,r.col,null,null,r.scrollIncrement,"ip_grid_cell_rangeHighlight"):r.scrollIncrement<0&&ip_ScrollCell(o,r.direction,r.row,r.col,null,null,r.scrollIncrement,"ip_grid_cell_rangeHighlight"),null!=r.cell?(i=r.cell,r.row=parseInt(e(i).attr("row")),r.col=parseInt(e(i).attr("col"))):i=ip_CellHtml(o,r.row,r.col,!0),r.multiselect&&0!=ip_GridProps[o].selectedRange.length||(ip_GridProps[o].selectedCell=i,ip_GridProps[o].selectedCell.row=r.row,ip_GridProps[o].selectedCell.col=r.col,ip_SetFxBarValue(o,{cell:i}),e(this).ip_RangeHighlight({startCell:i,multiselect:r.multiselect})),r.selectAsRange&&e(this).ip_SelectRange({startCell:i,multiselect:r.multiselect}),e("#"+o).focus(),r.raiseEvent){var n={row:r.row,col:r.col,cell:r.cell};ip_RaiseEvent(o,"ip_SelectCell",t,{SelectCell:{Inputs:r,Effected:n}})}}else{if(ip_GridProps[o].selectedColumn.length>0||-1==r.col)return void e("#"+o).ip_SelectColumn({col:null!=r.col?r.col:ip_GridProps[o].selectedColumn[0],count:ip_GridProps[o].selectedColumn.length,unselect:null!=r.col?!0:!1});if(ip_GridProps[o].selectedRow.length>0||-1==r.row)return void e("#"+o).ip_SelectColumn({row:null!=r.row?r.row:ip_GridProps[o].selectedRow[0],count:ip_GridProps[o].selectedRow.length,unselect:null!=r.row?!0:!1})}},e.fn.ip_UnSelectCell=function(r){var r=e.extend({},r),o=e(this).attr("id");ip_GridProps[o].selectedCell=null,e(this).ip_RemoveRangeHighlight({highlightType:"ip_grid_cell_rangeHighlight_activecell"})},e.fn.ip_SelectColumn=function(r){var r=e.extend({col:-1,count:1,unselect:!0,multiselect:!1,fetchRange:!0,rangeType:null,raiseEvent:!0},r),o=e(this).attr("id"),i=r.col,t=r.count,l={col:[]},n=ip_GenerateTransactionID();if(i>=-1&&i<ip_GridProps[o].cols){var a=ip_GetColumnMerge(o,i);t+=i-a.mergedWithCol,t<a.colSpan&&(t=a.colSpan),i=a.mergedWithCol;var s=jQuery.inArray(-1,ip_GridProps[o].selectedColumn),p=jQuery.inArray(i,ip_GridProps[o].selectedColumn);if(r.multiselect&&-1==s||(e(this).ip_UnselectRow(),e(this).ip_UnselectColumn(),e(this).ip_RemoveRange(),e(this).ip_UnSelectCell(),s=-1),-1!=i)for(var d=0;t>d;d++){var c=i+d;if(-1==p||0==r.unselect){var _=c<ip_GridProps[o].frozenCols?1:2;l.col[l.col.length]=c,ip_GridProps[o].colData[c].selected=!0,ip_GridProps[o].selectedColumn[ip_GridProps[o].selectedColumn.length]=parseInt(c),ip_IsColLoaded(o,c)&&e("#"+o+"_q"+_+"_columnSelectorCell_"+c).addClass("selected")}else e("#"+o).ip_UnselectColumn({col:c})}else{l.col[0]=-1,ip_GridProps[o].selectedColumn=[],ip_GridProps[o].selectedColumn[0]=-1,s=0;for(var u=0;u<ip_GridProps[o].cols;u++){var _=u<ip_GridProps[o].frozenCols?1:2;ip_GridProps[o].colData[u].selected=!0,ip_IsColLoaded(o,u)&&e("#"+o+"_q"+_+"_columnSelectorCell_"+u).addClass("selected")}}if(-1==s){ip_GridProps[o].selectedColumn.sort(function(e,r){return e-r});for(var g=-2,u=ip_GridProps[o].selectedColumn.length-1;u>=0;u--)g==ip_GridProps[o].selectedColumn[u]&&ip_GridProps[o].selectedColumn.splice(u,1),g=ip_GridProps[o].selectedColumn[u];if(ip_GridProps[o].selectedColumn.length>0&&r.fetchRange){for(var w=[],f=-2,u=0;u<ip_GridProps[o].selectedColumn.length;u++){var i=ip_GridProps[o].selectedColumn[u],h=i-f;h>1?w[w.length]={startRow:-1,startCol:i,endRow:ip_GridProps[o].rows-1,endCol:i}:w[w.length-1].endCol=i,f=i}for(var m=0;m<w.length;m++)e(this).ip_SelectRange({multiselect:m>0?!0:!1,range:w[m],rangeType:r.rangeType})}}else{var v={startRow:-1,startCol:0,endRow:ip_GridProps[o].rows-1,endCol:ip_GridProps[o].cols-1};e(this).ip_SelectRange({multiselect:!1,range:v,rangeType:r.rangeType})}r.raiseEvent&&ip_RaiseEvent(o,"ip_SelectColumn",n,{SelectColumn:{Inputs:r,Effected:l}})}},e.fn.ip_SelectRow=function(r){var r=e.extend({row:-1,count:1,unselect:!0,multiselect:!1,fetchRange:!0,rangeType:null,raiseEvent:!0},r),o=e(this).attr("id"),i=r.row,t=r.count,l=ip_GenerateTransactionID(),n={row:[]};if(i>=-1&&i<ip_GridProps[o].rows){var a=ip_GetRowMerge(o,i);t+=i-a.mergedWithRow,t<a.rowSpan&&(t=a.rowSpan),i=a.mergedWithRow;var s=jQuery.inArray(-1,ip_GridProps[o].selectedRow),p=jQuery.inArray(i,ip_GridProps[o].selectedRow);if(r.multiselect&&-1==s||(e(this).ip_UnselectRow(),e(this).ip_UnselectColumn(),e(this).ip_RemoveRange(),e(this).ip_UnSelectCell(),s=-1),-1!=i)for(var d=0;t>d;d++){var c=i+d;if(-1==p||0==r.unselect){var _=c<ip_GridProps[o].frozenRows?1:3;n.row[n.row.length]=c,ip_GridProps[o].rowData[c].selected=!0,ip_GridProps[o].selectedRow[ip_GridProps[o].selectedRow.length]=parseInt(c),ip_IsRowLoaded(o,c)&&e("#"+o+"_q"+_+"_rowSelecterCell_"+c).addClass("selected")}else e("#"+o).ip_UnselectRow({row:c})}else{ip_GridProps[o].selectedRow=[],ip_GridProps[o].selectedRow[0]=-1,s=0,n.row[0]=-1;for(var u=0;u<ip_GridProps[o].rows;u++){var _=u<ip_GridProps[o].frozenRows?1:3;ip_GridProps[o].rowData[u].selected=!0,ip_IsRowLoaded(o,u)&&e("#"+o+"_q"+_+"_rowSelecterCell_"+u).addClass("selected")}}if(-1==s){ip_GridProps[o].selectedRow.sort(function(e,r){return e-r});for(var g=-2,u=ip_GridProps[o].selectedRow.length-1;u>=0;u--)g==ip_GridProps[o].selectedRow[u]&&ip_GridProps[o].selectedRow.splice(u,1),g=ip_GridProps[o].selectedRow[u];if(ip_GridProps[o].selectedRow.length>0&&r.fetchRange){for(var w=[],f=-2,u=0;u<ip_GridProps[o].selectedRow.length;u++){var i=ip_GridProps[o].selectedRow[u],h=i-f;h>1?w[w.length]={startRow:i,startCol:-1,endRow:i,endCol:ip_GridProps[o].cols-1}:w[w.length-1].endRow=i,f=i
}for(var u=0;u<w.length;u++)e(this).ip_SelectRange({multiselect:u>0?!0:!1,range:w[u],rangeType:r.rangeType})}}else{var m={startRow:0,startCol:0,endRow:ip_GridProps[o].rows-1,endCol:ip_GridProps[o].cols-1};e(this).ip_SelectRange({multiselect:!1,range:m,rangeType:r.rangeType})}r.raiseEvent&&ip_RaiseEvent(o,"ip_SelectRow",l,{SelectRow:{Inputs:r,Effected:n}})}},e.fn.ip_UnselectColumn=function(r){var r=e.extend({col:-1},r),o=e(this).attr("id"),i=r.col,t=i<ip_GridProps[o].frozenCols?1:2,l=ip_GridProps[o].selectedColumn.indexOf(i);if(-1==i){e("#"+o+" .ip_grid_columnSelectorCell").removeClass("selected"),e("#"+o+" .ip_grid_columnSelectorCellCorner").removeClass("selected");for(var n=0;n<ip_GridProps[o].colData.length;n++)ip_GridProps[o].colData[n].selected=!1;ip_GridProps[o].selectedColumn=[]}else l>-1&&(ip_GridProps[o].colData[i].selected=!1,ip_GridProps[o].selectedColumn.splice(l,1),e("#"+o+"_q"+t+"_columnSelectorCell_"+i).removeClass("selected"))},e.fn.ip_UnselectRow=function(r){var r=e.extend({row:-1},r),o=e(this).attr("id"),i=r.row,t=i<ip_GridProps[o].frozenRows?1:3,l=ip_GridProps[o].selectedRow.indexOf(i);if(-1==i){e("#"+o+" .ip_grid_rowSelecterCell").removeClass("selected");for(var n=0;n<ip_GridProps[o].rowData.length;n++)ip_GridProps[o].rowData[n].selected=!1;ip_GridProps[o].selectedRow=[]}else l>-1&&(ip_GridProps[o].rowData[i].selected=!1,ip_GridProps[o].selectedRow.splice(l,1),e("#"+o+"_q"+t+"_rowSelecterCell_"+i).removeClass("selected"))},e.fn.ip_RangeHighlight=function(r){var r=e.extend({range:{startRow:null,startCol:null,endRow:null,endCol:null},startCellOrdinates:[0,0],endCellOrdinates:null,startCell:null,endCell:null,multiselect:!1,borderStyle:"",borderColor:"",fillColor:null,opacity:null,highlightType:"ip_grid_cell_rangeHighlight_activecell",fadeIn:!1,fadeOut:!1,expireTimeout:0},r),o=e(this).attr("id"),i=null,t=null;if(0==ip_GridProps[o].rows||0==ip_GridProps[o].cols)return!1;if(r.multiselect||e(this).ip_RemoveRangeHighlight({highlightType:r.highlightType}),r.considerMerges=!1,r=ip_ValidateRangeOptions(o,r),!r)return!1;if(i=r.startCell,null!=i){t=r.endCell;{var l=e("#"+o+"_rangeHighlight").clone(),n=e(i).parent().parent().parent().parent().parent();ip_setRangeHighlightID(o,l,r.startCellOrdinates,r.endCellOrdinates)}e(l).appendTo(n);var a=ip_CalculateRangeTop(o,l,i,r.range.startRow,r.range.startCol,r.range.endRow,r.range.endCol),s=ip_CalculateRangeLeft(o,l,i,r.range.startRow,r.range.startCol,r.range.endRow,r.range.endCol);if(e(l).width(e(i).width()),e(l).height(e(i).height()),e(l).css("top",a+"px"),e(l).css("left",s+"px"),""!=r.borderStyle&&e(l).css("border-style",r.borderStyle),""!=r.borderColor&&e(l).css("border-color",r.borderColor),""!=r.fillColor&&e(l).css("background-color",r.fillColor),""!=r.opacity&&e(l).css("opacity",r.opacity),e(l).addClass("ip_grid_cell_rangeHighlight_selected"),e(l).addClass(r.highlightType),r.fadeIn?e(l).fadeIn():e(l).show(),t!=i){var p=ip_SetRangeWidth(o,l,i,t,r.startCellOrdinates,r.endCellOrdinates),d=ip_SetRangeHeight(o,l,i,t,r.startCellOrdinates,r.endCellOrdinates);e(l).width(p),e(l).height(d)}var c=ip_GridProps[o].highlightRange.length;ip_GridProps[o].highlightRange[c]=[[r.startCellOrdinates[0],r.startCellOrdinates[1]],[r.endCellOrdinates[0],r.endCellOrdinates[1]],r.borderStyle,r.borderColor,r.highlightType,r.expireTimeout],0!=r.expireTimeout&&setTimeout(function(){e("#"+o).ip_RemoveRangeHighlight({fadeOut:r.fadeOut,rangeHighlightElement:l})},r.expireTimeout)}},e.fn.ip_RemoveRangeHighlight=function(r){var r=e.extend({rangeHighlightElement:null,rangeHighlightID:null,highlightType:null,fadeOut:!1},r),o=e(this).attr("id"),i=null;if(null!=r.rangeHighlightElement?i=r.rangeHighlightElement:null!=r.rangeHighlightID?i=e("#"+r.rangeHighlightID):null!=r.highlightType&&(i=e("#"+o+" ."+r.highlightType)),null==i)r.fadeOut?e(i).fadeOut(function(){e(".ip_grid_cell_rangeHighlight_selected").remove()}):e(".ip_grid_cell_rangeHighlight_selected").remove(),ip_GridProps[o].highlightRange=[];else if(i.length>0){r.fadeOut?e(i).fadeOut(function(){e(i).remove()}):e(i).remove();for(var t=0;t<i.length;t++){var l=ip_GetRangeHighlightIndex(o,i[t]);-1!=l&&ip_GridProps[o].highlightRange.splice(l,1)}}},e.fn.ip_SelectRange=function(r){var r=e.extend({range:{startRow:null,startCol:null,endRow:null,endCol:null},startCellOrdinates:[0,0],endCellOrdinates:null,startCell:null,endCell:null,multiselect:!1,allowColumn:!0,allowRow:!0,showContextButton:!1,showKey:!0,rangeType:null,allowMove:!0,fadeIn:!1,raiseEvent:!0},r),o=ip_GeneratePublicKey(),i=e(this).attr("id"),t=null,l=null;if(0==ip_GridProps[i].rows||0==ip_GridProps[i].cols)return!1;if(r.multiselect||e(this).ip_RemoveRange(),r.allowColumn||e(this).ip_UnselectColumn(),r.allowRow||e(this).ip_UnselectRow(),r=ip_ValidateRangeOptions(i,r),!r)return!1;if(t=r.startCell,null!=t){l=r.endCell;var n=e("#"+i+"_rangeselector").clone(),a=e(t).parent().parent().parent().parent().parent()[0],s=e(n).children(".ip_grid_cell_rangeselector_key"),p=e(n).children(".ip_grid_cell_rangeselector_border"),d=ip_setRangeID(i,n,r.startCellOrdinates,r.endCellOrdinates);if(null==document.getElementById(d)){e(n).appendTo(a);var c=ip_CalculateRangeTop(i,n,t,r.range.startRow,r.range.startCol,r.range.endRow,r.range.endCol),_=ip_CalculateRangeLeft(i,n,t,r.range.startRow,r.range.startCol,r.range.endRow,r.range.endCol);if(e(n).width(e(t).width()),e(n).height(e(t).height()),e(n).css("top",c+"px"),e(n).css("left",_+"px"),e(n).addClass("ip_grid_cell_rangeselector_selected"),e(n).addClass(r.rangeType),r.showKey||e(s).hide(),r.allowMove||e(p).remove(),r.fadeIn?e(n).fadeIn():e(n).css("display","block"),l!=t){var u=ip_SetRangeWidth(i,n,t,l,r.startCellOrdinates,r.endCellOrdinates),g=ip_SetRangeHeight(i,n,t,l,r.startCellOrdinates,r.endCellOrdinates);e(n).width(u),e(n).height(g)}var w=ip_GridProps[i].selectedRange.length;ip_GridProps[i].selectedRange[w]=[[r.startCellOrdinates[0],r.startCellOrdinates[1]],[r.endCellOrdinates[0],r.endCellOrdinates[1]],[r.startCellOrdinates[0],r.startCellOrdinates[1]],[c,_]],ip_GridProps[i].selectedRangeIndex=w;var f=null;e(p).mousedown(f=function(e){1!=e.which||ip_GridProps[i].resizing||(ip_ShowRangeMove(i,n,e,this),ip_GridProps[i].scrollAnimate||ip_EnableScrollAnimate(i))});var h=null;if(e(s).mousedown(h=function(){ip_GridProps[i].resizing=!0;var r=e(t).width(),o=e(t).height();ip_GridProps[i].selectedRangeIndex=w,e(n).addClass("ip_grid_cell_rangeselector_Resize"),e(n).children(".ip_grid_cell_rangeselector_border").hide(),ip_EnableScrollAnimate(i);var l=null;e("#"+i).mousemove(l=function(e){ip_CalculateRangeDimensions(i,n,w,e,"both",o,r)});var a=null;e(document).mouseup(a=function(r){l=ip_UnBindEvent("#"+i,"mousemove",l),a=ip_UnBindEvent(document,"mouseup",a),ip_SetHoverCell(i,"ip_grid_cell_rangeselector",r),e(n).children(".ip_grid_cell_rangeselector_border").show();var o={startRow:ip_GridProps[i].selectedRange[w][0][0],startCol:ip_GridProps[i].selectedRange[w][0][1],endRow:ip_GridProps[i].selectedRange[w][1][0],endCol:ip_GridProps[i].selectedRange[w][1][1]},t=ip_ChangeRange(i,ip_GridProps[i].selectedRange[w],ip_GridProps[i].hoverCell,0,0,0,!0);ip_DragRange(i,{range:o,dragToRange:t}),ip_GridProps[i].resizing=!1})}),r.raiseEvent){var m={startRow:r.startCellOrdinates[0],startCol:r.startCellOrdinates[1],endRow:r.endCellOrdinates[0],endCol:r.endCellOrdinates[1]};ip_RaiseEvent(i,"ip_SelectRange",o,{SelectRange:{Inputs:r,Effected:m}})}}else e(this).ip_RemoveRange({rangeID:d})}},e.fn.ip_RemoveRange=function(r){var r=e.extend({rangeElement:null,rangeID:null},r),o=e(this).attr("id"),i=null;if(null!=r.rangeElement?i=r.rangeElement:null!=r.rangeID&&(i=e("#"+r.rangeID)),null==i)e(".ip_grid_cell_rangeselector_selected").remove(),ip_GridProps[o].selectedRange=[];else{e(i).remove();var t=ip_GetRangeIndex(o,i);-1!=t&&ip_GridProps[o].selectedRange.splice(t,1)}},e.fn.ip_ResetRange=function(o){var o=e.extend({range:null,preserveRange:null,valuesOnly:!1},o),i=e(this).attr("id"),t=[],l=!1,n=ip_GenerateTransactionID(),a={rangeData:t,preserveRangeData:o.preserveRange,resetGrid:l,rowData:null,valuesOnly:o.valuesOnly};if(o.range){t=o.range;for(var s=0;s<o.range.length;s++)t[s].startRow<0&&(t[s].startRow=0),t[s].startCol<0&&(t[s].startCol=0),t[s].endRow<ip_GridProps[i].rows||(t[s].endRow=ip_GridProps[i].rows-1),t[s].endCol<ip_GridProps[i].cols||(t[s].endCol=ip_GridProps[i].cols-1)}else for(var s=0;s<ip_GridProps[i].selectedRange.length;s++)t[s]={startRow:ip_GridProps[i].selectedRange[s][0][0],startCol:ip_GridProps[i].selectedRange[s][0][1],endRow:ip_GridProps[i].selectedRange[s][1][0],endCol:ip_GridProps[i].selectedRange[s][1][1]},t[s].startRow<0&&(t[s].startRow=0),t[s].startCol<0&&(t[s].startCol=0),t[s].endRow<ip_GridProps[i].rows||(t[s].endRow=ip_GridProps[i].rows-1),t[s].endCol<ip_GridProps[i].cols||(t[s].endCol=ip_GridProps[i].cols-1);for(s=0;s<t.length;s++){0==t[s].startRow&&t[s].endRow==ip_GridProps[i].rows-1&&0==t[s].startCol&&t[s].endCol==ip_GridProps[i].cols-1&&(l=!0);var p=ip_AddUndo(i,"ip_ResetRange",n,"CellData",t[s],t[s],0==s?{row:t[s].startRow,col:t[s].startCol}:null),d=ip_AddUndo(i,"ip_ResetRange",n,"MergeData",t[s]),_=ip_ValidateRangeMergedCells(i,t[s].startRow,t[s].startCol,t[s].endRow,t[s].endCol);for(r=t[s].startRow;r<=t[s].endRow;r++)for(c=t[s].startCol;c<=t[s].endCol;c++){var u=!1;if(null!=o.preserveRange)for(ir=0;ir<o.preserveRange.length;ir++)r<o.preserveRange[ir].startRow||r>o.preserveRange[ir].endRow||c<o.preserveRange[ir].startCol||c>o.preserveRange[ir].endCol||(u=!0);u||(ip_AddUndoTransactionData(i,p,ip_CloneCell(i,r,c)),o.valuesOnly?(ip_SetValue(i,r,c,null),ip_RemoveCellFormulaIndex(i,{row:r,col:c}),ip_GridProps[i].rowData[r].cells[c].formula=null,ip_GridProps[i].rowData[r].cells[c].error=null):ip_ResetCell(i,r,c,!0,!0))}if(!o.valuesOnly)for(var g=0;g<_.merges.length;g++)_.merges[g].containsOverlap||(ip_AddUndoTransactionData(i,d,ip_mergeObject(_.merges[g].mergedWithRow,_.merges[g].mergedWithCol,_.merges[g].rowSpan,_.merges[g].colSpan)),ip_ResetCellMerge(i,_.merges[g].mergedWithRow,_.merges[g].mergedWithCol))}for(a.rowData=ip_ReCalculateFormulas(i,{range:t,transactionID:n,render:!0,raiseEvent:!1}).Effected.rowData,s=ip_GridProps[i].copiedRange.length-1;s>=0;s--)"cut"==ip_GridProps[i].copiedRange[s][2]&&ip_GridProps[i].copiedRange.splice(s,1);e(this).ip_RemoveRangeHighlight({highlightType:"ip_grid_cell_rangeHighlight_cut"}),ip_SetFxBarValue(i),ip_ReRenderRanges(i,t),ip_RaiseEvent(i,"ip_ResetRange",n,{ResetRange:{Inputs:o,Effected:a}})},e.fn.ip_RemoveRow=function(r){var o=e(this).attr("id");ip_RemoveRow(o,r)},e.fn.ip_AddRow=function(r){var o=e(this).attr("id");ip_AddRow(o,r)},e.fn.ip_InsertRow=function(r){var o=e(this).attr("id");ip_InsertRow(o,r)},e.fn.ip_RemoveCol=function(r){var o=e(this).attr("id");ip_RemoveCol(o,r)},e.fn.ip_AddCol=function(r){var o=e(this).attr("id");ip_AddCol(o,r)},e.fn.ip_InsertCol=function(r){var o=e(this).attr("id");ip_InsertCol(o,r)},e.fn.ip_FrozenRowsCols=function(r){var r=e.extend({rows:null,cols:null,raiseEvent:!0,createUndo:!0},r),o=e(this).attr("id"),i="",t={gridData:{frozenRows:r.rows,frozenCols:r.cols}},l=ip_GenerateTransactionID();if(rows=r.rows,cols=r.cols,null!=rows){if(0>rows&&(rows=0),rows>ip_GridProps[o].loadedRows)return rows=ip_GridProps[o].loadedRows-1,ip_RaiseEvent(o,"warning",arguments.callee.caller,"Your frozen rows may not exceed the viewable area of rows 0 - "+rows),!1;for(var n=ip_ValidateRangeMergedCells(o,rows,0,rows,ip_GridProps[o].cols-1),a=0;a<n.merges.length;a++)n.merges[a].mergedWithRow!=rows&&(e(this).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,color:"#ff5a00",range:{startRow:n.merges[a].mergedWithRow,startCol:n.merges[a].mergedWithCol,endRow:n.merges[a].mergedWithRow,endCol:n.merges[a].mergedWithCol}}),i="Cant freeze rows over merged cells, first unmerge your cells");if(""==i){if(r.createUndo){var s=ip_GridProps[o].frozenRows;ip_AddUndo(o,"ip_FrozenRowsCols",l,"function",null,null,null,null,function(){e("#"+o).ip_FrozenRowsCols({rows:s,raiseEvent:!1,createUndo:!1})})}var p=rows-ip_GridProps[o].frozenRows;ip_GridProps[o].frozenRows=rows,ip_GridProps[o].scrollY+=p,ip_ReRenderRows(o,"frozen")}}if(null!=cols){if(0>cols&&(cols=0),cols>ip_GridProps[o].loadedCols)return cols=ip_GridProps[o].loadedCols-1,ip_RaiseEvent(o,"warning",arguments.callee.caller,"Your frozen columns may not exceed the viewable area of columns 0 - "+cols),!1;for(var n=ip_ValidateRangeMergedCells(o,0,cols,ip_GridProps[o].rows-1,cols),a=0;a<n.merges.length;a++)n.merges[a].mergedWithCol!=cols&&(e(this).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,color:"#ff5a00",range:{startRow:n.merges[a].mergedWithRow,startCol:n.merges[a].mergedWithCol,endRow:n.merges[a].mergedWithRow,endCol:n.merges[a].mergedWithCol}}),i="Cant freeze columns over merged cells, first unmerge your cells");if(""==i){if(r.createUndo){var d=ip_GridProps[o].frozenCols;ip_AddUndo(o,"ip_FrozenRowsCols",l,"function",null,null,null,null,function(){e("#"+o).ip_FrozenRowsCols({cols:d,raiseEvent:!1,createUndo:!1})})}var p=(cols-ip_GridProps[o].frozenCols,cols-ip_GridProps[o].frozenCols);ip_GridProps[o].frozenCols=cols,ip_GridProps[o].scrollX+=p,ip_ReRenderCols(o,"frozen")}}""!=i?ip_RaiseEvent(o,"warning",arguments.callee.caller,i):(e("#"+o).ip_Scrollable(),null!=cols&&ip_ReRenderCols(o,"scroll"),null!=rows&&ip_ReRenderRows(o,"scroll"),ip_ReloadRanges(o),r.raiseEvent&&ip_RaiseEvent(o,"ip_FrozenRowsCols",l,{FrozenRowsCols:{Inputs:r,Effected:t}}))},e.fn.ip_MoveCol=function(r){var o=e(this).attr("id");return ip_MoveColumn(o,r)},e.fn.ip_MoveRow=function(r){var o=e(this).attr("id");return ip_MoveRow(o,r)},e.fn.ip_Copy=function(r){var r=e.extend({range:null,rangeElement:null,rangeID:null,cut:!1,toClipBoard:!0},r),o=e(this).attr("id"),i=[];if(r.range)i=r.range;else if(r.rangeID)for(var t=0;t<r.rangeID.length;t++)i[t]={startRow:parseInt("#"+e(r.rangeID[t]).attr("startrow")),startCol:parseInt("#"+e(r.rangeID[t]).attr("startcol")),endRow:parseInt("#"+e(r.rangeID[t]).attr("endrow")),endCol:parseInt("#"+e(r.rangeID[t]).attr("endcol"))};else{r.rangeElement||(r.rangeElement=e("#"+o+" .ip_grid_cell_rangeselector_selected"));for(var t=0;t<r.rangeElement.length;t++)i[t]={startRow:parseInt(e(r.rangeElement[t]).attr("startrow")),startCol:parseInt(e(r.rangeElement[t]).attr("startcol")),endRow:parseInt(e(r.rangeElement[t]).attr("endrow")),endCol:parseInt(e(r.rangeElement[t]).attr("endcol"))}}r.cut&&(ip_GridProps[o].cutRange=[]),ip_GridProps[o].copiedRange=[],e("#"+o).ip_RemoveRangeHighlight();for(var t=0;t<i.length;t++){i[t].startRow<ip_GridProps[o].rows||(i[t].startRow=ip_GridProps[o].rows-1),i[t].startCol<ip_GridProps[o].cols||(i[t].startCol=ip_GridProps[o].cols-1),i[t].endRow<ip_GridProps[o].rows||(i[t].endRow=ip_GridProps[o].rows-1),i[t].endCol<ip_GridProps[o].cols||(i[t].endCol=ip_GridProps[o].cols-1);{o+"_range_"+i[t].startRow+"_"+i[t].startCol+"_"+i[t].endRow+"_"+i[t].endCol}ip_GridProps[o].copiedRange[t]=[[i[t].startRow,i[t].startCol],[i[t].endRow,i[t].endCol],r.cut?"cut":"copy"],e("#"+o).ip_RangeHighlight({range:i[t],multiselect:!0,fadeIn:!0,highlightType:r.cut?"ip_grid_cell_rangeHighlight_cut":"ip_grid_cell_rangeHighlight_copy"}),ip_GridProps[o].cut=r.cut}},e.fn.ip_Paste=function(r){var r=e.extend({row:null,col:null,fromRange:null,fromClipboard:!1,cut:ip_GridProps[e(this).attr("id")].cut,changeFormula:!0},r),o=e(this).attr("id"),i=ip_GenerateTransactionID(),t="";if(null==r.row&&ip_GridProps[o].selectedRow.length>0&&(ip_GridProps[o].selectedRow.sort(),r.row=ip_GridProps[o].selectedRow[0],r.col=0),null==r.col&&ip_GridProps[o].selectedColumn.length>0&&(ip_GridProps[o].selectedColumn.sort(),r.row=0,r.col=ip_GridProps[o].selectedColumn[0]),null==r.row&&null!=ip_GridProps[o].selectedCell?r.row=ip_GridProps[o].selectedCell.row:null==r.row&&(t="Row to paste to is not specified"),null==r.col&&null!=ip_GridProps[o].selectedCell?r.col=ip_GridProps[o].selectedCell.col:null==r.col&&(t="Column to paste to is not specified"),r.row<0&&(r.row=0),r.col<0&&(r.col=0),r.row<ip_GridProps[o].rows||(r.row=ip_GridProps[o].rows-1),r.col<ip_GridProps[o].cols||(r.col=ip_GridProps[o].cols-1),r.fromClipboard);else if(null==r.fromRange){r.fromRange=[];for(var l=0;l<ip_GridProps[o].copiedRange.length;l++)r.fromRange[l]=ip_rangeObject(ip_GridProps[o].copiedRange[l][0][0],ip_GridProps[o].copiedRange[l][0][1],ip_GridProps[o].copiedRange[l][1][0],ip_GridProps[o].copiedRange[l][1][1])}if(null!=r.fromRange)for(var n=[],a=[],s=0,p=0,l=0;l<r.fromRange.length;l++)if(n[l]=ip_rangeObject(r.fromRange[l].startRow,r.fromRange[l].startCol,r.fromRange[l].endRow,r.fromRange[l].endCol),n[l].startRow<0&&(n[l].startRow=0),n[l].startCol<0&&(n[l].startCol=0),n[l].endRow<ip_GridProps[o].rows||(n[l].endRow=ip_GridProps[o].rows-1),n[l].endCol<ip_GridProps[o].cols||(n[l].endCol=ip_GridProps[o].cols-1),s=r.row-n[0].startRow,p=r.col-n[0].startCol,a[l]=ip_rangeObject(n[l].startRow+s,n[l].startCol+p,n[l].endRow+s,n[l].endCol+p),a[l].startRow<0&&(a[l].startRow=0),a[l].startCol<0&&(a[l].startCol=0),a[l].endRow<ip_GridProps[o].rows||(t="You are trying to paste cells beyond the sheet area",e(this).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,color:"#ff5a00",range:{startRow:n[l].startRow,startCol:n[l].startCol,endRow:n[l].endRow,endCol:n[l].endCol}})),a[l].endCol<ip_GridProps[o].cols||(t="You are trying to paste cells beyond the sheet area",e(this).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,color:"#ff5a00",range:{startRow:n[l].startRow,startCol:n[l].startCol,endRow:n[l].endRow,endCol:n[l].endCol}})),""==t&&(a[l].existingMerges=ip_ValidateRangeMergedCells(o,a[l].startRow,a[l].startCol,a[l].endRow,a[l].endCol),a[l].existingMerges.containsOverlap))for(var d=0;d<a[l].existingMerges.merges.length;d++)(!r.cut||a[l].existingMerges.merges[d].containsOverlap&&!ip_IsMergeInRange(o,a[l].existingMerges.merges[d],n))&&(e(this).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,color:"#ff5a00",range:{startRow:a[l].existingMerges.merges[d].mergedWithRow,startCol:a[l].existingMerges.merges[d].mergedWithCol}}),t="When placing cells, make sure they dont partcially overlap an existing merge");if(""==t){if(r.fromClipboard)var c={rowData:[],mergeData:[],mergeDataForRemove:[],cut:r.cut};else{for(var c={rowData:[],row:r.row,col:r.col,fromRange:n,cut:r.cut},_=[],l=0;l<n.length;l++)_[l]=ip_GetRangeData(o,!1,n[l].startRow,n[l].startCol,n[l].endRow,n[l].endCol);if(r.cut)for(var l=0;l<_.length;l++){for(var u=ip_AddUndo(o,"ip_Paste",i,"CellData",_[l]),g=ip_AddUndo(o,"ip_Paste",i,"MergeData",_[l]),w=0;w<_[l].rowData.length;w++)for(var f=0;f<_[l].rowData[w].cells.length;f++)ip_AddUndoTransactionData(o,u,ip_CloneCell(o,_[l].rowData[w].cells[f].row,_[l].rowData[w].cells[f].col)),ip_ResetCell(o,_[l].rowData[w].cells[f].row,_[l].rowData[w].cells[f].col,!0,!0);for(var d=0;d<_[l].mergeData.length;d++)_[l].mergeData[d].containsOverlap||(ip_AddUndoTransactionData(o,g,ip_mergeObject(_[l].mergeData[d].mergedWithRow,_[l].mergeData[d].mergedWithCol,_[l].mergeData[d].rowSpan,_[l].mergeData[d].colSpan)),ip_ResetCellMerge(o,_[l].mergeData[d].mergedWithRow,_[l].mergeData[d].mergedWithCol))}for(var l=0;l<a.length;l++){for(var u=ip_AddUndo(o,"ip_Paste",i,"CellData",a[l],a[l],0==l?{row:a[l].startRow,col:a[l].startCol}:null),g=ip_AddUndo(o,"ip_Paste",i,"MergeData",a[l]),d=0;d<a[l].existingMerges.merges.length;d++)ip_AddUndoTransactionData(o,g,ip_mergeObject(a[l].existingMerges.merges[d].mergedWithRow,a[l].existingMerges.merges[d].mergedWithCol,a[l].existingMerges.merges[d].rowSpan,a[l].existingMerges.merges[d].colSpan)),ip_ResetCellMerge(o,a[l].existingMerges.merges[d].mergedWithRow,a[l].existingMerges.merges[d].mergedWithCol);for(var h=0,w=a[l].startRow;w<=a[l].endRow;w++){for(var m=0,f=a[l].startCol;f<=a[l].endCol;f++){ip_AddUndoTransactionData(o,u,ip_CloneCell(o,w,f));var v=_[l].rowData[h].cells[m],C=ip_GridProps[o].rowData[w].cells[f].fxIndex;ip_GridProps[o].rowData[w].cells[f]=v,ip_GridProps[o].rowData[w].cells[f].fxIndex=C,ip_SetCellFormula(o,{row:w,col:f,formula:r.changeFormula?ip_MoveFormulaOrigon(o,ip_GridProps[o].rowData[w].cells[f].formula,v.row,v.col,w,f,null,r.cut?n[l]:null):ip_GridProps[o].rowData[w].cells[f].formula}),r.changeFormula&&r.cut&&(c.rowData=c.rowData.concat(ip_ChangeFormulasForCellMove(o,u,v.row,v.col,w,f,_[l]).rowData)),ip_SetValue(o,w,f),delete ip_GridProps[o].rowData[w].cells[f].merge,m++}h++}}for(var l=0;l<_.length;l++)for(var d=0;d<_[l].mergeDataContained.length;d++){var R=_[l].mergeDataContained[d].mergedWithRow+s,G=_[l].mergeDataContained[d].mergedWithCol+p,P=R+_[l].mergeDataContained[d].rowSpan-1,y=G+_[l].mergeDataContained[d].colSpan-1;ip_SetCellMerge(o,R,G,P,y)}}for(r.cut&&(c.rowData=c.rowData.concat(ip_ReCalculateFormulas(o,{createUndo:!0,range:n,transactionID:i,render:!0,raiseEvent:!1}).Effected.rowData)),c.rowData=c.rowData.concat(ip_ReCalculateFormulas(o,{recalcSource:!0,createUndo:!0,range:a,transactionID:i,render:!0,raiseEvent:!1}).Effected.rowData),c=ip_PurgeEffectedRowData(o,c),ip_ReRenderRanges(o,r.cut?a.concat(n):a),e(this).ip_SelectCell({row:r.row,col:r.col}),l=0;l<a.length;l++)e(this).ip_SelectRange({range:a[l],multiselect:0==l?!1:!0});for(l=ip_GridProps[o].copiedRange.length-1;l>=0;l--)"cut"==ip_GridProps[o].copiedRange[l][2]&&ip_GridProps[o].copiedRange.splice(l,1);e(this).ip_RemoveRangeHighlight({highlightType:"ip_grid_cell_rangeHighlight_cut"}),ip_RaiseEvent(o,"ip_Paste",i,{Paste:{Inputs:r,Effected:c}})}if(""!=t){for(e(this).ip_SelectCell({cell:ip_GridProps[o].selectedCell}),l=0;l<n.length;l++)e(this).ip_SelectRange({range:n[l],multiselect:0==l?!1:!0});ip_RaiseEvent(o,"warning",arguments.callee.caller,t)}},e.fn.ip_ClearCopy=function(){var r=e(this).attr("id");e(this).ip_RemoveRangeHighlight({highlightType:"ip_grid_cell_rangeHighlight_cut"}),e(this).ip_RemoveRangeHighlight({highlightType:"ip_grid_cell_rangeHighlight_copy"}),ip_GridProps[r].copiedRange=[]},e.fn.ip_MergeRange=function(r){var r=e.extend({range:null},r),o=e(this).attr("id"),i=[],t="",l={mergeData:[],rowData:null},n=ip_GenerateTransactionID();if(r.range){i=r.range;for(var a=0;a<r.range.length;a++)i[a].startRow<0&&(i[a].startRow=0),i[a].startCol<0&&(i[a].startCol=0),i[a].endRow<ip_GridProps[o].rows||(i[a].endRow=ip_GridProps[o].rows-1),i[a].endCol<ip_GridProps[o].cols||(i[a].endCol=ip_GridProps[o].cols-1)}else{r.rangeElement||(r.rangeElement=e("#"+o+" .ip_grid_cell_rangeselector_selected"));for(var a=0;a<r.rangeElement.length;a++)i[a]={startRow:parseInt(e(r.rangeElement[a]).attr("startrow")),startCol:parseInt(e(r.rangeElement[a]).attr("startcol")),endRow:parseInt(e(r.rangeElement[a]).attr("endrow")),endCol:parseInt(e(r.rangeElement[a]).attr("endcol"))},i[a].startRow<0&&(i[a].startRow=0),i[a].startCol<0&&(i[a].startCol=0),i[a].endRow<ip_GridProps[o].rows||(i[a].endRow=ip_GridProps[o].rows-1),i[a].endCol<ip_GridProps[o].cols||(i[a].endCol=ip_GridProps[o].cols-1)}for(var s=!0,a=0;a<i.length;a++){var p=ip_ValidateRangeMergedCells(o,i[a].startRow,i[a].startCol,i[a].endRow,i[a].endCol);p.merges.length>0&&(s=!1,e(this).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,color:"#ff5a00",range:{startRow:i[a].startRow,startCol:i[a].startCol,endRow:i[a].endRow,endCol:i[a].endCol}}),t="Please adjust your range[s] so that they dont overlap an existing merge")}if(s){var p=ip_ValidateRangeOverlap(o,i);if(p.length>0){s=!1;for(var a=0;a<p.length;a++)e(this).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,color:"#ff5a00",range:{startRow:p[a].startRow,startCol:p[a].startCol,endRow:p[a].endRow,endCol:p[a].endCol}});t="Please adjust your range[s] so that they dont overlap an each other"}}if(s){for(var a=0;a<i.length;a++)if(i[a].startRow!=i[a].endRow||i[a].startCol!=i[a].endCol){var d=ip_AddUndo(o,"ip_MergeRange",n,"CellData",i[a],i[a],{row:i[a].startRow,col:i[a].startCol},null,null,i[a]),c=ip_AddUndo(o,"ip_MergeRange",n,"MergeData",i[a]);ip_SetCellMerge(o,i[a].startRow,i[a].startCol,i[a].endRow,i[a].endCol,d,c),l.mergeData[l.mergeData.length]={mergedWithRow:i[a].startRow,mergedWithCol:i[a].startCol,rowSpan:i[a].endRow-i[a].startRow+1,colSpan:i[a].endCol-i[a].startCol+1}}l.rowData=ip_ReCalculateFormulas(o,{range:i,transactionID:n,render:!1,raiseEvent:!1,createUndo:!0}).Effected.rowData,ip_ReRenderRows(o),e(this).ip_RemoveRangeHighlight();for(var a=0;a<i.length;a++){var _=i[a].startRow,u=i[a].startCol;e(this).ip_SelectRange({range:{startRow:_,startCol:u},multiselect:0==a?!1:!0}),0==a&&e("#"+o).ip_SelectCell({row:i[0].startRow,col:i[0].startCol})}if(ip_RaiseEvent(o,"ip_MergeRange",n,{MergeRange:{Inputs:{rangeData:i},Effected:l}}),""==t)return!0}else ip_RaiseEvent(o,"warning",arguments.callee.caller,t);return!1},e.fn.ip_UnMergeRange=function(r){var r=e.extend({range:null},r),o=e(this).attr("id"),i=[],t="",l={rangeData:[]},n=ip_GenerateTransactionID();if(r.range){i=r.range;for(var a=0;a<r.range.length;a++)i[a].startRow<0&&(i[a].startRow=0),i[a].startCol<0&&(i[a].startCol=0),i[a].endRow<ip_GridProps[o].rows||(i[a].endRow=ip_GridProps[o].rows-1),i[a].endCol<ip_GridProps[o].cols||(i[a].endCol=ip_GridProps[o].cols-1)}else{r.rangeElement||(r.rangeElement=e("#"+o+" .ip_grid_cell_rangeselector_selected"));for(var a=0;a<r.rangeElement.length;a++)i[a]={startRow:parseInt(e(r.rangeElement[a]).attr("startrow")),startCol:parseInt(e(r.rangeElement[a]).attr("startcol")),endRow:parseInt(e(r.rangeElement[a]).attr("endrow")),endCol:parseInt(e(r.rangeElement[a]).attr("endcol"))},i[a].startRow<0&&(i[a].startRow=0),i[a].startCol<0&&(i[a].startCol=0),i[a].endRow<ip_GridProps[o].rows||(i[a].endRow=ip_GridProps[o].rows-1),i[a].endCol<ip_GridProps[o].cols||(i[a].endCol=ip_GridProps[o].cols-1)}for(var a=0;a<i.length;a++){var s=ip_ValidateRangeMergedCells(o,i[a].startRow,i[a].startCol,i[a].endRow,i[a].endCol);i[a].merges=s.merges;for(var p=0;p<s.merges.length;p++)s.merges[p].containsOverlap&&(e(this).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,color:"#ff5a00",range:{startRow:i[a].startRow,startCol:i[a].startCol,endRow:i[a].endRow,endCol:i[a].endCol}}),t="Please adjust your range[s] so that they full cover the merge you would like to remove")}if(""==t){l.rangeData=i;for(var a=0;a<i.length;a++)for(var d=i[a].merges,c=ip_AddUndo(o,"ip_UnMergeRange",n,"MergeData",i[a],i[a],{row:i[a].startRow,col:i[a].startCol}),p=0;p<d.length;p++)d[p].containsOverlap||(ip_AddUndoTransactionData(o,c,ip_mergeObject(d[p].mergedWithRow,d[p].mergedWithCol,d[p].rowSpan,d[p].colSpan)),ip_ResetCellMerge(o,d[p].mergedWithRow,d[p].mergedWithCol));ip_ReRenderRows(o),ip_RaiseEvent(o,"ip_UnMergeRange",n,{UnMergeRange:{Inputs:{rangeData:i},Effected:l}})}return""==t?!0:(ip_RaiseEvent(o,"warning",arguments.callee.caller,t),!1)},e.fn.ip_Sort=function(r){var r=e.extend({col:null,range:null,order:"az"},r),o=e(this).attr("id"),i="",t={range:[],order:r.order,col:r.col,rowDataLoading:!1,rowData:null},l=ip_GenerateTransactionID();if(null!=r.col&&0==ip_GridProps[o].selectedRange.length)r.range=[ip_rangeObject(0,0,ip_GridProps[o].rows-1,ip_GridProps[o].cols-1,null,r.col)];else if(null==r.range){r.range=[];for(var n=0;n<ip_GridProps[o].selectedRange.length;n++)r.range[n]=ip_rangeObject(ip_GridProps[o].selectedRange[n][0][0],ip_GridProps[o].selectedRange[n][0][1],ip_GridProps[o].selectedRange[n][1][0],ip_GridProps[o].selectedRange[n][1][1],null,r.col)}for(var n=0;n<r.range.length;n++)r.range[n].startRow<0&&(r.range[n].startRow=0),r.range[n].startCol<0&&(r.range[n].startCol=0),r.range[n].endRow<ip_GridProps[o].rows||(r.range[n].endRow=ip_GridProps[o].rows-1),r.range[n].endCol<ip_GridProps[o].cols||(r.range[n].endCol=ip_GridProps[o].cols-1),null==r.range[n].col&&(r.range[n].col=null==r.col?r.range[n].startCol:r.col),r.range[n].col<r.range[n].startCol&&(r.range[n].col=r.range[n].startCol),r.range[n].col>r.range[n].endCol&&(r.range[n].col=r.range[n].endCol);if(null!=r.range){for(var n=0;n<r.range.length;n++){var a=ip_ValidateRangeMergedCells(o,r.range[n].startRow,r.range[n].startCol,r.range[n].endRow,r.range[n].endCol),s=!0;a.merges.length>0&&(a.containsOverlap?(s=!1,i="Cannot sort a range with overlapping merges"):a.containsUnmergedCells?(s=!1,i="Sorting requires all cells in range to be identical (all cells within sort range must have the same merge row/column span or no merge at all)"):a.mergesIdentical||(s=!1,i="Sorting requires all merges within range to be identical")),s||e(this).ip_RangeHighlight({fadeOut:!0,expireTimeout:3e3,highlightType:"ip_grid_cell_rangeHighlight_alert",multiselect:!0,color:"#ff5a00",range:{startRow:r.range[n].startRow,startCol:r.range[n].startCol,endRow:r.range[n].endRow,endCol:r.range[n].endCol}})}if(""==i){for(var n=0;n<r.range.length;n++){var p=ip_GetRangeData(o,!1,r.range[n].startRow,r.range[n].startCol,r.range[n].endRow,r.range[n].endCol,!0,!1,!0,!1,!0),d=0==r.range[n].startCol&&r.range[n].endCol==ip_GridProps[o].cols-1?!0:!1;if(p.rowData.length>0){if(p.rowDataLoading){{ip_AddUndo(o,"ip_Sort",l,"undoServer",r.range[n],r.range[n],{row:r.range[n].startRow,col:r.range[n].startCol})}t.rowDataLoading=!0}else{var c=ip_AddUndo(o,"ip_Sort",l,"CellData",r.range[n],r.range[n],{row:r.range[n].startRow,col:r.range[n].startCol}),_=ip_AddUndo(o,"ip_Sort",l,"RowData",r.range[n]),u=r.range[n].col-p.startCol;p.rowData.sort(ip_CompareRow(o,u,r.order,d));for(var g=0,w=p.startRow;w<=p.endRow;w++){for(var f=0,h=p.startCol;h<=p.endCol;h++){ip_AddUndoTransactionData(o,c,ip_CloneCell(o,w,h));var m=g,v=f,C=p.rowData[m].cells[v],R=ip_GridProps[o].rowData[w].cells[h].merge;ip_GridProps[o].rowData[w].cells[h]=C,null!=R&&(ip_GridProps[o].rowData[w].cells[h].merge=R),null!=C.fxIndex&&ip_ChangeFormulaOrigin(o,{fxIndex:C.fxIndex,toRow:w,toCol:h}),f++}if(d){ip_AddUndoTransactionData(o,_,ip_CloneRow(o,w));var G=ip_GridProps[o].rowData[w].cells,P=ip_GridProps[o].rowData[w].containsMerges;ip_GridProps[o].rowData[w]=p.rowData[g],ip_GridProps[o].rowData[w].containsMerges=P,ip_GridProps[o].rowData[w].cells=G}g++}}t.col=r.col,t.range[t.range.length]=ip_rangeObject(r.range[n].startRow,r.range[n].startCol,r.range[n].endRow,r.range[n].endCol,null,r.range[n].col)}}t.rowDataLoading||(t.rowData=ip_ReCalculateFormulas(o,{range:t.range,transactionID:l,render:!1,raiseEvent:!1,createUndo:!0}).Effected.rowData,ip_ReRenderRows(o)),t.range.length>0&&ip_RaiseEvent(o,"ip_Sort",l,{Sort:{Inputs:r,Effected:t}})}else ip_RaiseEvent(o,"warning",l,i)}},e.fn.ip_TextEditable=function(r){var r=e.extend({row:null,col:null,element:null,ToolBar:null,contentType:"ip_grid_CellEdit",defaultValue:null,clear:!1,cursor:null,dropDown:{allowEmpty:!0,validate:!1,autoComplete:!0,keyField:null,displayField:null,data:[],noMatchData:null}},r);if(null!=r.element){var o=e(this).attr("id"),i=0,t=0,l=0,n=0,a=r.element,s=r.defaultValue,p=r.element.length>0?r.element[0]:r.element,d="";ip_EnableSelection(o),null==ip_GridProps[o].editing.editTool&&(ip_GridProps[o].editing.editTool=e("#"+o+"_editTool")[0]);var c=ip_GridProps[o].editing.editTool,_=e(c).children(".ip_grid_EditTool_Input")[0],u=e(ip_GridProps[o].fxBar).children(".ip_grid_fbar_text")[0];c.text=function(r,i,t,l){return null!=i&&e(_).attr("key",i),null!=r&&("string"==typeof r&&(r=r.replace(/\s$/,"&nbsp;")),e(_).html(r),e(u).html(r),e(p).find(".ip_grid_cell_innerContent").html(r)),null!=t&&(ip_GridProps[o].editing.cursor=ip_SetCursorPos(o,_,t,l)),e(_).text()},c.isFX=function(e){var r=c.text().trim();return""!=r?e||"="!=r[0]?ip_fxObject(o,r):!0:!1},c.row=parseInt(e(p).attr("row")),c.col=parseInt(e(p).attr("col")),e(_).attr("key",""),"ip_grid_CellEdit"==r.contentType||"ip_grid_ColumnType"==r.contentType?(elementToStyle=p,a=e(p).parent().parent().parent().parent().parent()[0],i=ip_CalculateRangeTop(o,c,p,c.row,c.col,c.row,c.col,!0),t=ip_CalculateRangeLeft(o,c,p,c.row,c.col,c.row,c.col,!0),l=e(p).width(),n=e(p).height(),null!=s||r.clear||c.row<0?null==s&&(s=""):s=null!=ip_GridProps[o].rowData[c.row].cells[c.col].formula&&""!=ip_GridProps[o].rowData[c.row].cells[c.col].formula?ip_GridProps[o].rowData[c.row].cells[c.col].formula:ip_GridProps[o].rowData[c.row].cells[c.col].value,d="ip_grid_ColumnType"==r.contentType?"background-color:inherit;box-shadow:none;":e(p).attr("style"),0==r.dropDown.data.length&&"dropdown"==ip_GetEnabledControlType(o,null,c.row,c.col,!0)&&(r.dropDown.data=ip_GridProps[o].rowData[c.row].cells[c.col].validation.validationCriteria?ip_GridProps[o].rowData[c.row].cells[c.col].validation.validationCriteria:ip_GridProps[o].colData[c.col].validation.validationCriteria)):(r.contentType="ip_grid_fxBar")&&(elementToStyle=ip_GridProps[o].fxBar,a=ip_GridProps[o].fxBar,i=0,t=60,l=e(u).width()-t,n=e(u).height(),null!=s||r.clear||c.row<0?null==s&&(s=""):s=null!=ip_GridProps[o].rowData[c.row].cells[c.col].formula&&""!=ip_GridProps[o].rowData[c.row].cells[c.col].formula?ip_GridProps[o].rowData[c.row].cells[c.col].formula:ip_GridProps[o].rowData[c.row].cells[c.col].value,d="box-shadow:none;background-color:"+e(a).css("background-color")+";"),null==s&&(s=""),null==d&&(d=""),ip_GridProps[o].editing.editing=!0,ip_GridProps[o].editing.row=c.row,ip_GridProps[o].editing.col=c.col,ip_GridProps[o].editing.element=p,ip_GridProps[o].editing.contentType=r.contentType,ip_GridProps[o].editing.carret=r.cursor,e(a).append(c),ip_GridProps[o].editing.editTool.text(s),e(c).width(l),e(c).height(n),e(c).css("line-height",n+"px"),e(c).css("top",i+"px"),e(c).css("left",t+"px"),e(c).css("text-align",e(elementToStyle).css("text-align")),e(c).css("vertical-align",e(elementToStyle).css("vertical-align")),e(c).css("font-family",e(elementToStyle).css("font-family")),e(c).css("font-size",e(elementToStyle).css("font-size")),e(c).css("color",e(elementToStyle).css("color")),e(_).attr("style",d),ip_GridProps[o].editing.carret,ip_UnBindEvent(_,"mouseup",ip_GridProps[o].events.textEditTool_MouseUp),e(_).mouseup(ip_GridProps[o].events.textEditTool_MouseUp=function(){var e=ip_GetCursorPos(o,_),r=ip_GridProps[o].editing.editTool.text();
    ip_GridProps[o].editing.carret=e,ip_EditToolHelp(o,r,e,0,!0,!0,!0)}),ip_UnBindEvent(_,"keyup",ip_GridProps[o].events.textEditTool_KeyUp),e(_).keyup(ip_GridProps[o].events.textEditTool_KeyUp=function(e){if(8==e.keyCode||37==e.keyCode||39==e.keyCode){var r=ip_GetCursorPos(o,_),i=ip_GridProps[o].editing.editTool.text();ip_GridProps[o].editing.carret=r,ip_EditToolHelp(o,i,r,0,!0,!0,!0),e.preventDefault()}}),ip_UnBindEvent(_,"keydown",ip_GridProps[o].events.textEditTool_KeyDown),e(_).keydown(ip_GridProps[o].events.textEditTool_KeyDown=function(i){if(clearTimeout(ip_GridProps[o].timeouts.textEditToolBlurTimeout),13==i.keyCode)return ip_TextEditbleBlur(o,s,c,_,ip_GridProps[o].editing.element,ip_GridProps[o].editing.contentType,c.row,c.col,!0);if(27==i.keyCode)return ip_TextEditbleCancel(o,c,_,ip_GridProps[o].editing.element,ip_GridProps[o].editing.contentType,c.row,c.col,!0);if(8==i.keyCode){var t=ip_GetCursorPos(o,_),l=ip_GridProps[o].editing.editTool.text();l=l.slice(0,t.x-(0==t.length?1:t.length))+l.substring(t.x+t.length,l.length),ip_EditToolDropDownFilter(o,l)}else if(37==i.keyCode||39==i.keyCode){var t=ip_GetCursorPos(o,_),n=37==i.keyCode?-1:1,a=t.x+n;if(0>a||a>e(this).text().length)return ip_TextEditbleBlur(o,s,c,_,ip_GridProps[o].editing.element,ip_GridProps[o].editing.contentType,c.row,c.col)}else if(38==i.keyCode||40==i.keyCode){if(null==r.dropDown.data||r.dropDown.data.length<=0||!r.dropDown.autoComplete)return ip_TextEditbleBlur(o,s,c,_,ip_GridProps[o].editing.element,ip_GridProps[o].editing.contentType,c.row,c.col);ip_EditToolDropDownHighlightNext(o,38==i.keyCode?"up":"down")}}),ip_UnBindEvent(_,"keypress",ip_GridProps[o].events.textEditTool_KeyPress),e(_).keypress(ip_GridProps[o].events.textEditTool_KeyPress=function(i){var t=i.key||String.fromCharCode(i.keyCode);if("Spacebar"==t&&(t=" "),1==t.length){var l=ip_GetCursorPos(o,_),n=ip_GridProps[o].editing.editTool.text();if(ip_GridProps[o].editing.carret=e.extend({},l),ip_GridProps[o].editing.carret.x++,n=n.slice(0,l.x)+t+n.substring(l.x+l.length,n.length),null!=r.dropDown.data&&r.dropDown.data.length>0&&r.dropDown.autoComplete)ip_EditToolDropDownFilter(o,n);else{l.length=0;{ip_EditToolHelp(o,n,l,1,!0,!0,!0)}i.preventDefault()}}}),ip_UnBindEvent(_,"focusin",ip_GridProps[o].events.textEditTool_FocusIn),e(_).focusin(ip_GridProps[o].events.textEditTool_FocusIn=function(){clearTimeout(ip_GridProps[o].timeouts.textEditToolBlurTimeout)}),ip_UnBindEvent(_,"focusout",ip_GridProps[o].events.textEditTool_FocusOut),e(_).focusout(ip_GridProps[o].events.textEditTool_FocusOut=function(){ip_GridProps[o].timeouts.textEditToolBlurTimeout=setTimeout(function(){return ip_TextEditbleBlur(o,s,c,_,ip_GridProps[o].editing.element,ip_GridProps[o].editing.contentType,c.row,c.col,!0)},10)}),e(c).show(),ip_EditToolShowDropDown(o,c,r.dropDown),ip_EditToolHelp(o,s,r.cursor,0,!1,!0,!0),_.focus()}},e.fn.ip_Undo=function(r){var r=e.extend({transactionID:""},r),o=e(this).attr("id"),i={transactionID:"",rowDataLoading:!1},t="";if(Object.keys(ip_GridProps[o].undo.undoStack).length>0){var l=[];e("#"+o).ip_RemoveRangeHighlight();for(var n in ip_GridProps[o].undo.undoStack)ip_GridProps[o].undo.undoStack.hasOwnProperty(n)&&l.push(ip_GridProps[o].undo.undoStack[n]);l.sort(function(e,r){return r.transactionSeq-e.transactionSeq}),""==r.transactionID&&(r.transactionID=l[0].transactionID);for(var a=0;a<l.length;a++){var s=l[a].transactionID==r.transactionID?!0:!1,p=ip_UndoTransaction(o,l[a].transactionID,s,s);p.success?(i.transactionID=r.transactionID,ip_RaiseEvent(o,"message",null,"Undo: "+p.method.replace("ip_",""))):a=l.length,p.rowDataLoading&&(i.rowDataLoading=!0),s&&(a=l.length)}""!=i.transactionID?ip_RaiseEvent(o,"ip_Undo",null,{Undo:{Inputs:r,Effected:i}}):t="Unable to undo"}else t="There is nothing to undo";""!=t&&ip_RaiseEvent(o,"warning",null,t)},e.fn.ip_HideShowRows=function(r){var r=e.extend({action:"hide",range:null,rows:null,selectRows:!0,render:!0,raiseEvent:!0,createUndo:!0},r),o=e(this).attr("id"),i=[],t=ip_GenerateTransactionID(),l={action:r.action,rowData:[]},n="";if(null!=r.range){var a=0;null==r.rows&&(r.rows=[]);for(var s=r.range.startRow;s<=r.range.endRow;s++)r.rows[a]=s,a++}else null==r.rows&&(r.rows=ip_GridProps[o].selectedRow.slice(0));if(-1!=jQuery.inArray(-1,r.rows)&&(n="Cannot "+r.action+" all rows, please choose specific rows to hide"),0==r.rows.length&&(n="Nothing specified to hide"),""==n){if("hide"==r.action){for(var a=0;a<r.rows.length;a++){var p=r.rows[a];if(p>=0&&p<ip_GridProps[o].rows&&!ip_GridProps[o].rowData[p].hide){if(r.createUndo){var d={startRow:p,startCol:-1,endRow:p,endCol:ip_GridProps[o].cols-1};ip_AddUndo(o,"ip_HideShowRows",t,"RowData",d,d,{row:d.startRow,col:d.startCol},null,ip_CloneRow(o,p))}ip_GridProps[o].rowData[p].hide=!0,l.rowData[l.rowData.length]={row:p,hide:!0}}}e("#"+o).ip_RemoveRange(),e("#"+o).ip_RemoveRangeHighlight()}else for(var a=0;a<r.rows.length;a++){var p=r.rows[a];if(p>=0&&p<ip_GridProps[o].rows&&ip_GridProps[o].rowData[p].hide){if(r.createUndo){var d={startRow:p,startCol:-1,endRow:p,endCol:ip_GridProps[o].cols-1};ip_AddUndo(o,"ip_HideShowRows",t,"RowData",d,d,{row:d.startRow,col:d.startCol},null,ip_CloneRow(o,p))}ip_GridProps[o].rowData[p].hide=!1,l.rowData[l.rowData.length]={row:p,hide:!1},i.length>0&&i[i.length-1].lastRow==p-1?(i[i.length-1].count++,i[i.length-1].lastRow=p):i[i.length]={row:p,count:1,lastRow:p}}}if(r.render)if(ip_ReRenderRows(o,"frozen"),e(this).ip_Scrollable(),ip_ReRenderRows(o,"scroll"),r.selectRows)for(a=0;a<i.length;a++)e("#"+o).ip_SelectRow({row:i[a].row,count:i[a].count,unselect:!1,multiselect:0==a?!1:!0});else e("#"+o).ip_UnselectRow(),e("#"+o).ip_RemoveRange(),e("#"+o).ip_RemoveRangeHighlight()}""==n&&r.raiseEvent&&ip_RaiseEvent(o,"ip_HideShowRows",t,{HideShowRows:{Inputs:r,Effected:l}}),""!=n&&ip_RaiseEvent(o,"warning",null,n)},e.fn.ip_HideShowColumns=function(r){var r=e.extend({action:"hide",range:null,cols:null,render:!0,raiseEvent:!0,createUndo:!0},r),o=e(this).attr("id"),i=[],t=ip_GenerateTransactionID(),l={action:r.action,colData:[]},n="";if(null!=r.range){var a=0;null==r.cols&&(r.cols=[]);for(var s=r.range.startCol;s<=r.range.endCol;s++)r.cols[a]=s,a++}if(null==r.cols&&(r.cols=ip_GridProps[o].selectedColumn.slice(0)),-1!=jQuery.inArray(-1,r.cols)&&(n="Cannot "+r.action+" all columns, please choose specific column to hide"),0==r.cols.length&&(n="Nothing specified to hide"),""==n){if("hide"==r.action){for(var a=0;a<r.cols.length;a++){var p=r.cols[a];if(p>=0&&p<ip_GridProps[o].cols&&!ip_GridProps[o].colData[p].hide){if(r.createUndo){var d={startRow:-1,startCol:p,endRow:ip_GridProps[o].rows-1,endCol:p};ip_AddUndo(o,"ip_HideShowColumns",t,"ColData",d,d,{row:d.startRow,col:d.startCol},null,ip_CloneCol(o,p))}ip_GridProps[o].colData[p].hide=!0,l.colData[l.colData.length]={col:p,hide:!0}}}e("#"+o).ip_RemoveRange(),e("#"+o).ip_RemoveRangeHighlight()}else for(var a=0;a<r.cols.length;a++){var p=r.cols[a];if(p>=0&&p<ip_GridProps[o].cols&&ip_GridProps[o].colData[p].hide){if(r.createUndo){var d={startRow:-1,startCol:p,endRow:ip_GridProps[o].rows-1,endCol:p};ip_AddUndo(o,"ip_HideShowColumns",t,"ColData",d,d,{row:d.startRow,col:d.startCol},null,ip_CloneCol(o,p))}ip_GridProps[o].colData[p].hide=!1,l.colData[l.colData.length]={col:p,hide:!1},i.length>0&&i[i.length-1].lastCol==p-1?(i[i.length-1].count++,i[i.length-1].lastCol=p):i[i.length]={col:p,count:1,lastCol:p}}}if(r.render)for(e(this).ip_Scrollable(),ip_ReRenderCols(o),ip_RePoistionRanges(o,"all",!0,!1),a=0;a<i.length;a++)e("#"+o).ip_SelectColumn({col:i[a].col,count:i[a].count,unselect:!1,multiselect:0==a?!1:!0})}""==n&&r.raiseEvent&&ip_RaiseEvent(o,"ip_HideShowColumns",t,{HideShowColumns:{Inputs:r,Effected:l}}),""!=n&&ip_RaiseEvent(o,"warning",null,n)},e.fn.ip_GroupRows=function(r){var r=e.extend({groupColumn:0,action:"hide",range:null,rows:null,render:!0,raiseEvent:!0,createUndo:!0},r),o=e(this).attr("id"),i=[],t=ip_GenerateTransactionID(),l={rowData:[]},n="";if(null!=r.range){var a=0;null==r.rows&&(r.rows=[]);for(var s=r.range.startRow;s<=r.range.endRow;s++)r.rows[a]=s,a++}else null==r.rows&&(r.rows=ip_GridProps[o].selectedRow.slice(0));if(-1!=jQuery.inArray(-1,r.rows)&&(n="Cannot group all rows, please choose specific rows to hide"),0==r.rows.length&&(n="Nothing specified to group"),""==n){r.rows.sort(function(e,r){return e-r});for(var p=-1,d=0,c=-2,s=0;s<r.rows.length;s++){if(r.createUndo){var _={startRow:r.rows[s],startCol:-1,endRow:r.rows[s],endCol:ip_GridProps[o].cols-1};ip_AddUndo(o,"ip_GroupRows",t,"RowData",_,_,{row:_.startRow,col:_.startCol},null,ip_CloneRow(o,r.rows[s]))}c!=r.rows[s]-1?(p=r.rows[s],d=l.rowData.length,l.rowData[d]={row:p,groupCount:0,groupColumn:r.groupColumn},ip_GridProps[o].rowData[p].groupCount=0,ip_GridProps[o].rowData[p].groupColumn=r.groupColumn,i[i.length]={row:p,count:1}):(l.rowData[d].groupCount++,ip_GridProps[o].rowData[p].groupCount++,"hide"==r.action&&(l.rowData[l.rowData.length]={row:r.rows[s],hide:!0},ip_GridProps[o].rowData[r.rows[s]].hide=!0)),c=r.rows[s]}if(r.render)for(ip_ReRenderRows(o,"frozen"),e(this).ip_Scrollable(),ip_ReRenderRows(o,"scroll"),a=0;a<i.length;a++)e("#"+o).ip_SelectRow({row:i[a].row,count:i[a].count,unselect:!1,multiselect:0==a?!1:!0})}""==n&&r.raiseEvent&&ip_RaiseEvent(o,"ip_GroupRows",t,{GroupRows:{Inputs:r,Effected:l}}),""!=n&&ip_RaiseEvent(o,"warning",null,n)},e.fn.ip_UngroupRows=function(r){var r=e.extend({range:null,rows:null,render:!0,raiseEvent:!0,createUndo:!0},r),o=e(this).attr("id"),i=[],t=ip_GenerateTransactionID(),l={rowData:[]},n="";if(null!=r.range){var a=0;null==r.rows&&(r.rows=[]);for(var s=r.range.startRow;s<=r.range.endRow;s++)r.rows[a]=s,a++}else null==r.rows&&(r.rows=ip_GridProps[o].selectedRow.slice(0));if(-1!=jQuery.inArray(-1,r.rows)&&(n="Cannot group all rows, please choose specific rows to hide"),0==r.rows.length&&(n="Nothing specified to group"),""==n){var p=ip_GetGroupedRows(o),d={};r.rows.sort(function(e,r){return e-r});for(var s=0;s<r.rows.length;s++){var c=r.rows[s];if(null!=p.rowData[c]){var _=p.rowData[c].groupedWithRow;null==d[_]&&(d[_]={groupedWithRow:p.rowData[c].groupedWithRow,removeCount:p.rowData[c].groupCountDown,showFromRow:c,showToRow:c+p.rowData[c].groupCountDown-1})}}for(key in d){var _=d[key].groupedWithRow;if(r.createUndo){var u={startRow:_,startCol:-1,endRow:_,endCol:ip_GridProps[o].cols-1};ip_AddUndo(o,"ip_UngroupRows",t,"RowData",u,u,{row:u.startRow,col:u.startCol},null,ip_CloneRow(o,_))}ip_GridProps[o].rowData[_].groupCount>0&&(ip_GridProps[o].rowData[_].groupCount-=d[key].removeCount,ip_GridProps[o].rowData[_].groupCount<0&&(ip_GridProps[o].rowData[_].groupCount=0),l.rowData[l.rowData.length]={row:_,groupCount:ip_GridProps[o].rowData[_].groupCount})}if(r.render)for(ip_ReRenderRows(o,"frozen"),e(this).ip_Scrollable(),ip_ReRenderRows(o,"scroll"),a=0;a<i.length;a++)e("#"+o).ip_SelectRow({row:i[a].row,count:i[a].count,unselect:!1,multiselect:0==a?!1:!0})}""==n&&r.raiseEvent&&ip_RaiseEvent(o,"ip_UngroupRows",t,{UngroupRows:{Inputs:r,Effected:l}}),""!=n&&ip_RaiseEvent(o,"warning",null,n)},e.fn.ip_FormatCell=function(r){var o=e(this).attr("id");return ip_SetCellFormat(o,r)},e.fn.ip_FormatCellModal=function(r){var r=e.extend({toolType:"cellFormatting",toolDefault:"celltype"},r),o=e(this).attr("id");if(!(!ip_GridProps[o].selectedRange&&ip_GridProps[o].selectedRange||ip_GridProps[o].selectedRange&&0==ip_GridProps[o].selectedRange.length)){var i=ip_ValidateRangeObjects(o,ip_GridProps[o].selectedRange);r.id=o,r.enabledFormats=ip_EnabledFormats(o,{maxCells:1,getValidation:!0,getControlType:!0,getDataType:!0,getHashTags:!0,getMask:!0,getStyle:!1,adviseDefault:!0}),null==r.enabledFormats.controlType&&(r.enabledFormats.controlType=""),null==r.enabledFormats.hashTags&&(r.enabledFormats.hashTags=""),null==r.enabledFormats.mask&&(r.enabledFormats.mask=""),ip_EnableSelection(o),e().ip_Modal({greyOut:screen,speech:!1,title:"Cell Formatting",message:ip_CreateGridTools(r),buttons:{ok:{text:"SAVE",style:"background: #4d9c3b; background: -moz-linear-gradient(top,  #4d9c3b 0%, #1b6d00 100%);background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#4d9c3b), color-stop(100%,#1b6d00)); background: -webkit-linear-gradient(top,  #4d9c3b 0%,#1b6d00 100%); background: -o-linear-gradient(top,  #4d9c3b 0%,#1b6d00 100%); background: -ms-linear-gradient(top,  #4d9c3b 0%,#1b6d00 100%); background: linear-gradient(to bottom,  #4d9c3b 0%,#1b6d00 100%); filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#4d9c3b', endColorstr='#1b6d00',GradientType=0 ); ",onClick:function(){ip_GridProps[o].formatting.formatting=!1;var r=e("#"+o+"_ValidationValue")[0],t=e("#"+o+"_ValidationValue").val().split(","),l=e("#"+o+"_ControlType").attr("key");i=ip_fxRangeObject(o,null,null,e("#"+o+"_Range_F").val());for(var n=0;n<t.length;n++)ip_fxRangeObject(o,null,null,t[n])?t[n]=t[n].trim():t[n]&&"string"==typeof ip_parseAny(o,t[n])&&(t[n]='"'+t[n].trim()+'"');var a=e("#"+o+"_HashTags")[0].val(),s="="+l+"("+(e(r).hasClass("tooltip")?"":t)+")",p=ip_GetCellControlType(o,s,null,null,null),d=e("#"+o+"_DataType").attr("key").replace(/default/gi,"").split("~"),c=e("#"+o+"_Mask").attr("key"),_=!1;""==d[0]||d[1]&&""!=d[1]||(d[1]=d[0]),p.validation.validationAction=e("#"+o+"_Action").attr("key"),p.dataType=ip_dataTypeObject(d[0],d[1]),e("#"+o+"_Mask").hasClass("ip-dirty")||e("#"+o+"_DataType").hasClass("ip-dirty")||(c=null),e("#"+o+"_HashTags").hasClass("ip-dirty")||(a=null),e("#"+o+"_DataType").hasClass("ip-dirty")||(p.dataType=null),e("#"+o+"_ControlType").hasClass("ip-dirty")||e("#"+o+"_ValidationValue").hasClass("ip-dirty")||(p.controlType=null),e("#"+o+"_ValidationValue").hasClass("ip-dirty")||(p.validation.validationCriteria=null),e("#"+o+"_Action").hasClass("ip-dirty")||(p.validation.validationAction=null),e("#"+o+"_ValidationValue").hasClass("ip-dirty")||e("#"+o+"_Action").hasClass("ip-dirty")||(p.validation=null),(null!=p.validation||null!=p.controlType||null!=p.dataType||null!=a||null!=c)&&(_=null!=a||null!=p.dataType||null!=c||null!=p.validation,ip_SetCellFormat(o,{mask:c,validation:p.validation,controlType:p.controlType,dataType:p.dataType,hashTags:a,recalculate:_})),ip_DisableSelection(o),e().ip_Modal({show:!1})}},cancel:{text:"CANCEL",style:"background: #9c3b3b;background: -moz-linear-gradient(top,  #9c3b3b 0%, #752c2c 100%); background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#9c3b3b), color-stop(100%,#752c2c)); background: -webkit-linear-gradient(top,  #9c3b3b 0%,#752c2c 100%); background: -o-linear-gradient(top,  #9c3b3b 0%,#752c2c 100%); background: -ms-linear-gradient(top,  #9c3b3b 0%,#752c2c 100%); background: linear-gradient(to bottom,  #9c3b3b 0%,#752c2c 100%); filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#9c3b3b', endColorstr='#752c2c',GradientType=0 );",onClick:function(){ip_GridProps[o].formatting.formatting=!1,ip_DisableSelection(o),e().ip_Modal({show:!1})}}}}),e(".formatting-tool").on("change",function(){e(this).addClass("ip-dirty")}),e("#"+o+"_ControlType").ip_DropDown({init:!0,defaultKey:r.enabledFormats.controlType,events:{onChange:function(i){for(var t=e("#"+o+"_ValidationValue")[0],l=0;l<ip_GridProps[o].controlTypes.length;l++)if(i.key==ip_GridProps[o].controlTypes[l].key){e(t).attr("placeholder",ip_GridProps[o].controlTypes[l].example),e(t).val("");break}r.enabledFormats.validation.validationCriteria&&-1!=r.enabledFormats.validation.validationCriteria.indexOf(i.key)&&r.enabledFormats.validation.inputs&&(e(t).val(r.enabledFormats.validation.inputs.join(", ").replace(/["]/g,"")),e(t).removeClass("tooltip")),""==i.key?e(t).hide():e(t).show()}},dropDownItems:ip_GridProps[o].controlTypes});var t=function(i,t){var l=r.enabledFormats.mask;null!=t&&(l=""),e("#"+o+"_Mask").html(""),e("#"+o+"_Mask").ip_DropDown({init:!0,defaultKey:l,defaultIndex:""==l?0:null,events:{onChange:function(){}},dropDownItems:function(){var r=ip_GetMasksForDataType(o,i);if(null!=r){for(var t=[],l=0;l<r.length;l++){var n='<table style="width:100%;" cellpadding="0" cellspacing="0"><tr><td style="text-align:left;color:#46b3ff;">'+(null==r[l].title?"":r[l].title)+'</td><td style="text-align:right;padding:0px 4px 0px 10px;font-size:90%;">'+r[l].mask+"</td><tr/></table>";t.push({key:r[l].mask,value:n})}return e("#"+o+"_Mask").show(),t}return e("#"+o+"_Mask").hide(),[]}})};e("#"+o+"_HashTags").ip_TagInput({tags:r.enabledFormats.hashTags});var l=function(){var i=[{value:"default",key:"~default"}],l=r.enabledFormats.dataType.dataType+"~"+(""==r.enabledFormats.dataType.dataTypeName?"default":r.enabledFormats.dataType.dataTypeName);t(r.enabledFormats.dataType);for(var n=0;n<ip_GridProps[o].dataTypes.length;n++){var a=ip_GridProps[o].dataTypes[n].dataTypeName+(ip_GridProps[o].dataTypes[n].dataType!=ip_GridProps[o].dataTypes[n].dataTypeName&&null!=ip_GridProps[o].dataTypes[n].dataType&&""!=ip_GridProps[o].dataTypes[n].dataType?" ("+ip_GridProps[o].dataTypes[n].dataType+")":""),s=(null==ip_GridProps[o].dataTypes[n].dataType?"":ip_GridProps[o].dataTypes[n].dataType)+"~"+ip_GridProps[o].dataTypes[n].dataTypeName;i[i.length]={value:a,key:s}}e("#"+o+"_DataType").ip_DropDown({init:!0,events:{onChange:function(e){var r=e.key.split("~");t({dataType:r[0],dataTypeName:r[1]},0)}},defaultKey:l,dropDownItems:i})};l(),e("#"+o+"_Action").ip_DropDown({init:!0,defaultKey:r.enabledFormats.validation.validationAction,dropDownItems:[{key:"",value:"default"},{key:"allow",value:"allow incorrect input"},{key:"warn",value:"warn"},{key:"prevent",value:"reject incorrect input"}]}),r.enabledFormats.validation.inputs&&(e("#"+o+"_ValidationValue").val(r.enabledFormats.validation.inputs.join(", ").replace(/["]/g,"")),e("#"+o+"_ValidationValue").removeClass("tooltip")),e("#"+o+"_ValidationValue").on("keydown",function(){e(this).hasClass("tooltip")&&e(this).removeClass("tooltip")}),e("#"+o+"_Range_F").on("focus",function(){ip_GridProps[o].formatting.focusedControl=this}),e("#"+o+"_Range_F").val(ip_fxRangeToString(o,i)),e("#"+o+"_Range_F").focus(),ip_GridProps[o].formatting.formatting=!0}},e.fn.ip_EnabledFormats=function(r){var o=e(this).attr("id");return ip_EnabledFormats(o,r)},e.fn.ip_ResizeGrid=function(r){var o=e(this).attr("id");ip_ResizeGrid(o,r.width)},e.fn.ip_CellInput=function(r){var o=e(this).attr("id");ip_CellInput(o,r)},e.fn.ip_Render=function(){var r=e(this).attr("id");ip_ReRenderRows(r)},e.fn.ip_ReCalculate=function(r){var o=e(this).attr("id");r=e.extend({range:[{startRow:0,startCol:0,endRow:ip_GridProps[o].rows-1,endCol:ip_GridProps[o].cols-1}]},r),ip_ReCalculateFormulas(o,r)},e.fn.ip_Border=function(r){var r=e.extend({range:null,row:null,col:null,borderStyle:"solid",borderSize:1,borderColor:"black",borderPlacement:"",raiseEvent:!0,render:!0},r);"none"==r.borderPlacement&&(r.borderStyle="none");var o=e(this).attr("id"),i=ip_GenerateTransactionID(),t={},l=r.borderPlacement,n=r.borderStyle,a=r.borderSize,s=r.borderColor,p="";if(null==r.range&&null!=r.row&&null!=r.col&&(r.range=[ip_rangeObject(r.row,r.col,r.row,r.col)]),null==r.range&&0==ip_GridProps[o].selectedRange.length)p="Please specify a range";else if(null==r.range){r.range=[];for(var d=0;d<ip_GridProps[o].selectedRange.length;d++)r.range[d]=ip_rangeObject(ip_GridProps[o].selectedRange[d][0][0],ip_GridProps[o].selectedRange[d][0][1],ip_GridProps[o].selectedRange[d][1][0],ip_GridProps[o].selectedRange[d][1][1],null,r.col)}r.range=ip_ValidateRangeObjects(o,r.range),t={range:r.range,border:{borderStyle:n,borderPlacement:l,borderSize:a,borderColor:s}};for(var d=0;d<r.range.length;d++){var c=r.range[d],_=c.startRow,u=c.endRow,g=c.startCol,w=c.endCol,f=ip_AddUndo(o,"ip_Border",i,"CellData",c,c,0==d?{row:c.startRow,col:c.startCol}:null);"top"==l?u=_:"right"==l?g=w:"bottom"==l?_=u:"left"==l&&(w=g);for(var h=_;u>=h;h++)for(var m=g;w>=m;m++)if(ip_AddUndoTransactionData(o,f,ip_CloneCell(o,h,m)),"top"==l)ip_cellBorder(o,h,m,n,a,s,["top"]);else if("right"==l)ip_cellBorder(o,h,m,n,a,s,["right"]);else if("bottom"==l)ip_cellBorder(o,h,m,n,a,s,["bottom"]);else if("left"==l)ip_cellBorder(o,h,m,n,a,s,["left"]);else if("all"==l)ip_cellBorder(o,h,m,n,a,s,["top","right","left","bottom"]);else if("none"==l)ip_cellBorder(o,h,m,n,a,s,["top","right","left","bottom"]);else if("horizontal"==l)u>h&&ip_cellBorder(o,h,m,n,a,s,["bottom"]),h>_&&ip_cellBorder(o,h,m,"none",a,s,["top"]);else if("vertical"==l)w>m&&ip_cellBorder(o,h,m,n,a,s,["right"]),m>g&&ip_cellBorder(o,h,m,"none",a,s,["left"]);else if("inner"==l){var v=[];h!=u&&v.push("bottom"),m!=w&&v.push("right"),ip_cellBorder(o,h,m,n,a,s,v),v=[],h!=_&&v.push("top"),m!=g&&v.push("left"),ip_cellBorder(o,h,m,"none",a,s,v)}else if("outer"==l){var v=[];h==_&&v.push("top"),m==g&&v.push("left"),h==u&&v.push("bottom"),m==w&&v.push("right"),ip_cellBorder(o,h,m,n,a,s,v)}}return""!=p?(ip_RaiseEvent(o,"warning",i,p),null):(r.render&&ip_ReRenderRanges(o,r.range),void(r.raiseEvent&&ip_RaiseEvent(o,"ip_Border",i,{Border:{Inputs:r,Effected:t}})))},e.fn.ip_AddFormula=function(r){var r=e.extend({formulaName:null,functionName:null,tip:null,inputs:null,example:null},r),o=e(this).attr("id"),i=r.functionName,t=r.formulaName,l=r.tip,n=r.inputs,a=r.example;return null==t||null==i?"error - formulaName and functionName options must be specified":(void 0==ip_GridProps[o].fxList[t]?ip_GridProps[o].fxList[t]={fxName:i}:ip_GridProps[o].fxList[t].fxName=i,null==ip_GridProps[o].fxList[t].fxInfo&&(ip_GridProps[o].fxList[t].fxInfo={name:t,tip:"",inputs:"",example:""}),null!=l&&(ip_GridProps[o].fxList[t].fxInfo.tip=l),null!=n&&(ip_GridProps[o].fxList[t].fxInfo.inputs=n),null!=a&&(ip_GridProps[o].fxList[t].fxInfo.example=a),!0)},e.fn.ip_AddMask=function(r){var r=e.extend({dataType:null,input:function(e){return e},output:function(e){return e},mask:null,title:""},r),o=e(this).attr("id"),i=r.input,t=r.output,l=r.dataType.toLowerCase(),n=r.mask,a=r.title,s=null;if(null==l||null==n)return"error - mask and dataType options must be specified";null==ip_GridProps[o].mask[l]&&(ip_GridProps[o].mask[l]=[]);for(var p=0;p<ip_GridProps[o].mask[l].length;p++)if(ip_GridProps[o].mask[l][p].mask==n){s=ip_GridProps[o].mask[l][p];break}return null!=s?s.title=a:(s={mask:n,title:a},ip_GridProps[o].mask[l].push(s)),null==ip_GridProps[o].mask.input&&(ip_GridProps[o].mask.input={}),null==ip_GridProps[o].mask.output&&(ip_GridProps[o].mask.output={}),ip_GridProps[o].mask.input[n]=i,ip_GridProps[o].mask.output[n]=t,!0},e.fn.ip_PositionElement=function(r){{var r=e.extend({relativeTo:document.body,position:null,positionNAN:[],offset:{y:0,x:0},axisContainment:!0,windowContainment:!0,animate:600},r);e(this).attr("id")}if(0==e(document.body).children(this)&&e(this).appendTo(document.body),null!=r.relativeTo&&null==r.position){var o=1,i=Math.ceil(e(window).width()/3),t=Math.ceil(e(window).height()/3),l=(e(r.relativeTo).outerWidth(!0),e(r.relativeTo).outerWidth(!0),e(r.relativeTo).offset().top),n=e(r.relativeTo).offset().left,a={top:0*t,left:0*i,bottom:0*t+t,right:0*i+i},s={top:0*t,left:1*i,bottom:0*t+t,right:1*i+i},p={top:0*t,left:2*i,bottom:0*t+t,right:2*i+i},d={top:1*t,left:0*i,bottom:1*t+t,right:0*i+i},c={top:1*t,left:1*i,bottom:1*t+t,right:1*i+i},_={top:1*t,left:2*i,bottom:1*t+t,right:2*i+i},u={top:2*t,left:0*i,bottom:2*t+t,right:0*i+i},g={top:2*t,left:1*i,bottom:2*t+t,right:1*i+i},w={top:2*t,left:2*i,bottom:2*t+t,right:2*i+i};l>a.bottom||n>a.right?l>s.bottom||n>s.right?l>p.bottom||n>p.right?l>d.bottom||n>d.right?l>c.bottom||n>c.right?l>_.bottom||n>_.right?l>u.bottom||n>u.right?l>g.bottom||n>g.right?l>w.bottom||n>w.right||(r.position=["left","bottom"],o=9):(r.position=["left","bottom"],o=8):(r.position=["right","bottom"],o=7):(r.position=["left","center"],o=6):(r.position=["left","center"],o=5):(r.position=["right","center"],o=4):(r.position=["left","top"],o=3):(r.position=["left","top"],o=2):(r.position=["right","top"],o=1)}if(r.positionNAN)for(var f=0;f<r.positionNAN.length;f++)r.positionNAN[f]==r.position[0]&&"left"==r.position[0]?r.position[0]=7>o?"bottom":"top":r.positionNAN[f]==r.position[0]&&"right"==r.position[0]?r.position[0]=7>o?"bottom":"top":r.positionNAN[f]==r.position[0]&&"top"==r.position[0]?r.position[0]=2==o||3==o||5==o||6==o||8==o||9==o?"left":"right":r.positionNAN[f]==r.position[0]&&"bottom"==r.position[0]?r.position[0]=2==o||3==o||5==o||6==o||8==o||9==o||-1!=r.positionNAN.indexOf("right")?"left":"right":r.positionNAN[f]==r.position[1]&&"center"==r.position[1]&&(r.position[1]=2==o||3==o||5==o||6==o||8==o||9==o||-1!=r.positionNAN.indexOf("right")?"left":"right"),"bottom"!=r.position[0]&&"top"!=r.position[0]||"bottom"!=r.position[1]&&"top"!=r.position[1]?"left"!=r.position[0]&&"left"!=r.position[0]||"left"!=r.position[1]&&"right"!=r.position[1]||(r.position[1]="bottom"):r.position[1]=1==o||2==o||4==o||5==o||7==o||8==o?"left":"right";var h=r.relativeTo==screen||r.relativeTo==window?e(document).scrollTop():e(r.relativeTo).offset().top,m=r.relativeTo==screen||r.relativeTo==window?e(document).scrollLeft():e(r.relativeTo).offset().left,v=r.relativeTo==screen||r.relativeTo==window?window.innerWidth:e(r.relativeTo).outerWidth(),C=r.relativeTo==screen||r.relativeTo==window?window.innerHeight:e(r.relativeTo).outerHeight(),R=0,G=0,P={x:!1,y:!1},y={callout:"",position:null};r.size={width:e(this).outerWidth(!0),height:e(this).outerHeight(!0)};for(var f=0;f<r.position.length;f++)r.position[f]=r.position[f].toLowerCase().trim(),r.axisContainment&&(P.x||"left"!=r.position[f]&&"right"!=r.position[f]||(P.y=!0),P.y||"top"!=r.position[f]&&"bottom"!=r.position[f]||(P.x=!0));return-1!=r.position.indexOf("inside")&&(R=h,G=m),-1!=r.position.indexOf("top")&&(R=h-(-1==r.position.indexOf("inside")?r.size.height:0),-1==r.position.indexOf("left")&&-1==r.position.indexOf("right")&&(G=m)),-1!=r.position.indexOf("bottom")&&(R=h+(-1==r.position.indexOf("inside")?C:Math.max(0,C-r.size.height)),-1==r.position.indexOf("left")&&-1==r.position.indexOf("right")&&(G=m)),-1!=r.position.indexOf("left")&&(-1==r.position.indexOf("top")&&-1==r.position.indexOf("bottom")&&(R=C),G=m-(-1==r.position.indexOf("inside")?r.size.width:0)),-1!=r.position.indexOf("right")&&(-1==r.position.indexOf("top")&&-1==r.position.indexOf("bottom")&&(R=C),G=m+(-1==r.position.indexOf("inside")?v:Math.max(0,v-r.size.width))),-1!=r.position.indexOf("center")&&(-1==r.position.indexOf("top")&&-1==r.position.indexOf("bottom")&&(R=h,R+=Math.max(0,(C-r.size.height)/2)),-1==r.position.indexOf("right")&&-1==r.position.indexOf("left")&&(G=m,G+=Math.max(0,(v-r.size.width)/2))),P.y&&(-1==r.position.indexOf("bottom")&&h>R&&(R=h),-1==r.position.indexOf("center")&&-1==r.position.indexOf("top")&&R+r.size.height>h+C&&(R=h+(C-r.size.height)),-1!=r.position.indexOf("center")&&-1==r.position.indexOf("top")&&R+r.size.height>h+C&&(R=h+(C-r.size.height)/2)),P.x&&(-1==r.position.indexOf("right")&&m>G&&(G=m),-1==r.position.indexOf("center")&&-1==r.position.indexOf("left")&&G+r.size.width>m+v&&(G=m+(v-r.size.width)),-1!=r.position.indexOf("center")&&G+r.size.width>m+v&&(G=m+(v-r.size.width)/2)),"top"==r.position[0]?R-=r.offset.y:"bottom"==r.position[0]?R+=r.offset.y:"inside"==r.position[0]&&(R+=r.offset.y),"left"==r.position[0]?G-=r.offset.x:"right"==r.position[0]?G+=r.offset.x:"inside"==r.position[0]&&(G+=r.offset.x),G>e(window).width()&&(G=e(window).width()-e(this).outerWidth(!0)),R>e(window).height()&&(R=e(window).height()-e(this).outerHeight(!0)),e(this).animate({top:R,left:G},r.animate,"easeInOutQuint"),P.y&&-1!=r.position.indexOf("left")&&-1!=r.position.indexOf("top")?y.callout="rightTop":P.y&&-1!=r.position.indexOf("left")&&-1!=r.position.indexOf("bottom")?y.callout="rightBottom":P.y&&-1!=r.position.indexOf("right")&&-1!=r.position.indexOf("top")?y.callout="leftTop":P.y&&-1!=r.position.indexOf("right")&&-1!=r.position.indexOf("bottom")?y.callout="leftBottom":P.y&&-1!=r.position.indexOf("right")&&-1!=r.position.indexOf("top")?y.callout="leftTop":P.x&&-1!=r.position.indexOf("top")&&-1!=r.position.indexOf("left")?y.callout="bottomLeft":P.x&&-1!=r.position.indexOf("top")&&-1!=r.position.indexOf("right")?y.callout="bottomRight":P.x&&-1!=r.position.indexOf("bottom")&&-1!=r.position.indexOf("left")?y.callout="topLeft":P.x&&-1!=r.position.indexOf("bottom")&&-1!=r.position.indexOf("right")?y.callout="topRight":-1!=r.position.indexOf("top")?y.callout="bottom":-1!=r.position.indexOf("left")?y.callout="right":-1!=r.position.indexOf("right")?y.callout="left":-1!=r.position.indexOf("bottom")&&(y.callout="top"),y.position=r.position,y},e.fn.ip_Modal=function(r){var r=e.extend({modalSessionID:null,modalType:null,buttons:null,title:"",message:"",relativeTo:screen,cssClass:"ip_Modal",position:["inside","center"],positionNAN:[],offset:{x:0,y:0},size:null,axisContainment:!0,windowContainment:!0,animate:0,fade:0,zIndex:101,speech:!0,show:!0,greyOut:screen,focus:"input:text"},r),o={ok:{text:"OK",style:"background: #4d9c3b; background: -moz-linear-gradient(top,  #4d9c3b 0%, #1b6d00 100%);background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#4d9c3b), color-stop(100%,#1b6d00)); background: -webkit-linear-gradient(top,  #4d9c3b 0%,#1b6d00 100%); background: -o-linear-gradient(top,  #4d9c3b 0%,#1b6d00 100%); background: -ms-linear-gradient(top,  #4d9c3b 0%,#1b6d00 100%); background: linear-gradient(to bottom,  #4d9c3b 0%,#1b6d00 100%); filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#4d9c3b', endColorstr='#1b6d00',GradientType=0 ); ",onClick:null},cancel:{text:"CANCEL",style:"background: #9c3b3b;background: -moz-linear-gradient(top,  #9c3b3b 0%, #752c2c 100%); background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#9c3b3b), color-stop(100%,#752c2c)); background: -webkit-linear-gradient(top,  #9c3b3b 0%,#752c2c 100%); background: -o-linear-gradient(top,  #9c3b3b 0%,#752c2c 100%); background: -ms-linear-gradient(top,  #9c3b3b 0%,#752c2c 100%); background: linear-gradient(to bottom,  #9c3b3b 0%,#752c2c 100%); filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#9c3b3b', endColorstr='#752c2c',GradientType=0 );",onClick:function(){e().ip_Modal({show:!1})}}},i=e("#ip_modal"),t=r.greyOut==window||r.greyOut==screen?document.body:r.greyOut,l=i.length>0&&i[0].modalSessionID==r.modalSessionID&&null!=i[0].modalSessionID;if(!r.show)return 0==r.fade?(e(i).removeClass("show"),e(i).addClass("hide")):e(i).fadeOut(),e(t).ip_GreyOut({show:!1}),void(i.length>0&&(i[0].modalSessionID=r.modalSessionID));l||(0==i.length?(e(document.body).append('<div id="ip_modal" class="'+r.cssClass+" "+(r.anitmate>0?"hide":"")+'"><div  class="ip_ModalTitle"></div><div  class="ip_ModalBody"></div><div  class="ip_ModalButtons"></div>'),i=e("#ip_modal")[0]):(e(i).attr("class",r.cssClass+" "+(r.anitmate>0?"hide":"")),i=e("#ip_modal")[0])),i.modalSessionID=r.modalSessionID,e(i).css("z-index",r.zIndex),e(i).find(".ip_ModalTitle").html(r.title),e(i).find(".ip_ModalBody").html(r.message),e(i).find(".ip_ModalButtons").html("");for(var n in r.buttons)o[n]?((void 0!=r.buttons[n].text||null==r.buttons[n].onClick)&&(o[n].text=r.buttons[n].text),(void 0!=r.buttons[n].style||null==r.buttons[n].onClick)&&(o[n].style=r.buttons[n].style),(void 0!=r.buttons[n].onClick||null==r.buttons[n].onClick)&&(o[n].onClick=r.buttons[n].onClick)):o[n]=r.buttons[n];for(var n in o)"function"==typeof o[n].onClick&&e(i).find(".ip_ModalButtons").append('<input type="button" key="'+n+'" style="'+o[n].style+'" tabindex="1" class="button ip_ModalButton" value="'+o[n].text+'" />');if(e(".ip_ModalButton").unbind("click"),e(".ip_ModalButton").on("click",function(){e(this).focus();var r=e(this).attr("key");"function"==typeof o[r].onClick&&o[r].onClick()}),null!=r.size&&(e(this).outerWidth(r.size.width),e(this).outerHeight(r.size.height)),!l){var a={callout:""};null!=r.relativeTo&&(a=e(i).ip_PositionElement(r)),""==a.callout&&(a.callout="bottomRight"),e("#ip_ModalSpeech").attr("class",""),r.speech&&""!=a.callout&&(0==e("#ip_ModalSpeech").length&&e(i).append('<b id="ip_ModalSpeech"></b>'),e("#ip_ModalSpeech").addClass("ip_Speech "+a.callout)),0==r.fade?(e(i).css("display",""),e(i).removeClass("hide"),e(i).addClass("show")):e(i).fadeIn(),e(i).draggable({cancel:".no-drag",start:function(){e("#ip_ModalSpeech").attr("class","")
}})}r.greyOut&&e(t).ip_GreyOut(),e(i).find(r.focus).focus()},e.fn.ip_GreyOut=function(r){var r=e.extend({titleClass:"GreyOutTitle",title:"",show:!0,color:"white",fade:!0,onclick:null,opacity:.5,zIndex:100,showProgress:!0},r);return this.each(function(){var o=(e(this).attr("id"),e(this).children(".ip_GreyOut"));0==o.length&&(o=e('<div class="ip_GreyOut" style="display:none;position:absolute;top:0px;left:0px;background-color:'+r.color+";opacity:"+r.opacity+";filter: alpha(opacity="+100*r.opacity+");z-index:"+r.zIndex+';width:100%;height:100%;"></div>')),e(o).appendTo(this),o=e(this).children(".ip_GreyOut");var i=e(this).children("#ec_GreyOutTitle");if(0==i.length&&(e('<div id="ec_GreyOutTitle" class="GreyOutTitle" style="position: absolute;"></div>').appendTo(this),i=e(this).children("#ec_GreyOutTitle")),r.show){if(""!=r.title){var t=(e(o).outerHeight()-e(i).outerHeight())/2;this==document.body?(t=(e(window).outerHeight()-e(i).outerHeight())/2,e(i).attr("style","position: fixed;")):e(i).attr("style","position: absolute;"),e(i).removeClass(),e(i).addClass(r.titleClass),e(i).show(),e(i).html(r.title),e(i).css("top",t+"px"),e(i).css("left",(e(o).outerWidth()-e(i).outerWidth())/2+"px"),e(i).css("z-index",parseInt(e(o).css("z-index"))+1)}else e(i).hide();r.fade?e(o).fadeIn():e(o).show()}else e(i).hide(),r.fade?e(o).fadeOut():e(o).hide();e(o).unbind("click"),"function"==typeof r.onclick&&e(o).click(function(){r.onclick()})})},e.fn.ip_TagInput=function(r){var r=e.extend({tags:null,includeHashTag:!0},r),o=(e(this).attr("id"),this);for(i=0;i<o.length;i++){var t,l=o[i],n=null,a=e(l).attr("placeholder");"string"==typeof r.tags&&(r.tags=r.tags.split(",")),null!=r.tags?(n=r.tags,r.tags=[]):r.tags=[],void 0==a&&(a=""),e(l).html(""),e(l).append('<div class="ip_TagInput"><div contenteditable="true" tabindex="0" class="ip_TagInputTextBox" /><div class="ip_TagInputPlaceholder">'+a+"</div></div>");var t=e(l).children(".ip_TagInput")[0],s=e(t).children(".ip_TagInputTextBox")[0];if(l.addTag=function(o,i){void 0==o&&(o=s);var t="object"==typeof o?e(o).text():o;""!=t&&void 0!=t&&null!=t&&("#"!=t[0]&&r.includeHashTag&&(t="#"+t),-1==r.tags.indexOf(t)&&(e('<div class="ip_TagInputTag">'+t+'<div class="ip_TagInputTagClose">x</div></div>').insertBefore(s),r.tags.push(t)),"object"==typeof o&&e(o).text(""),i||e(l).trigger("AddTag",{tag:t,tags:r.tags}),i||e(l).trigger("change",{tag:t,tags:r.tags,action:"AddTag"}))},l.removeTag=function(o,i){var n=e(t).children(".ip_TagInputTag");void 0==o&&void 0==i?o=n.length-1:void 0!=i&&null!=i&&(o=e(n).index(i));var a=e(n[o]).text();e(n[o]).remove(),r.tags.splice(o,1),e(l).trigger("RemoveTag",{tag:a,tags:r.tags}),e(l).trigger("change",{tag:a,tags:r.tags,action:"RemoveTag"})},l.val=function(){for(var e="",o=0;o<r.tags.length;o++)e+=r.tags[o],o!=r.tags.length-1&&(e+=",");return e},null!=n)for(var p=0;p<n.length;p++)l.addTag(n[p].trim(),!0);e(l).unbind("keydown"),e(l).unbind("click"),e(l).unbind("focus"),e(l).unbind("focusout"),e(l).on("click",function(){ip_SetCursorPos(null,s)}),e(l).on("keydown",".ip_TagInputTextBox",function(r){switch(r.keyCode){case 13:return l.addTag(this),!1;case 8:var o=e(this).text();""==o&&l.removeTag();break;case 188:return l.addTag(this),!1}}),e(l).on("click",".ip_TagInputTagClose",function(){l.removeTag(null,e(this).parent()[0])}),e(l).on("focus",".ip_TagInputTextBox",function(){e(t).find(".ip_TagInputPlaceholder").hide()}),e(l).on("focusout",".ip_TagInputTextBox",function(){l.addTag(),0==r.tags.length&&""==e(s).text()&&e(t).find(".ip_TagInputPlaceholder").show()}),0!=r.tags.length&&e(t).find(".ip_TagInputPlaceholder").hide(),l.options=r}},e.fn.ip_DropDown=function(r){var o,i,t,l,n,a,r=e.extend({select:null,editable:!0,defaultIndex:null,defaultValue:null,defaultKey:null,text:null,key:null,dropDownItems:[],init:!1,events:{onChange:null}},r),s="",p=this[0];if(p.initObjects=function(){o=this,i=e(this).attr("id"),t=e(this).find(".ip_DropDownText"),l=e(this).find(".ip_DropDownItems"),n=e(this).find(".ip_DropDownIcon"),a=e(l).find(".ip_DropDownItem"),e(o).attr("key",""),s=""},this[0].initObjects(),this.val=function(){return e(this).attr("key")},null!=r.select)return"number"==typeof r.select&&e(a)[r.select].click(),void e(this).find(".ip_DropDownItem").each(function(){e(this).attr("key")==r.select&&e(this).click()});if("function"==typeof r.dropDownItems&&(r.dropDownItems=r.dropDownItems()),null==r.dropDownItems&&(r.dropDownItems=[]),0==l.length&&(e(this).append('<div class="ip_DropDownItems"></div>'),l=e(this).find(".ip_DropDownItems")),0==n.length&&(e(this).append('<div class="ip_DropDownIcon down"></div>'),n=e(this).find(".ip_DropDownIcon")),0==t.length&&(e(this).append('<div class="ip_DropDownText" contenteditable="true"></div>'),t=e(this).find(".ip_DropDownText")),l=l[0],t=t[0],n=n[0],e(t).css("width",e(o).outerWidth()-parseInt(e(t).css("margin-left").replace(/[a-z]/gi,""))-2*e(n).outerWidth()+"px"),e(t).attr("placeholder",e(o).attr("placeholder")),r.editable&&e(t).css("content-editable","true"),r.dropDownItems.length>0)for(var d=0;d<r.dropDownItems.length;d++)null!=r.defaultKey&&r.defaultKey==r.dropDownItems[d].key?r.defaultIndex=d:null!=r.defaultValue&&r.defaultValue==r.dropDownItems[d].value&&(r.defaultIndex=d),e(l).append('<div key="'+r.dropDownItems[d].key+'" class="ip_DropDownItem '+(r.dropDownItems[d].title?"title":"")+" "+(null!=r.text&&r.dropDownItems[d].value.trim().toLowerCase()==r.text.trim().toLowerCase()||d==r.defaultIndex?"hover":"")+'" title="'+(r.dropDownItems[d].tooltip?r.dropDownItems[d].tooltip:"")+'">'+r.dropDownItems[d].value+"</div>");if(a=e(l).find(".ip_DropDownItem"),e(n).css("top",(e(this).outerHeight()-parseInt(e(n).css("border-top-width").replace("px","")))/2+"px"),e(l).css("min-width",e(this).width()),e(this).attr("defaultText",r.text),r.init){l.timeout=null,l.show=function(r){if(clearTimeout(l.timeout),!e(l).is(":visible")){var r=e.extend({delay:150,scrollTop:null},r);null!=r.scrollTop&&e(l).scrollTop(r.scrollTop),e(l).css("max-height",""),e(l).show();var o=e(l).offset().top,i=e(l).outerHeight();e(l).hide();var t=e(window).height(),n=o+i,s="";n>t&&(s=t-o-20),""!=s&&e(l).css("max-height",s+"px"),e(a).each(function(){e(this).removeClass("nohover"),e(this).removeClass("hover"),e(this).show()}),e(l).slideDown(r.delay)}},e(t).on("keypress",function(e){return 13==e.keyCode?!1:void 0}),e(t).on("keyup",function(r){if(40!=r.keyCode&&38!=r.keyCode&&13!=r.keyCode){var i=e(this).text().toLowerCase().trim();e(o).closest(".ip_DropDown").attr("key",i),e(a).each(function(){-1==e(this).text().toLowerCase().indexOf(i)?e(this).hide():e(this).show()})}return 13==r.keyCode?(e(a).each(function(){return e(this).hasClass("hover")?void e(this).click():void 0}),!1):void 0}),e(t).on("keydown",function(r){if(40==r.keyCode){if(0==a.length)return;l.show({delay:0});for(var o=null,i=null,n=0;n<a.length;n++)null!=o&&e(a[n]).is(":visible")?(e(a[n]).addClass("hover"),e(a[n]).removeClass("nohover"),i=n,o=null):e(a[n]).hasClass("hover")&&(o=n,e(a[n]).removeClass("hover"),e(a[n]).addClass("nohover"));null==i&&(e(a[0]).addClass("hover"),e(a[0]).removeClass("nohover"),o=0,i=0);var s=e(l).scrollTop(),p=e(l).height();if(e(a[i]).position().top>p||e(a[i]).position().top<0){var d=s+e(a[i]).position().top;e(l).animate({scrollTop:d},100)}e(t).text(e(a[i]).text()),e(t).select()}else if(38==r.keyCode){if(0==a.length)return;l.show({delay:0});for(var o=null,i=null,n=a.length-1;n>=0;n--)null!=o&&e(a[n]).is(":visible")?(e(a[n]).addClass("hover"),e(a[n]).removeClass("nohover"),i=n,o=null):e(a[n]).hasClass("hover")&&(o=n,e(a[n]).removeClass("hover"),e(a[n]).addClass("nohover"));null==i&&(e(a[a.length-1]).addClass("hover"),e(a[a.length-1]).removeClass("nohover"),o=a.length-1,i=a.length-1);var s=e(l).scrollTop(),p=e(l).height();if(e(a[i]).position().top>p||e(a[i]).position().top<0){var d=s+e(a[i]).position().top-e(l).height()+e(a[i]).height();e(l).animate({scrollTop:d},100)}e(t).text(e(a[i]).text()),e(t).select()}}),e(this).unbind("click"),e(this).on("click",function(){this.initObjects(),l[0].show({scrollTop:0}),e(t).focus()}),e(this).unbind("mouseenter"),e(this).on("mouseenter",function(){clearTimeout(l.timeout)}),e(this).unbind("mouseleave"),e(this).on("mouseleave",function(){l.timeout=setTimeout(function(){e(l).slideUp(300)},300)}),e(this).unbind("mouseenter.ip_controls"),e(this).on("mouseenter.ip_controls",".ip_DropDownItem",function(){e(this).hasClass("title")||(e(this).addClass("hover"),e(this).removeClass("nohover"))}),e(this).unbind("mouseleave.ip_controls"),e(this).on("mouseleave.ip_controls",".ip_DropDownItem",function(){clearTimeout(l.timeout),e(this).addClass("nohover"),e(this).removeClass("hover")}),e(this).unbind("click.ip_controls"),e(this).on("click.ip_controls",".ip_DropDownItem",{init:!1},function(i){var t=this;if(e(t).hasClass("title")){var l=e.inArray(t,a);l<a.length&&(t=a[l+1])}e(t).addClass("selected");var n=e(t).attr("key"),s=e(t).html();e(t).closest(".ip_DropDown").attr("key",n),e(t).closest(".ip_DropDown").find(".ip_DropDownText").html(s),e(t).closest(".ip_DropDownItems").slideUp(100),_||(e(o).addClass("ip-dirty"),null!=r.events.onChange&&r.events.onChange({key:n,value:s})),i.stopPropagation()});var c="";e(this).unbind("focus.ip_controls"),e(this).unbind("blur.ip_controls"),e(this).on("focus",".ip_DropDownText",function(){c=e(this).text()}),e(this).on("blur",".ip_DropDownText",function(){c!=e(this).text()&&e(o).addClass("ip-dirty")})}var _=!0;null!=r.text&&e(t).html(r.text),null!=r.key&&e(this).attr("key",r.key),null!=r.defaultKey&&e(this).attr("key",r.defaultKey),null!=r.defaultIndex&&a.length>r.defaultIndex&&e(a)[r.defaultIndex].click(),_=!1,""!=s&&ip_RaiseEvent(GridID,"warning",null,s)},e.fn.ip_FloatingToolbar=function(r){var r=e.extend({menus:[],relativeTo:document.body,position:null,positionNAN:null,offset:{x:15,y:15},size:null,axisContainment:!0,windowContainment:!0,animate:500,events:{handleDblClick:null,onLoad:null,click:null},mode:"LeftClick",setAnchor:null,resetPosition:!1,speech:!0,toolbarHandle:!0,theme:"theme-dark"},r),o=(e(this).attr("id"),e(this).find(".ip_FloatingToolbarHandle")),i=e(this).find(".ip_FloatingToolbarContainer"),t="",l={callout:""},n=e(this).is(":visible");if(!r.resetPosition||!this[0].anchor||(r.relativeTo=this[0].anchor.relativeTo,r.position=this[0].anchor.position,r.offset=this[0].anchor.offset,r.speech=this[0].anchor.speech,this[0].anchorX&&this[0].anchorY?(r.relativeTo=null,e(this).animate({top:this[0].anchorY,left:this[0].anchorX},r.animate,"easeInOutQuint")):l=e(this).ip_PositionElement(r),0!=r.menus.length)){if(e(this).appendTo(document.body),e(this).attr("mode",r.mode),e(this).addClass("theme-dark"),0==o.length&&r.toolbarHandle&&(e(this).prepend('<div class="ip_FloatingToolbarHandle" title="Double click to reset position"></div>'),o=e(this).find(".ip_FloatingToolbarHandle")),0==i.length&&(e(this).append('<div class="ip_FloatingToolbarContainer"></div>'),i=e(this).find(".ip_FloatingToolbarContainer")[0]),r.menus.length>0){e(i).find(".ip_FloatingToolbarMenu").hide();for(var a=0;a<r.menus.length;a++)0==e(i).find(r.menus[a]).length&&e(r.menus[a]).clone(!0,!0).appendTo(i),e(i).find(r.menus[a]).show()}if(null!=r.size&&(e(this).outerWidth(r.size.width),e(this).outerHeight(r.size.height)),n||(r.animate=0),null!=r.relativeTo?l=e(this).ip_PositionElement(r):null!=r.position&&r.position.top&&r.position.left&&e(this).animate({top:r.position.top,left:r.position.left},r.animate,"easeInOutQuint"),e("#ip_FloatingToolbarSpeech").attr("class",""),r.speech&&""!=l.callout){var s=l.callout;0==e("#ip_FloatingToolbarSpeech").length&&e(this).append('<b id="ip_FloatingToolbarSpeech"></b>'),e("#ip_FloatingToolbarSpeech").addClass("ip_Speech "+s),e("#ip_FloatingToolbarSpeech").addClass(r.theme)}e(this).draggable({start:function(){e("#ip_FloatingToolbarSpeech").removeClass("top"),e("#ip_FloatingToolbarSpeech").removeClass("topLeft"),e("#ip_FloatingToolbarSpeech").removeClass("topRight"),e("#ip_FloatingToolbarSpeech").removeClass("Bottom"),e("#ip_FloatingToolbarSpeech").removeClass("BotomLeft"),e("#ip_FloatingToolbarSpeech").removeClass("BottomRight"),e("#ip_FloatingToolbarSpeech").removeClass("right"),e("#ip_FloatingToolbarSpeech").removeClass("rightTop"),e("#ip_FloatingToolbarSpeech").removeClass("rightBottom"),e("#ip_FloatingToolbarSpeech").removeClass("left"),e("#ip_FloatingToolbarSpeech").removeClass("leftTop"),e("#ip_FloatingToolbarSpeech").removeClass("leftBottom"),e("#ip_FloatingToolbarSpeech").removeClass("ip_Speech")},stop:function(){this.anchorY=e(this).position().top,this.anchorX=e(this).position().left},handle:".ip_FloatingToolbarHandle",containment:[e(document).scrollLeft(),e(document).scrollTop(),e(document).scrollLeft()+e(window).width()-e(this).outerWidth(),e(document).scrollTop()+e(window).height()-e(this).outerHeight()]}),"function"==typeof r.events.dblclick&&(e(this).unbind("dblclick"),e(this).on("dblclick",function(){r.events.dblclick()})),e(this).unbind("click"),"function"==typeof r.events.click&&e(this).on("click",function(){r.events.click()}),e(o).unbind("click"),e(o).on("click",function(e){e.stopPropagation()}),r.setAnchor&&(this[0].anchor={relativeTo:r.relativeTo,position:r.position,offset:r.offset,speech:r.speech},this[0].anchorX=null,this[0].anchorY=null),"function"==typeof r.events.onLoad&&r.events.onLoad(this),n||e(this).fadeIn(100),""!=t&&ip_RaiseEvent(GridID,"warning",null,t)}},e.fn.ip_FooterDialog=function(r){var r=e.extend({Message:"",BackColor:"#2fad75",cssClass:"",Duration:5e3},r);return this.each(function(){clearTimeout(this.ip_ShowFooterAlert_Timeout_JQ);var o=e(this).children(".ip_FooterDialog");0==o.length?(Footer='<div class="ip_FooterDialog"><div class="ip_FooterDialog_Text"></div></div>',e(this).append(Footer),o=e(".ip_FooterDialog")[0]):o=o[0],r.cssClass&&(e(o).attr("class","ip_FooterDialog"),e(o).addClass(r.cssClass)),e(o).children(".ip_FooterDialog_Text").html(r.Message),e(o).css("background-color",r.BackColor),e(o).slideDown(200),this.ip_ShowFooterAlert_Timeout_JQ=setTimeout(function(){e(o).slideUp(200)},r.Duration)})},e.fn.ip_gridProperties=function(r){var o=e.extend({defaultRowHeight:30,defaultColWidth:130,gridHeight:0,gridWidth:0,scrollHeight:0,scrollWidth:0,columnSelectorHeight:30,rowSelectorWidth:50,defaultBorderHeight:1,accumulativeScrollHeight:0,accumulativeScrollWidth:0,fBarHeight:40},r.dimensions),i=e.extend({maxTransactions:10,maxUndoRangeSize:1e4,undoStack:{}},r.undo),t=e.extend({onLoad:null},r.callbacks),r=e.extend({id:null,publicKey:null,index:0,starred:!1,showColSelector:!0,showRowSelector:!0,showGridResizerX:!0,hoverCell:null,hoverColumnIndex:null,hoverRowIndex:null,fxBar:null,fxList:{},selectedCell:null,selectedColumn:[],selectedRow:[],selectedRange:[],selectedRangeIndex:-1,copiedRange:[],highlightRange:[],cut:!1,rows:0,cols:0,frozenRows:0,frozenCols:0,loadedRows:80,loadedCols:20,scrollX:null,scrollY:null,scrollXInterval:1,scrollYInterval:1,scrolling:!1,controlTypes:[{key:"",value:"default",example:"Must contain value, e.g. red",defaultInputs:null},{key:"text",value:"cell",example:"Must contain value, e.g. red [or] red,green",defaultInputs:null},{key:"dropdown",value:"dropdown - CSV or Range",example:"Must contain value, e.g.: a1:a10, red, green",defaultInputs:null}],rowData:[],colData:[],dataTypes:[],mergeData:{},indexedData:{colSymbols:ip_ColumnSymbols(26),cellIndex:{},formulaData:{}},resizing:!1,mouseButton:0,shiftKey:!1,ctrlKey:!1,scrollAnimate:!1,currentMousePos:{pageX:-1,pageY:-1},mask:{},undo:i,editing:{row:-1,col:-1,editing:!1,element:null,contentType:"",carret:null,editTool:null,selectionState:!1,cancelFocusOut:!1},formatting:{formatting:!1,range:null,focusedControl:null},dimensions:o,timeouts:{scrollAnimateInterval:null,keyDownTimeout:null,scrollYCompleteTimeout:null,scrollXCompleteTimeout:null,textEditToolBlurTimeout:null,disableSelectionTimout:null},callbacks:t,events:{ip_InitScrollX_Large_MouseDown:null,ip_InitScrollX_Large_MouseMove:null,ip_InitScrollY_Large_MouseDown:null,ip_InitScrollY_Large_MouseMove:null,ip_InitScrollY_Large_scrollTimeout:null,FrozenHandle_MouseDown:null,FrozenHandle_MouseUp:null,FrozenHandle_MouseLeave:null,FrozenHandle_DragStart:null,FrozenHandle_Drag:null,FrozenHandle_DragEnd:null,rowFrozenHandle_MouseDown:null,rowFrozenHandle_MouseUp:null,rowFrozenHandle_MouseLeave:null,colResizer_MouseDown:null,colResizer_MouseUp:null,colResizer_MouseLeave:null,colResizer_dblClick:null,colResizer_Start:null,colResizer_Drag:null,colResizer_End:null,rowResizer_MouseDown:null,rowResizer_MouseUp:null,rowResizer_MouseLeave:null,rowResizer_dblClick:null,rowResizer_Start:null,rowResizer_Drag:null,rowResizer_End:null,moveRange_mouseMove:null,moveRange_mouseUp:null,showRangeMove_highlightMovePosition:null,scrollAnimate_MouseMove:null,scrollAnimate_MouseUp:null,scrollToXY_RangeTimeout:null,textEditToolDropdown_FocusIn:null,textEditToolDropdown_Click:null,textEditToolDropdown_Mouseenter:null,textEditTool_FocusIn:null,textEditTool_FocusOut:null,textEditTool_KeyDown:null,textEditTool_KeyPress:null,textEditTool_KeyUp:null,textEditTool_MouseUp:null,SetupEvents_document_mouseup:null,SetupEvents_document_keydown:null,SetupEvents_document_keyup:null}},r);return r.dimensions=o,r.undo=i,r},e.fn.ip_rowObject=function(r){var r=e.extend(ip_rowObject(),r);if(0!=r.cols)for(var o=0;o<r.cols;o++)r.cells[o]=ip_cellObject(null,null,null,r.row,o);return r},e.fn.ip_colObject=function(r){var r=e.extend(ip_colObject(),r);return r},e.fn.ip_cellObject=function(r){var r=e.extend(ip_cellObject(),r);return r},e.fn.ip_mergeObject=function(r){var r=e.extend({mergedWithRow:null,mergedWithCol:null,rowSpan:0,colSpan:0},r);return r}}(jQuery),/*! Copyright (c) 2013 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.1.3
 *
 * Requires: 1.2.2+
 */
    function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function r(r){var t,l=r||window.event,n=[].slice.call(arguments,1),a=0,s=0,p=0,d=0,c=0;return r=e.event.fix(l),r.type="mousewheel",l.wheelDelta&&(a=l.wheelDelta),l.detail&&(a=-1*l.detail),l.deltaY&&(p=-1*l.deltaY,a=p),l.deltaX&&(s=l.deltaX,a=-1*s),void 0!==l.wheelDeltaY&&(p=l.wheelDeltaY),void 0!==l.wheelDeltaX&&(s=-1*l.wheelDeltaX),d=Math.abs(a),(!o||o>d)&&(o=d),c=Math.max(Math.abs(p),Math.abs(s)),(!i||i>c)&&(i=c),t=a>0?"floor":"ceil",a=Math[t](a/o),s=Math[t](s/i),p=Math[t](p/i),n.unshift(r,a,s,p),(e.event.dispatch||e.event.handle).apply(this,n)}var o,i,t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],l="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if(e.event.fixHooks)for(var n=t.length;n;)e.event.fixHooks[t[--n]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=l.length;e;)this.addEventListener(l[--e],r,!1);else this.onmousewheel=r},teardown:function(){if(this.removeEventListener)for(var e=l.length;e;)this.removeEventListener(l[--e],r,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})});